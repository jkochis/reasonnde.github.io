(function(){define("utils",[],function(){var e={createSimpleImage:function(e,t,o,n,i){var a=document.createElement("img");return a.src=e+t,a.id=o,a.style.width=n,a.style.height=i,a},createImage:function(e,t,o,n,i,a,r,l){var s=this.createSimpleImage(e,t,o,n,i);return s.style.position="absolute",s.style.top=a,s.style.left=r,s.style.transform="translate(-50%, -50%)",s.style.webkitTransform="translate(-50%, -50%)",s.style.opacity=l,s},getCookie:function(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;o.length>n;n++){for(var i=o[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""},valueInside:function(e,t,o){return e>t&&o>e},clamp:function(e,t,o){return Math.min(Math.max(e,t),o)},centerObject:function(e,t,o){e.style.top=t,e.style.left=o,e.style.transform="translate(-50%, -50%)",e.style.webkitTransform="translate(-50%, -50%)"},randomCilynderPoint:function(e,t,o){var n=2*Math.PI*Math.random(),i=-Math.random()*t,a=e*Math.cos(n),r=e*Math.sin(n);return new THREE.Vector3(a,r,i).add(o[Math.random()>.5?0:1].getWorldPosition())}};return e}),define("intro",["utils"],function(e){function t(e){k=e.changedTouches[0].pageX}function o(e){switch(R=e.changedTouches[0].pageX,k>R&&3>_&&(C.swipe=_,_++,3>_?TweenMax.to(C,.28,{swipe:_,onUpdate:function(){g.style.left=(-window.innerWidth*C.swipe+"").concat("px")}}):r()),R>k&&_>0&&(C.swipe=_,_--,TweenMax.to(C,.28,{swipe:_,onUpdate:function(){g.style.left=(-window.innerWidth*C.swipe+"").concat("px")}})),2==_&&(m.style.opacity=1,a()),l(M),l(b),l(H),_){case 0:s(M);break;case 1:s(b);break;case 2:s(H)}}function n(){B&&requestAnimationFrame(n),I++;var e=5*Math.cos(.03*I)*Math.sin(.01*I),t=10*Math.sin(.02*I)*Math.sin(.04*I)*Math.cos(.01*I);L+=.2*(z-L);var o=10+.7*L;v.style.left=o-e+""+"%",v.style.top=35-t+""+"%"}function i(e){e.preventDefault()}function a(){m.addEventListener("click",r)}function r(){var e=document.getElementById("whiteBGLoader");e.parentNode.removeChild(e),e.removeEventListener("touchstart",t),e.removeEventListener("touchend",o),e.removeEventListener("touchmove",i),e=document.getElementById("mouseInstructions"),e.parentNode.removeChild(e),e=document.getElementById("clickInstructions"),e.parentNode.removeChild(e),e=document.getElementById("title"),e.parentNode.removeChild(e),e=document.getElementById("startButton"),e.parentNode.removeChild(e),$("#ndp_experience_copy").css("opacity",1)}function l(e){e.style.width="10px",e.style.height="10px",e.style.background="#80cae3",e.style.borderRadius="20px",e.style.display="inline-block",e.style.marginLeft="5px",e.style.marginRight="5px",e.style.border="none",e.style.transform="translate(0%, 0%)",e.style.webkitTransform="translate(0%, 0%)"}function s(e){e.style.background="none",e.style.border="solid",e.style.borderWidth="2px",e.style.borderColor="#18a7d9",e.style.transform="translate(0%, 12%)",e.style.webkitTransform="translate(0%, 12%)"}var d,p,c,u,m,g,h,f,v,y,E,x,w,T,M,b,H,_=0,k=0,R=0,C={},I=0,L=0,z=0,B=!1,j=!1,S={ready:function(){return j},startLoader:function(){var e=document.getElementById("ndp_canvas_holder");e.appendChild(p),e.appendChild(u),e.appendChild(v),v.style.zIndex=100},generateAssets:function(t,o,n){d=document.createElement("div"),p=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),v=e.createImage(o,"duckFlight.png","duckImage","41px","69px","45%","50%",1),h=e.createImage(o,"ndp-title.png","title","126px","60px","20%","50%",0),y=e.createImage(o,t?"fingerInstructions.png":"mouseInstructions.png","mouseInstructions","272px","78px","55%","30%",0),f=e.createImage(o,"clickInstructions.png","clickInstructions","262px","78px","55%","70%",0),E=e.createSimpleImage(o,"mInstructions1.png","firstInstructions","225px","196px"),x=e.createSimpleImage(o,"mInstructions2.png","secondInstructions","225px","196px"),w=e.createSimpleImage(o,"mInstructions3.png","thirdInstructions","225px","196px"),d.id="loadBar",d.style.backgroundColor="#f69628",d.style.width="0%",d.style.height="2px",p.style.backgroundColor="#e0e0e0",p.style.width="100%",p.style.height="2px",p.style.position="absolute",p.style.top="50%",p.style.zIndex=200,p.id="mainBar",p.appendChild(d),c.style.width="100%",c.style.height="100%",c.style.position="absolute",c.style.top="0px",c.style.backgroundColor="#fff",c.style.opacity="0.9",c.id="whiteBGLoader",n?$(".ndp_body")[0].appendChild(c):document.getElementById("ndp_canvas_holder").appendChild(c),u.id="loaderText",u.style.color="#13abde",u.style.fontFamily="ProximaNovaThin",u.style.position="absolute",u.style.top="53%",u.style.left="50%",u.style.textAlign="center",u.style.fontSize="16px",u.style.transform="translate(-50%, -50%)",u.style.webkiTransform="translate(-50%, -50%)",u.style.zIndex=200,m=document.createElement("button"),m.style.color="#fff",m.id="startButton",m.style.backgroundColor="#f69628",m.innerHTML="GET STARTED",m.style.position="absolute",m.style.top="80%",m.style.left="50%",m.style.textAlign="center",m.style.fontSize="16px",m.style.transform="translate(-50%, -50%)",m.style.webkitTransform="translate(-50%, -50%)",m.style.paddingTop="15px",m.style.paddingBottom="15px",m.style.paddingLeft="60px",m.style.paddingRight="60px",m.style.border="none",m.style.cursor="pointer",m.style.opacity=0,m.addEventListener("mouseover",function(){$("#startButton").css("background-color","#f6a951")}),m.addEventListener("mouseout",function(){$("#startButton").css("background-color","#f69628")})},animateDuck:function(e){B=e},updateProgressBar:function(e){z=e;var t=e+""+"%";d.style.width=t,u.innerHTML=t},animateLoaderDuck:function(){n()},showInstuctions:function(n,r){var d=document.getElementById("mainBar");if(d.parentNode.removeChild(d),d=document.getElementById("loaderText"),d.parentNode.removeChild(d),d=document.getElementById("duckImage"),d.parentNode.removeChild(d),"true"==e.getCookie("visited"))d=document.getElementById("whiteBGLoader"),d.parentNode.removeChild(d),$("#ndp_experience_copy").css("opacity",1),j=!0;else if(document.cookie="visited=true",n){document.getElementById("whiteBGLoader").addEventListener("touchstart",t),document.getElementById("whiteBGLoader").addEventListener("touchend",o),document.getElementById("whiteBGLoader").addEventListener("touchmove",i);var p=$("#whiteBGLoader")[0];h.style.top="120px",h.style.opacity=1,p.style.height=window.innerHeight+""+"px",g=document.createElement("div"),g.id="touchMobileInstructions",g.style.width=3*window.innerWidth+""+"px",g.style.height="196px",g.style.overflow="hidden",g.style.top="33%",g.style.position="relative";var c=Math.floor((3*window.innerWidth-675)/6);E.style.marginLeft=c+""+"px",x.style.marginLeft=c+""+"px",w.style.marginLeft=c+""+"px",E.style.marginRight=c+""+"px",x.style.marginRight=c+""+"px",w.style.marginRight=c+""+"px",g.appendChild(E),g.appendChild(x),g.appendChild(w),T=document.createElement("div"),T.style.position="relative",T.style.width="65px",T.style.top=(window.innerHeight-90+"").concat("px"),T.id="dotsHolder",T.style.marginRight="auto",T.style.marginLeft="auto",p.appendChild(T),M=document.createElement("div"),b=document.createElement("div"),H=document.createElement("div"),M.id="dot1",b.id="dot2",H.id="dot3",l(M),l(b),l(H),s(M),T.appendChild(M),T.appendChild(b),T.appendChild(H),p.appendChild(h),p.appendChild(g),m.style.top=(window.innerHeight-40+"").concat("px"),m.style.opacity=1,m.style.fontSize="14px",m.style.paddingTop="15px",m.style.paddingBottom="15px",m.style.paddingLeft="20px",m.style.paddingRight="20px",p.appendChild(m),_=0,m.style.opacity=.3}else{var u=document.getElementById("ndp_canvas_holder");u.appendChild(h),u.appendChild(y),u.appendChild(f),h.style.opacity=0,TweenMax.to(h,.5,{opacity:1,delay:.5}),TweenMax.to(m,1,{opacity:1,delay:1.5});var v=800>r;y.style.top=v?"30%":"40%",f.style.top=v?"50%":"40%",TweenMax.to(y,.4,{top:v?"40%":"50%",delay:.9,onStart:function(){y.style.opacity=1}}),TweenMax.to(f,.4,{top:v?"60%":"50%",delay:1.2,onStart:function(){f.style.opacity=1}}),u.appendChild(m),a()}}};return S}),define("ik",[],function(){function e(e,t){for(var o=!1,n=0;t.length>n;n++)if(e.name==t[n]){o=!0;break}return o}var t={solve:function(e,t,o,n,i){for(var a=5,r=.1,l=0,s=e.length-1,d=(new THREE.Vector3).subVectors(t,e[0].getWorldPosition()),p=[],c=[],u=0;e.length>u;u++)c[u]=e[u].position.clone(),p[u]=e[u].position.clone().normalize();if(d.length()>n)for(var u=0;s>u;u++){for(var m=0;e.length>m;m++)e[m].updateMatrixWorld();var g=t.distanceTo(i[u]),h=o[u]/g,f=e[u].getWorldPosition().clone().multiplyScalar(1-h).add(t.clone().multiplyScalar(h)),v=e[u].worldToLocal(f);e[u+1].position.copy(v)}else for(var y=e[0].position.clone();t.clone().sub(e[s].getWorldPosition()).length()>r&&a>l++;){e[0].updateMatrixWorld();var E=t.clone();e[s-1].worldToLocal(E),e[s].position.copy(E);for(var u=s-1;u>=0;u--){for(var m=0;e.length>m;m++)e[m].updateMatrixWorld();var g=e[u+1].getWorldPosition().distanceTo(e[u].getWorldPosition()),h=o[u]/g,f=e[u+1].getWorldPosition().clone().multiplyScalar(1-h).add(e[u].getWorldPosition().clone().multiplyScalar(h)),v=e[Math.max(u-1,0)].worldToLocal(f);e[u].position.copy(v)}e[0].updateMatrixWorld(),e[0].position.copy(y);for(var u=0;s>u;u++){e[0].updateMatrixWorld();var g=e[u+1].getWorldPosition().distanceTo(e[u].getWorldPosition()),h=o[u]/g,f=e[u].getWorldPosition().clone().multiplyScalar(1-h).add(e[u+1].getWorldPosition().clone().multiplyScalar(h)),v=e[u].worldToLocal(f);e[u+1].position.copy(v)}for(var u=0;e.length>u;u++)i[u]=e[u].getWorldPosition().clone()}for(var x=[],u=0;e.length-1>u;u++)x[u]=e[u+1].getWorldPosition().clone().sub(e[u].getWorldPosition()).normalize();for(var u=0;e.length>u;u++)e[u].quaternion.set(0,0,0,1),e[u].position.copy(c[u].clone());for(var w,T,M,u=0;e.length-1>u;u++)if(e[0].updateMatrixWorld(),w=x[u],T=p[u].angleTo(w),M=p[u].clone().cross(w),e[u].quaternion.set(0,0,0,1),e[u].quaternion.setFromAxisAngle(M,T),u>0)for(var b=0;u>b;b++)e[u].quaternion.multiply(e[b].quaternion.clone().inverse());e[e.length-1].quaternion.set(0,0,0,1),e[e.length-1].quaternion.setFromAxisAngle(M,-.5*T),e[0].updateMatrixWorld()},getBoneList:function(t,o){var n=[];t instanceof THREE.Bone&&e(t,o)&&n.push(t);for(var i=0;t.children.length>i;i++)n.push.apply(n,this.getBoneList(t.children[i],o));return n}};return t}),define("app",["intro","utils","ik"],function(e,t,o){function n(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(t){return!1}}function i(){O=500>window.innerWidth?300:546;var e=300==O?703:1280;q=t.createSimpleImage(K,"staticImage.jpg","duckBackground",e,O),y.appendChild(q),q.style.position="relative",q.style.top="0%",q.style.zIndex=-1,$("#ndp_experience_copy").css("opacity",1);var o=0;1200>window.innerWidth&&(o=Math.min(30,30*window.innerWidth/e)),window.addEventListener?window.addEventListener("resize",function(){o=0,1200>window.innerWidth&&(o=Math.min(30,30*window.innerWidth/e)),q.style.right=o+""+"%"}):window.attachEvent("onresize",function(){o=0,1200>window.innerWidth&&(o=Math.min(30,30*window.innerWidth/e)),q.style.right=o+""+"%"}),q.style.right=o+""+"%"}function a(){B=new THREE.Clock,O=580>window.innerWidth?300:546,O=void 0!=window.orientation?O:546,300==O&&(Vt=!0,$("#ndp_experience_copy").remove()),Q=Vt||T||void 0!=window.orientation?1e4:1e5,(Vt||T||void 0!=window.orientation)&&$("#ndp_login_link").remove(),e.generateAssets(T,K,Vt),Pt[0]=t.createSimpleImage(K,"bag1.png","bag1","256px","256px","0px","0px",1),Pt[1]=t.createSimpleImage(K,"bag2.png","bag2","256px","256px","0px","0px",1),Pt[2]=t.createSimpleImage(K,"bag3.png","bag3","256px","256px","0px","0px",1),Pt[3]=t.createSimpleImage(K,"bag4.png","bag4","256px","256px","0px","0px",1),Pt[4]=t.createSimpleImage(K,"bag5.png","bag5","256px","256px","0px","0px",1),Pt[5]=t.createSimpleImage(K,"bag6.png","bag6","256px","256px","0px","0px",1),M=new THREE.PerspectiveCamera(20,y.offsetWidth/O,Vt?200:50,1e4),M.position.z=Ht,_=new THREE.Object3D,_.position.y=-300,b=new THREE.Scene,b.add(_),k=new THREE.Object3D,W=new THREE.Raycaster,P=new THREE.ShaderMaterial({uniforms:{aspect:{type:"f",value:y.offsetWidth/O}},vertexShader:"precision highp float; varying vec2 vText; void main() {vec2 pos = 2. * position.xy; vText = pos; gl_Position = vec4(pos, 1., 1.0);}",fragmentShader:"precision highp float; varying vec2 vText; void main() {gl_FragColor = vec4(mix(vec3(1., 1., 1.), vec3(0.353, 0.557, 0.804), clamp(0.5 * (vText.y + 1.), 0., 1.)), 1.0 );}"}),D=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),P),b.add(D);var o=THREE.ImageUtils.loadTexture(K+"cloud.png",THREE.UVMapping,function(){e.startLoader(),l(),r(),It=!0});U=new THREE.ShaderMaterial({uniforms:{uHeight:{type:"f",value:O},map:{type:"t",value:o}},vertexShader:"precision highp float; varying float posZ; uniform float uHeight; void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 ); posZ = position.z; float scaler = smoothstep(0., 1., abs(uHeight - posZ) / 400.); gl_PointSize = max(20. * (1. - scaler), 5.);}",fragmentShader:"precision highp float; uniform sampler2D map; uniform float uHeight; varying float posZ; varying float scaler; void main() {gl_FragColor = texture2D(map, gl_PointCoord); float scaler = clamp(abs(uHeight - posZ) / 3000., 0., 1.); gl_FragColor.rgb *=  0.06 * (1. - scaler); gl_FragColor.a *=  0.5 * (1. - scaler); scaler = clamp(abs(uHeight - posZ) / 10., 0., 1.); gl_FragColor.rgb *= scaler; gl_FragColor.a *= scaler;}"}),U.transparent=!0,U.blending=THREE.AdditiveBlending,U.depthWrite=!1;var n=new THREE.Geometry;for(n.dynamic=!0,d=0;Q>d;d++){var i=new THREE.Vector3;i.life=Math.floor(d/30),n.vertices.push(i)}F=new THREE.PointCloud(n,U),F.frustumCulled=!1;var a=new THREE.PlaneBufferGeometry(64,64),s=THREE.ImageUtils.loadTexture(K+"tree.png",THREE.UVMapping,function(){Gt=!0});G=new THREE.Object3D,A=[];for(var d=0;200>d;d++){var E=new THREE.ShaderMaterial({uniforms:{map:{type:"t",value:s},uHeight:{type:"f",value:O},uDuckZ:{type:"f",value:_.position.z},color:{type:"v4",value:new THREE.Vector4(.6+.4*Math.random(),.6+.4*Math.random(),.6+.4*Math.random(),1)}},vertexShader:"precision mediump float; varying vec2 vText; void main() {vText = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );}",fragmentShader:"precision mediump float; uniform sampler2D map; uniform vec4 color; uniform float uHeight; uniform float uDuckZ; varying vec2 vText; void main() {gl_FragColor = texture2D(map, vText) * color; vec3 backgroundColor = vec3(mix(vec3(1., 1., 1.), vec3(0.353, 0.557, 0.804) , clamp((gl_FragCoord.y / uHeight), 0., 1.))); gl_FragColor.rgb = mix( 1.48 * gl_FragColor.rgb, backgroundColor, clamp(uDuckZ, 0., 1.));}",transparent:!0});E.needsUpdate=!0,E.depthWrite=!1,A[d]=new THREE.Mesh(a,E);var x=300;A[d].position.x=4*x*(2*Math.random()-1),A[d].position.y=100*-Math.random()-330,A[d].position.z=Math.floor(50*d),A[d].scale.set(6+4*Math.random(),6+3*Math.random(),6),G.add(A[d])}V=[],N=new THREE.Object3D;for(var d=0;300>d;d++){var E=new THREE.ShaderMaterial({uniforms:{map:{type:"t",value:o},uHeight:{type:"f",value:O},uDuckZ:{type:"f",value:_.position.z},uAlpha:{type:"f",value:1}},vertexShader:"precision mediump float; varying vec2 vText; void main() {vText = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );}",fragmentShader:"precision mediump float; uniform float uAlpha; uniform sampler2D map; uniform float uHeight; uniform float uDuckZ; varying vec2 vText; void main() {gl_FragColor =texture2D( map, vText ); gl_FragColor.a *= uAlpha; vec3 backgroundColor = vec3(mix(vec3(1., 1., 1.), vec3(0.353, 0.557, 0.804) , clamp((gl_FragCoord.y / uHeight), 0., 1.))); gl_FragColor.rgb = mix( gl_FragColor.rgb, backgroundColor, clamp(uDuckZ, 0., 1.));}",transparent:!0});E.needsUpdate=!0,E.depthWrite=!1,V[d]=new THREE.Mesh(a,E);var x=300;V[d].position.x=1.5*x*(2*Math.random()-1),V[d].position.y=100*-Math.random()*Math.random()-130,V[d].position.z=-600+Math.floor(50*d),V[d].rotation.z=Math.random()*Math.PI,V[d].scale.set(5+4*Math.random()*Math.random(),4,4),N.add(V[d])}b.add(N),H.setClearColor(et,1),H.clear(et),H.setSize(y.offsetWidth,O),y.appendChild(H.domElement),H.domElement.addEventListener("touchstart",p),H.domElement.addEventListener("touchend",c),H.domElement.addEventListener("touchmove",g),document.addEventListener("mousemove",h,!1),H.domElement.addEventListener("mousedown",u,!1),H.domElement.addEventListener("mouseup",m,!1),document.addEventListener("mouseout",f,!1),window.addEventListener("resize",v,!1)}function r(){var e=[K+"building_01.js",K+"building_02.js",K+"building_03.js",K+"building_04.js",K+"building_06.js",K+"building_07.js"],t=[400,400,400,850,850,850];xt=[],X=[],Y=0,Z=new THREE.Object3D,J=[];for(var o=0,n=THREE.ImageUtils.loadTexture(K.concat("building_houses.jpg"),THREE.UVMapping,function(){Nt=!0}),i=THREE.ImageUtils.loadTexture(K.concat("building_offices.jpg"),THREE.UVMapping,function(){Zt=!0}),a=0;e.length>a;a++)J[a]=new THREE.JSONLoader,J[a].load(e[a],a+100,function(){},function(a){if(X[Y]=a,Y++,Y==e.length)for(var r=[],l=0;12>l;l++){var s=0;for(r[l]=new THREE.Object3D;6e3>s;){var d=new THREE.ShaderMaterial({uniforms:{map:{type:"t",value:Math.random()>.5?n:i},uHeight:{type:"f",value:O},uDuckZ:{type:"f",value:_.position.z},color:{type:"v4",value:new THREE.Vector4(.95+.05*Math.random(),.95+.05*Math.random(),.95+.05*Math.random(),1)}},vertexShader:"precision mediump float; varying vec2 vText; void main() {vText = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );}",fragmentShader:"precision mediump float; uniform sampler2D map; uniform float uHeight; uniform float uDuckZ; uniform vec4 color; varying vec2 vText; void main() {gl_FragColor = texture2D(map, vText) * color; vec3 backgroundColor = vec3(mix(vec3(1., 1., 1.), vec3(0.353, 0.557, 0.804) , clamp((gl_FragCoord.y / uHeight), 0., 1.))); gl_FragColor.rgb = mix(gl_FragColor.rgb, backgroundColor, clamp(uDuckZ, 0., 1.));}",transparent:!0});d.needsUpdate=!0;var p=Math.floor(5*Math.random());(0==p||2==p)&&Math.random>.2&&(p=Math.floor(5*Math.random())),xt[o]=new THREE.SkinnedMesh(X[p],d),xt[o].scale.set(11+2*Math.random(),5+5*Math.random(),12),xt[o].material.side=THREE.DoubleSide,r[l].add(xt[o]),xt[o].rotation.set(0,.2*Math.random()*(Math.random()>.5?-1:1),0),xt[o].position.set(s,(0==p?-1450:-1200)-50*Math.random(),450*l),s+=t[p],o++}r[l].position.x=-s*(.5+.1*Math.random()*(Math.random()>.5?-1:1)),Z.add(r[l])}})}function l(){e.animateDuck(!0),e.animateLoaderDuck();var t=THREE.ImageUtils.loadTexture(K+"AlternateBody_Texture.png",THREE.UVMapping,function(){it++,5==it&&s()}),o=THREE.ImageUtils.loadTexture(K+"jetPack_Texture.jpg",THREE.UVMapping,function(){it++,5==it&&s()}),n=THREE.ImageUtils.loadTexture(K+"Beak_Texture.jpg",THREE.UVMapping,function(){it++,5==it&&s()}),i=THREE.ImageUtils.loadTexture(K+"Feet_Texture.jpg",THREE.UVMapping,function(){it++,5==it&&s()}),a=THREE.ImageUtils.loadTexture(K+"Accessories_Texture_Money_Alt.jpg",THREE.UVMapping,function(){it++,5==it&&s()});_t[0]=new THREE.MeshBasicMaterial({map:t}),_t[1]=new THREE.MeshBasicMaterial({map:o}),_t[2]=new THREE.MeshBasicMaterial({map:n}),_t[3]=new THREE.MeshBasicMaterial({map:i}),_t[4]=new THREE.MeshBasicMaterial({map:a}),_t[5]=_t[4],_t[6]=_t[4],_t[7]=_t[4],d()}function s(){for(var t=[K+"Duck_Body.js",K+"Duck_Jetpack.js",K+"Duck_Beak.js",K+"Duck_Feet.js",K+"Duck_JetpackHarness.js",K+"Duck_Helmet_NoHeadMovement.js",K+"Duck_Bag.js",K+"Duck_Scarf_NoHeadMovement.js"],n=0;t.length>n;n++)Rt[n]=0,kt[n]=new THREE.JSONLoader,kt[n].load(t[n],n,Ot,function(n){var i=new THREE.SkinnedMesh(n,this);i.material.skinning=!0,i.material.side=THREE.DoubleSide,_.add(i);for(var a=0;lt.length>a;a++)lt[a].position.setX(0);if(i.name=i.geometry.name,"helmet"!=i.name&&"scarf"!=i.name||!Vt||i.scale.set(1.2,1.02,1),"body"==i.name){i.material.side=THREE.FrontSide;var r=[];for(r[0]="neck_joint_01",r[1]="neck_joint_02",r[2]="neck_joint_03",r[3]="neck_joint_04",r[4]="neck_joint_05",lt=o.getBoneList(i,r),i.material.transparent=!0,r=[],r[0]="head_joint",R=o.getBoneList(i,r)[0],C=R.getWorldPosition().clone(),C=lt[lt.length-1].worldToLocal(C),R.position.copy(C),lt[lt.length-1].add(R),lt.push(R),rt[0]=new THREE.SkeletonHelper(i),rt[0].material.linewidth=5,a=0;lt.length-1>a;a++)st[a]=lt[a+1].getWorldPosition().distanceTo(lt[a].getWorldPosition()),pt[a]=lt[a].getWorldPosition().clone(),dt+=st[a]}if("beak"==i.name&&(r=[],r[0]="head_joint",I=o.getBoneList(i,r)[0],r=[],r[0]="bottom_jaw_joint",L=o.getBoneList(i,r)[0]),"jetpack"==i.name){var r=[];r[0]="jet_joint1",r[1]="jet_joint2",z=o.getBoneList(i,r)}var l=new THREE.Animation(i,n.animation);l.play(),ut[nt]=l,nt++,nt==t.length&&(e.animateDuck(!1),_.position.setX(0),_.position.setY(-300),Ct=!0,e.showInstuctions(Vt,H.domElement.width))}.bind(_t[n]))}function d(){requestAnimationFrame(d);var n=Math.max($("body").scrollTop(),$("html").scrollTop());if(x||0!=n||(x=!0),Ct&&x&&e.ready)if(St){if(!Wt){Wt=!0;for(var i=0;_.children.length>i;i++)if("bags"==_.children[i].name){_.remove(_.children[i]),E.css("top","20%"),E.css("opacity",0),Ft.one=0,Ft.image=0,E.append(Pt[0]),TweenMax.to(Ft,1,{one:1,ease:"Linear.easeNone",onUpdate:function(){E.css("opacity",1);var e=Ft.one*($(".w_footer").offset().top-200);620>$(window).width()&&(e=$(".w_footer").offset().top-270),E.css("top",e+""+"px"),E.empty(),Dt+=.5,E.append(Pt[Math.floor(Dt)]),Dt==Pt.length-2&&(Dt=0)},onComplete:function(){E.empty(),E.append(Pt[5])}});break}}}else{var a=1.1*H.domElement.height;St=n>a}if(Ct){_.add(R);var r=B.getDelta();if(Et+=r,bt)if(ct){var l=new THREE.Vector3(tt,ot,1).unproject(M);W.set(M.position,l.sub(M.position).normalize());var s=W.intersectObjects(_.children);s.length>0&&(mt=!0,Lt=Ht,Bt=.01,b.add(F),1==yt&&0==mt?(j=gt,S>ht&&(j=gt,yt++,mt=!0,Lt=Ht,Bt=.01)):j=gt,0==yt?(S=5,j=0,Et>=5&&yt++):S=ht),jt=0}else mt=!1,Bt=.06,Lt=1.15*Ht,j=ft,S=vt,yt=0,jt++;for(var i=0;ut.length>i;i++)ut[i].resetBlendWeights(),ut[i].update(Et);if(Et>S){Et=j;for(var i=0;ut.length>i;i++)ut[i].resetBlendWeights(),ut[i].play(j)}var p=(new THREE.Vector3).set(tt,ot,.5);p.unproject(M),zt+=Bt*(Lt-zt);var c=p.sub(M.position).normalize(),u=-zt/c.z,m=M.position.clone().add(c.multiplyScalar(u));k.position.copy(m),R.position.copy(C);try{lt[lt.length-2].add(R)}catch(g){}var h=m.clone();h.z+=Vt?55:42,_.position.x+=.06*(m.x-_.position.x),_.position.y+=.03*(m.y-20-_.position.y),_.rotation.z+=.02*(tt-_.rotation.z),o.solve(lt,h,st,dt,pt),lt[0].updateMatrixWorld();for(var i=0;_.children.length>i;i++){if("beak"==_.children[i].name&&(lt[lt.length-2].add(I),I.position.copy(R.position),I.quaternion.copy(R.quaternion),I.updateMatrix()),"helmet"==_.children[i].name){var f=_.children[i];R.add(f),f.position.set(0,-58,-26)}if("scarf"==_.children[i].name){var v=_.children[i];lt[2].add(v),v.rotation.set(Math.PI/2,0,0),v.position.set(0,18,-42)}}L.rotation.set(.2+.3*Math.cos(3*at),0,0);for(var y=F.geometry.vertices,i=0;y.length>i;i++)y[i].life+=1,y[i].life>Q/30&&(y[i].life=0,mt&&y[i].copy(t.randomCilynderPoint(2,Mt,z),i));F.geometry.verticesNeedUpdate=!0,U.uniforms.uHeight.value=_.position.z}if(wt=mt?Mt:4,Tt+=.02*(wt-Tt),_.position.z+=Tt,M.position.z=_.position.z+zt,D.position.z+=Tt,_.position.z>1e4){for(var y=F.geometry.vertices,i=0;y.length>i;i++)y[i].z-=1e4;_.position.z=0,M.position.z=zt,D.position.z=0;for(var i=0;A.length>i;i++)A[i].position.z-=1e4;for(var i=0;V.length>i;i++)V[i].position.z-=1e4;for(var i=0;xt.length>i;i++)xt[i].position.z-=1e4}at-=.03,M.lookAt(new THREE.Vector3(0,0,0));for(var T=5e3,i=0;xt.length>i;i++)_.position.z-T>xt[i].position.z&&(xt[i].position.z=1e3+_.position.z),xt[i].material.uniforms.uHeight.value=(w?2:1)*O,xt[i].material.uniforms.uDuckZ.value=Math.pow(t.clamp((_.position.z-xt[i].position.z)/T,0,1),5.5);for(var P=4e3,i=0;A.length>i;i++)_.position.z-P>A[i].position.z&&(A[i].position.z=800+_.position.z),A[i].material.uniforms.uHeight.value=(w?2:1)*O,A[i].material.uniforms.uDuckZ.value=Math.pow(t.clamp((_.position.z-A[i].position.z)/P,0,1),5.5);if(Gt&&Zt&&Nt){var N=Math.pow(Math.abs(Math.cos(.1*at)),3.5);N>.998&&At&&(Ut++,At=!1,0==Ut?b.add(Z):0==Ut%2?(b.add(Z),b.remove(G)):(b.add(G),b.remove(Z))),.01>N&&(At=!0)}else at=0,N=1;for(var i=0;V.length>i;i++)_.position.z-3e3>V[i].position.z&&(V[i].position.z=800+_.position.z),V[i].material.uniforms.uHeight.value=(w?2:1)*O,V[i].material.uniforms.uDuckZ.value=(_.position.z-V[i].position.z)/3e3,V[i].material.uniforms.uAlpha.value=N;It&&H.render(b,M)}function p(e){ct=!0,e.preventDefault()}function c(e){ct=!1,bt&&(Mt+=8,Mt=Math.min(Mt,60)),tt=0,ot=0,e.preventDefault()}function u(e){ct=!0,e.preventDefault()}function m(e){ct=!1,$t=!0,bt&&(Mt+=8,Mt=Math.min(Mt,60)),e.preventDefault()}function g(e){e.preventDefault();var t={pageX:e.changedTouches[0].pageX,pageY:e.changedTouches[0].pageY};t.preventDefault=function(){},h(t)}function h(o){o.preventDefault();var n,i,a=H.domElement,r=0,l=0;if(a.offsetParent)do r+=a.offsetLeft,l+=a.offsetTop;while(a=a.offsetParent);bt=$t&&t.valueInside(o.pageX,r,r+H.domElement.width)&&t.valueInside(o.pageY,l,l+H.domElement.height);var s=w?.5:1;n=o.pageX-r,i=o.pageY-l,n=t.clamp(n,0,s*H.domElement.width),i=t.clamp(i,0,s*H.domElement.height),tt=2*(n/(s*H.domElement.width))-1,ot=-2*(i/(s*H.domElement.height))+1,e.ready&&bt||(tt=0,ot=0)}function f(){tt=0,ot=0}function v(){M.aspect=y.offsetWidth/O,M.updateProjectionMatrix(),H.setSize(y.offsetWidth,O);var e=$(".w_footer").offset().top-200;620>$(window).width()&&(e=$(".w_footer").offset().top-270),E.css("top",e+""+"px");try{H.domElement.width>800?(t.centerObject(mouseInstructions,"50%","30%"),t.centerObject(clickInstructions,"50%","70%")):(t.centerObject(mouseInstructions,"40%","50%"),t.centerObject(clickInstructions,"60%","50%"))}catch(o){}}var y,E,x,w,T,M,b,H,_,k,R,C,I,L,z,B,j,S,W,D,P,F,U,A,V,G,Z,N,O,q,X,Y,J,Q,K="/_Global-Assets/images/ndp/webGL/",et=16777215,tt=0,ot=0,nt=0,it=0,at=0,rt=[],lt=[],st=[],dt=0,pt=[],ct=!1,ut=[],mt=!1,gt=.625,ht=1.875,ft=3.125,vt=4.25,yt=1,Et=gt,xt=[],wt=0,Tt=16,Mt=16,bt=!1,Ht=500,_t=[],kt=[],Rt=[],Ct=!1,It=!1,Lt=600,zt=600,Bt=.02,jt=0,St=!1,Wt=!1,Dt=0,Pt=[],Ft={},Ut=0,At=!0,Vt=!1,$t=!0,Gt=!1,Zt=!1,Nt=!1,Ot=function(t,o){Rt[t]=o;for(var n=0,i=0;Rt.length>i;i++)n+=Rt[i];e.updateProgressBar(Math.floor(100*n/5532617))};return $(window).blur(function(){tt=0,ot=0,$t=!1}),$(window).focus(function(){$t=!0}),{initExperience:function(){y=document.getElementById("ndp_canvas_holder"),E=$("#bag_holder"),x=0==Math.max($("body").scrollTop(),$("html").scrollTop()),w=window.devicePixelRatio>1,T="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,n()?(H=new THREE.WebGLRenderer({antialiasing:!0}),H.supportsVertexTextures()?a():i()):i()}}}),define("jquery",[],function(){return jQuery}),require.config({paths:{THREE:"webGL/Three",app:"webGL/app",intro:"webGL/Intro",ik:"webGL/ik",utils:"webGL/Utils"}}),require(["app"],function(e){$(document).ready(function(){e.initExperience()})}),define("flyingduck",function(){})})();