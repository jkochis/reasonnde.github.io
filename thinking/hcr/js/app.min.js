"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function t(e,n,o){function i(s,l){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return i(n?n:t)},h,h.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){t("../node_modules/waypoints/lib/noframework.waypoints");var o=document.body.style,i=document.location+"images/bg/",r=".png",s=["WallPaper2","WallPaper2_tone","WallPaper2.5","WallPaper3","WallPaper3.5","WallPaper4","WallPaper4.5","WallPaper5.5","WallPaper5.5_tone","WallPaper6","WallPaper6.5","WallPaper7.5","WallPaper7.5_tone"],l=!1;new Waypoint({element:document.getElementById("waypointHeader"),handler:function(t){}});(function(){window.waypoints=[];var t=Math.floor(document.querySelector(".wrapper").clientHeight/s.length);s.forEach(function(e,n){console.log(t*(n+1)),window.waypoints[n]=new Waypoint({element:document.getElementById("waypointHeader"),handler:function(t){console.log("loading "+s[n]+" from loop function"),a("down"===t?n+1:n)},offset:t*(n+1)*-1})})})();l!==!0&&(s.forEach(function(t){(new Image).src=i+t+r}),l=!0);var a=function(t){o.backgroundImage="url("+i+s[t]+r+")",console.log("loading "+i+s[t]+r)},h=document.querySelectorAll(".business-type-select");Array.prototype.slice.call(h).forEach(function(t){t.addEventListener("click",function(){console.log(t);var e=document.querySelector(".business-type-select.active");e&&e.classList.remove("active"),t.classList.add("active");for(var n=document.querySelectorAll(".hcr-menu"),o=0;o<n.length;o++)n[o].style.visibility="visible";p.accordion(0,"bottom",function(t,e){e.el.classList.add("open"),console.log(t,e)})})});var p=new OriDomi(document.querySelector(".hcr-menu"),{hPanels:9,ripple:2,shading:"hard",touchEnabled:!1});p.foldUp("bottom")},{"../node_modules/waypoints/lib/noframework.waypoints":2}],2:[function(t,e,n){!function(){function t(o){if(!o)throw new Error("No options passed to Waypoint constructor");if(!o.element)throw new Error("No element option passed to Waypoint constructor");if(!o.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+e,this.options=t.Adapter.extend({},t.defaults,o),this.element=this.options.element,this.adapter=new t.Adapter(this.element),this.callback=o.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=t.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=t.Context.findOrCreateByElement(this.options.context),t.offsetAliases[this.options.offset]&&(this.options.offset=t.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),n[this.key]=this,e+=1}var e=0,n={};t.prototype.queueTrigger=function(t){this.group.queueTrigger(this,t)},t.prototype.trigger=function(t){this.enabled&&this.callback&&this.callback.apply(this,t)},t.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete n[this.key]},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},t.prototype.next=function(){return this.group.next(this)},t.prototype.previous=function(){return this.group.previous(this)},t.invokeAll=function(t){var e=[];for(var o in n)e.push(n[o]);for(var i=0,r=e.length;r>i;i++)e[i][t]()},t.destroyAll=function(){t.invokeAll("destroy")},t.disableAll=function(){t.invokeAll("disable")},t.enableAll=function(){t.invokeAll("enable")},t.refreshAll=function(){t.Context.refreshAll()},t.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},t.viewportWidth=function(){return document.documentElement.clientWidth},t.adapters=[],t.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},t.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=t}(),function(){function t(t){window.setTimeout(t,1e3/60)}function e(t){this.element=t,this.Adapter=i.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+n,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,o[t.waypointContextKey]=this,n+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var n=0,o={},i=window.Waypoint,r=window.onload;e.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},e.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical);t&&e&&(this.adapter.off(".waypoints"),delete o[this.key])},e.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,i.requestAnimationFrame(t))})},e.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){e.didScroll&&!i.isTouch||(e.didScroll=!0,i.requestAnimationFrame(t))})},e.prototype.handleResize=function(){i.Context.refreshAll()},e.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var n in e){var o=e[n],i=o.newScroll>o.oldScroll,r=i?o.forward:o.backward;for(var s in this.waypoints[n]){var l=this.waypoints[n][s],a=o.oldScroll<l.triggerPoint,h=o.newScroll>=l.triggerPoint,p=a&&h,u=!a&&!h;(p||u)&&(l.queueTrigger(r),t[l.group.id]=l.group)}}for(var c in t)t[c].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.innerHeight=function(){return this.element==this.element.window?i.viewportHeight():this.adapter.innerHeight()},e.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},e.prototype.innerWidth=function(){return this.element==this.element.window?i.viewportWidth():this.adapter.innerWidth()},e.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var n in this.waypoints[e])t.push(this.waypoints[e][n]);for(var o=0,i=t.length;i>o;o++)t[o].destroy()},e.prototype.refresh=function(){var t,e=this.element==this.element.window,n=e?void 0:this.adapter.offset(),o={};this.handleScroll(),t={horizontal:{contextOffset:e?0:n.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:n.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var r in t){var s=t[r];for(var l in this.waypoints[r]){var a,h,p,u,c,f=this.waypoints[r][l],d=f.options.offset,y=f.triggerPoint,w=0,g=null==y;f.element!==f.element.window&&(w=f.adapter.offset()[s.offsetProp]),"function"==typeof d?d=d.apply(f):"string"==typeof d&&(d=parseFloat(d),f.options.offset.indexOf("%")>-1&&(d=Math.ceil(s.contextDimension*d/100))),a=s.contextScroll-s.contextOffset,f.triggerPoint=w+a-d,h=y<s.oldScroll,p=f.triggerPoint>=s.oldScroll,u=h&&p,c=!h&&!p,!g&&u?(f.queueTrigger(s.backward),o[f.group.id]=f.group):!g&&c?(f.queueTrigger(s.forward),o[f.group.id]=f.group):g&&s.oldScroll>=f.triggerPoint&&(f.queueTrigger(s.forward),o[f.group.id]=f.group)}}return i.requestAnimationFrame(function(){for(var t in o)o[t].flushTriggers()}),this},e.findOrCreateByElement=function(t){return e.findByElement(t)||new e(t)},e.refreshAll=function(){for(var t in o)o[t].refresh()},e.findByElement=function(t){return o[t.waypointContextKey]},window.onload=function(){r&&r(),e.refreshAll()},i.requestAnimationFrame=function(e){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t;n.call(window,e)},i.Context=e}(),function(){function t(t,e){return t.triggerPoint-e.triggerPoint}function e(t,e){return e.triggerPoint-t.triggerPoint}function n(t){this.name=t.name,this.axis=t.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),o[this.axis][this.name]=this}var o={vertical:{},horizontal:{}},i=window.Waypoint;n.prototype.add=function(t){this.waypoints.push(t)},n.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},n.prototype.flushTriggers=function(){for(var n in this.triggerQueues){var o=this.triggerQueues[n],i="up"===n||"left"===n;o.sort(i?e:t);for(var r=0,s=o.length;s>r;r+=1){var l=o[r];(l.options.continuous||r===o.length-1)&&l.trigger([n])}}this.clearTriggerQueues()},n.prototype.next=function(e){this.waypoints.sort(t);var n=i.Adapter.inArray(e,this.waypoints),o=n===this.waypoints.length-1;return o?null:this.waypoints[n+1]},n.prototype.previous=function(e){this.waypoints.sort(t);var n=i.Adapter.inArray(e,this.waypoints);return n?this.waypoints[n-1]:null},n.prototype.queueTrigger=function(t,e){this.triggerQueues[e].push(t)},n.prototype.remove=function(t){var e=i.Adapter.inArray(t,this.waypoints);e>-1&&this.waypoints.splice(e,1)},n.prototype.first=function(){return this.waypoints[0]},n.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},n.findOrCreate=function(t){return o[t.axis][t.name]||new n(t)},i.Group=n}(),function(){function t(t){return t===t.window}function e(e){return t(e)?e:e.defaultView}function n(t){this.element=t,this.handlers={}}var o=window.Waypoint;n.prototype.innerHeight=function(){var e=t(this.element);return e?this.element.innerHeight:this.element.clientHeight},n.prototype.innerWidth=function(){var e=t(this.element);return e?this.element.innerWidth:this.element.clientWidth},n.prototype.off=function(t,e){function n(t,e,n){for(var o=0,i=e.length-1;i>o;o++){var r=e[o];n&&n!==r||t.removeEventListener(r)}}var o=t.split("."),i=o[0],r=o[1],s=this.element;if(r&&this.handlers[r]&&i)n(s,this.handlers[r][i],e),this.handlers[r][i]=[];else if(i)for(var l in this.handlers)n(s,this.handlers[l][i]||[],e),this.handlers[l][i]=[];else if(r&&this.handlers[r]){for(var a in this.handlers[r])n(s,this.handlers[r][a],e);this.handlers[r]={}}},n.prototype.offset=function(){if(!this.element.ownerDocument)return null;var t=this.element.ownerDocument.documentElement,n=e(this.element.ownerDocument),o={top:0,left:0};return this.element.getBoundingClientRect&&(o=this.element.getBoundingClientRect()),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}},n.prototype.on=function(t,e){var n=t.split("."),o=n[0],i=n[1]||"__default",r=this.handlers[i]=this.handlers[i]||{},s=r[o]=r[o]||[];s.push(e),this.element.addEventListener(o,e)},n.prototype.outerHeight=function(e){var n,o=this.innerHeight();return e&&!t(this.element)&&(n=window.getComputedStyle(this.element),o+=parseInt(n.marginTop,10),o+=parseInt(n.marginBottom,10)),o},n.prototype.outerWidth=function(e){var n,o=this.innerWidth();return e&&!t(this.element)&&(n=window.getComputedStyle(this.element),o+=parseInt(n.marginLeft,10),o+=parseInt(n.marginRight,10)),o},n.prototype.scrollLeft=function(){var t=e(this.element);return t?t.pageXOffset:this.element.scrollLeft},n.prototype.scrollTop=function(){var t=e(this.element);return t?t.pageYOffset:this.element.scrollTop},n.extend=function(){function t(t,e){if("object"===("undefined"==typeof t?"undefined":_typeof(t))&&"object"===("undefined"==typeof e?"undefined":_typeof(e)))for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}for(var e=Array.prototype.slice.call(arguments),n=1,o=e.length;o>n;n++)t(e[0],e[n]);return e[0]},n.inArray=function(t,e,n){return null==e?-1:e.indexOf(t,n)},n.isEmptyObject=function(t){for(var e in t)return!1;return!0},o.adapters.push({name:"noframework",Adapter:n}),o.Adapter=n}()},{}]},{},[1]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5taW4uanMiLCJhcHAuanMiXSwibmFtZXMiOlsiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJlIiwidCIsIm4iLCJyIiwicyIsIm8iLCJ1IiwiYSIsInJlcXVpcmUiLCJpIiwiRXJyb3IiLCJmIiwiZXhwb3J0cyIsImNhbGwiLCJsZW5ndGgiLCIxIiwibW9kdWxlIiwiZG9jU3R5bGUiLCJkb2N1bWVudCIsImJvZHkiLCJzdHlsZSIsImJnUGF0aCIsImxvY2F0aW9uIiwiaW1nRXh0IiwiYmdzIiwiYmdJbWFnZXNMb2FkZWQiLCJXYXlwb2ludCIsImVsZW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhhbmRsZXIiLCJkaXJlY3Rpb24iLCJ3aW5kb3ciLCJ3YXlwb2ludHMiLCJ3YXlwb2ludFVuaXQiLCJNYXRoIiwiZmxvb3IiLCJxdWVyeVNlbGVjdG9yIiwiY2xpZW50SGVpZ2h0IiwiZm9yRWFjaCIsImluZGV4IiwiY29uc29sZSIsImxvZyIsImxvYWRCZyIsIm9mZnNldCIsImJnIiwiSW1hZ2UiLCJzcmMiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJidXNpbmVzc1NlbGVjdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJBcnJheSIsInByb3RvdHlwZSIsInNsaWNlIiwiZWwiLCJhZGRFdmVudExpc3RlbmVyIiwiY3VycmVudEFjdGl2ZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsIm1lbnVzIiwidmlzaWJpbGl0eSIsImZvbGRNZW51IiwiYWNjb3JkaW9uIiwiZXYiLCJvcmkiLCJPcmlEb21pIiwiaFBhbmVscyIsInJpcHBsZSIsInNoYWRpbmciLCJ0b3VjaEVuYWJsZWQiLCJmb2xkVXAiLCIuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHMiLCIyIiwib3B0aW9ucyIsInRoaXMiLCJrZXkiLCJrZXlDb3VudGVyIiwiQWRhcHRlciIsImV4dGVuZCIsImRlZmF1bHRzIiwiYWRhcHRlciIsImNhbGxiYWNrIiwiYXhpcyIsImhvcml6b250YWwiLCJlbmFibGVkIiwidHJpZ2dlclBvaW50IiwiZ3JvdXAiLCJHcm91cCIsImZpbmRPckNyZWF0ZSIsIm5hbWUiLCJjb250ZXh0IiwiQ29udGV4dCIsImZpbmRPckNyZWF0ZUJ5RWxlbWVudCIsIm9mZnNldEFsaWFzZXMiLCJhbGxXYXlwb2ludHMiLCJxdWV1ZVRyaWdnZXIiLCJ0cmlnZ2VyIiwiYXJncyIsImFwcGx5IiwiZGVzdHJveSIsImRpc2FibGUiLCJlbmFibGUiLCJyZWZyZXNoIiwibmV4dCIsInByZXZpb3VzIiwiaW52b2tlQWxsIiwibWV0aG9kIiwiYWxsV2F5cG9pbnRzQXJyYXkiLCJ3YXlwb2ludEtleSIsInB1c2giLCJlbmQiLCJkZXN0cm95QWxsIiwiZGlzYWJsZUFsbCIsImVuYWJsZUFsbCIsInJlZnJlc2hBbGwiLCJ2aWV3cG9ydEhlaWdodCIsImlubmVySGVpZ2h0IiwiZG9jdW1lbnRFbGVtZW50Iiwidmlld3BvcnRXaWR0aCIsImNsaWVudFdpZHRoIiwiYWRhcHRlcnMiLCJjb250aW51b3VzIiwiYm90dG9tLWluLXZpZXciLCJvdXRlckhlaWdodCIsInJpZ2h0LWluLXZpZXciLCJpbm5lcldpZHRoIiwib3V0ZXJXaWR0aCIsInJlcXVlc3RBbmltYXRpb25GcmFtZVNoaW0iLCJzZXRUaW1lb3V0IiwiZGlkU2Nyb2xsIiwiZGlkUmVzaXplIiwib2xkU2Nyb2xsIiwieCIsInNjcm9sbExlZnQiLCJ5Iiwic2Nyb2xsVG9wIiwidmVydGljYWwiLCJ3YXlwb2ludENvbnRleHRLZXkiLCJjb250ZXh0cyIsImNyZWF0ZVRocm90dGxlZFNjcm9sbEhhbmRsZXIiLCJjcmVhdGVUaHJvdHRsZWRSZXNpemVIYW5kbGVyIiwib2xkV2luZG93TG9hZCIsIm9ubG9hZCIsIndheXBvaW50IiwiY2hlY2tFbXB0eSIsImhvcml6b250YWxFbXB0eSIsImlzRW1wdHlPYmplY3QiLCJ2ZXJ0aWNhbEVtcHR5Iiwib2ZmIiwicmVzaXplSGFuZGxlciIsInNlbGYiLCJoYW5kbGVSZXNpemUiLCJvbiIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInNjcm9sbEhhbmRsZXIiLCJoYW5kbGVTY3JvbGwiLCJpc1RvdWNoIiwidHJpZ2dlcmVkR3JvdXBzIiwiYXhlcyIsIm5ld1Njcm9sbCIsImZvcndhcmQiLCJiYWNrd2FyZCIsImF4aXNLZXkiLCJpc0ZvcndhcmQiLCJ3YXNCZWZvcmVUcmlnZ2VyUG9pbnQiLCJub3dBZnRlclRyaWdnZXJQb2ludCIsImNyb3NzZWRGb3J3YXJkIiwiY3Jvc3NlZEJhY2t3YXJkIiwiaWQiLCJncm91cEtleSIsImZsdXNoVHJpZ2dlcnMiLCJpc1dpbmRvdyIsImNvbnRleHRPZmZzZXQiLCJ1bmRlZmluZWQiLCJsZWZ0IiwiY29udGV4dFNjcm9sbCIsImNvbnRleHREaW1lbnNpb24iLCJvZmZzZXRQcm9wIiwidG9wIiwiY29udGV4dE1vZGlmaWVyIiwid2FzQmVmb3JlU2Nyb2xsIiwibm93QWZ0ZXJTY3JvbGwiLCJ0cmlnZ2VyZWRCYWNrd2FyZCIsInRyaWdnZXJlZEZvcndhcmQiLCJhZGp1c3RtZW50Iiwib2xkVHJpZ2dlclBvaW50IiwiZWxlbWVudE9mZnNldCIsImZyZXNoV2F5cG9pbnQiLCJwYXJzZUZsb2F0IiwiaW5kZXhPZiIsImNlaWwiLCJmaW5kQnlFbGVtZW50IiwiY29udGV4dElkIiwicmVxdWVzdEZuIiwibW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwid2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYnlUcmlnZ2VyUG9pbnQiLCJiIiwiYnlSZXZlcnNlVHJpZ2dlclBvaW50IiwiY2xlYXJUcmlnZ2VyUXVldWVzIiwiZ3JvdXBzIiwidHJpZ2dlclF1ZXVlcyIsInVwIiwiZG93biIsInJpZ2h0IiwicmV2ZXJzZSIsInNvcnQiLCJpbkFycmF5IiwiaXNMYXN0Iiwic3BsaWNlIiwiZmlyc3QiLCJsYXN0IiwiZ2V0V2luZG93IiwiZGVmYXVsdFZpZXciLCJOb0ZyYW1ld29ya0FkYXB0ZXIiLCJoYW5kbGVycyIsImlzV2luIiwiZXZlbnQiLCJyZW1vdmVMaXN0ZW5lcnMiLCJsaXN0ZW5lcnMiLCJsaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudFBhcnRzIiwic3BsaXQiLCJldmVudFR5cGUiLCJuYW1lc3BhY2UiLCJucyIsInR5cGUiLCJvd25lckRvY3VtZW50Iiwid2luIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInBhZ2VZT2Zmc2V0IiwiY2xpZW50VG9wIiwicGFnZVhPZmZzZXQiLCJjbGllbnRMZWZ0IiwibnNIYW5kbGVycyIsIm5zVHlwZUxpc3QiLCJpbmNsdWRlTWFyZ2luIiwiY29tcHV0ZWRTdHlsZSIsImhlaWdodCIsImdldENvbXB1dGVkU3R5bGUiLCJwYXJzZUludCIsIm1hcmdpblRvcCIsIm1hcmdpbkJvdHRvbSIsIndpZHRoIiwibWFyZ2luTGVmdCIsIm1hcmdpblJpZ2h0IiwibWVyZ2UiLCJ0YXJnZXQiLCJoYXNPd25Qcm9wZXJ0eSIsImFyZ3VtZW50cyIsImFycmF5Il0sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLElBQUlBLFNBQTRCLGtCQUFYQyxTQUFvRCxnQkFBcEJBLFFBQU9DLFNBQXdCLFNBQVVDLEdBQU8sYUFBY0EsSUFBUyxTQUFVQSxHQUFPLE1BQU9BLElBQXlCLGtCQUFYRixTQUF5QkUsRUFBSUMsY0FBZ0JILE9BQVMsZUFBa0JFLEtDRjFPLFFBQVVFLEdBQUVDLEVBQUVDLEVBQUVDLEdBQUcsUUFBU0MsR0FBRUMsRUFBRUMsR0FBRyxJQUFJSixFQUFFRyxHQUFHLENBQUMsSUFBSUosRUFBRUksR0FBRyxDQUFDLEdBQUlFLEdBQWtCLGtCQUFUQyxVQUFxQkEsT0FBUSxLQUFJRixHQUFHQyxFQUFFLE1BQU9BLEdBQUVGLEdBQUUsRUFBSSxJQUFHSSxFQUFFLE1BQU9BLEdBQUVKLEdBQUUsRUFBSSxNQUFNLElBQUlLLE9BQU0sdUJBQXVCTCxFQUFFLEtBQUssR0FBSU0sR0FBRVQsRUFBRUcsSUFBSU8sV0FBWVgsR0FBRUksR0FBRyxHQUFHUSxLQUFLRixF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QUdUL0IsRUFBbUJuSyxVQUFVa0YsV0FBYSxXQUN4QyxHQUFJZ0csR0FBTWpCLEVBQVUxSSxLQUFLL0MsUUFDekIsT0FBTzBNLEdBQU1BLEVBQUlLLFlBQWNoSyxLQUFLL0MsUUFBUTBHLFlBRzlDaUYsRUFBbUJuSyxVQUFVb0YsVUFBWSxXQUN2QyxHQUFJOEYsR0FBTWpCLEVBQVUxSSxLQUFLL0MsUUFDekIsT0FBTzBNLEdBQU1BLEVBQUlHLFlBQWM5SixLQUFLL0MsUUFBUTRHLFdBRzlDK0UsRUFBbUJ4SSxPQUFTLFdBRzFCLFFBQVMwSyxHQUFNQyxFQUFRM1AsR0FDckIsR0FBc0IsWUFBbEIsbUJBQU8yUCxHQUFQLFlBQUE5UCxRQUFPOFAsS0FBc0MsWUFBZixtQkFBTzNQLEdBQVAsWUFBQUgsUUFBT0csSUFDdkMsSUFBSyxHQUFJNkUsS0FBTzdFLEdBQ1ZBLEVBQUk0UCxlQUFlL0ssS0FDckI4SyxFQUFPOUssR0FBTzdFLEVBQUk2RSxHQUt4QixPQUFPOEssR0FHVCxJQUFLLEdBZER4SixHQUFPL0MsTUFBTUMsVUFBVUMsTUFBTXZDLEtBQUs4TyxXQWM3QmxQLEVBQUksRUFBR3FHLEVBQU1iLEVBQUtuRixPQUFZZ0csRUFBSnJHLEVBQVNBLElBQzFDK08sRUFBTXZKLEVBQUssR0FBSUEsRUFBS3hGLEdBRXRCLE9BQU93RixHQUFLLElBR2RxSCxFQUFtQlAsUUFBVSxTQUFTcEwsRUFBU2lPLEVBQU9uUCxHQUNwRCxNQUFnQixPQUFUbVAsRUFBZ0IsR0FBS0EsRUFBTS9ELFFBQVFsSyxFQUFTbEIsSUFHckQ2TSxFQUFtQnBFLGNBQWdCLFNBQVNwSixHQUUxQyxJQUFLLEdBQUkyRixLQUFRM0YsR0FDZixPQUFPLENBRVQsUUFBTyxHQUdUNEIsRUFBUzhGLFNBQVNYLE1BQ2hCcEIsS0FBTSxjQUNOWixRQUFTeUksSUFFWDVMLEVBQVNtRCxRQUFVeUksZUFHViIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG4oZnVuY3Rpb24gZSh0LCBuLCByKSB7XG4gIGZ1bmN0aW9uIHMobywgdSkge1xuICAgIGlmICghbltvXSkge1xuICAgICAgaWYgKCF0W29dKSB7XG4gICAgICAgIHZhciBhID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7aWYgKCF1ICYmIGEpIHJldHVybiBhKG8sICEwKTtpZiAoaSkgcmV0dXJuIGkobywgITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyBvICsgXCInXCIpO1xuICAgICAgfXZhciBmID0gbltvXSA9IHsgZXhwb3J0czoge30gfTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgbiA9IHRbb11bMV1bZV07cmV0dXJuIHMobiA/IG4gOiBlKTtcbiAgICAgIH0sIGYsIGYuZXhwb3J0cywgZSwgdCwgbiwgcik7XG4gICAgfXJldHVybiBuW29dLmV4cG9ydHM7XG4gIH12YXIgaSA9IHR5cGVvZiByZXF1aXJlID09IFwiZnVuY3Rpb25cIiAmJiByZXF1aXJlO2ZvciAodmFyIG8gPSAwOyBvIDwgci5sZW5ndGg7IG8rKykge1xuICAgIHMocltvXSk7XG4gIH1yZXR1cm4gcztcbn0pKHsgMTogW2Z1bmN0aW9uIChyZXF1aXJlLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICByZXF1aXJlKCcuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHMnKTtcblxuICAgIHZhciBkb2NTdHlsZSA9IGRvY3VtZW50LmJvZHkuc3R5bGU7XG4gICAgdmFyIGJnUGF0aCA9IGRvY3VtZW50LmxvY2F0aW9uICsgJ2ltYWdlcy9iZy8nO1xuICAgIHZhciBpbWdFeHQgPSAnLnBuZyc7XG4gICAgdmFyIGJncyA9IFsnV2FsbFBhcGVyMicsICdXYWxsUGFwZXIyX3RvbmUnLCAnV2FsbFBhcGVyMi41JywgJ1dhbGxQYXBlcjMnLCAnV2FsbFBhcGVyMy41JywgJ1dhbGxQYXBlcjQnLCAnV2FsbFBhcGVyNC41JywgJ1dhbGxQYXBlcjUuNScsICdXYWxsUGFwZXI1LjVfdG9uZScsICdXYWxsUGFwZXI2JywgJ1dhbGxQYXBlcjYuNScsICdXYWxsUGFwZXI3LjUnLCAnV2FsbFBhcGVyNy41X3RvbmUnXTtcbiAgICB2YXIgYmdJbWFnZXNMb2FkZWQgPSBmYWxzZTtcblxuICAgIG5ldyBXYXlwb2ludCh7XG4gICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2F5cG9pbnRIZWFkZXInKSxcbiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoZGlyZWN0aW9uKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ1Njcm9sbGVkIHRvIHdheXBvaW50IDEnKVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gOyhmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgdmFyIHRocm90dGxlID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgb2JqKSB7XG4gICAgLy8gICAgICAgICBvYmogPSBvYmogfHwgd2luZG93O1xuICAgIC8vICAgICAgICAgdmFyIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAvLyAgICAgICAgIHZhciBmdW5jID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHsgcmV0dXJuOyB9XG4gICAgLy8gICAgICAgICAgICAgcnVubmluZyA9IHRydWU7XG4gICAgLy8gICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICAgICAgICAgICAgICBvYmouZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQobmFtZSkpO1xuICAgIC8vICAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgICB9O1xuICAgIC8vICAgICAgICAgb2JqLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZnVuYyk7XG4gICAgLy8gICAgIH07XG4gICAgLy9cbiAgICAvLyAgICAgLyogaW5pdCAtIHlvdSBjYW4gaW5pdCBhbnkgZXZlbnQgKi9cbiAgICAvLyAgICAgdGhyb3R0bGUoXCJyZXNpemVcIiwgXCJvcHRpbWl6ZWRSZXNpemVcIik7XG4gICAgLy8gfSkoKTtcbiAgICAvL1xuICAgIC8vIC8vIGhhbmRsZSBldmVudFxuICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwib3B0aW1pemVkUmVzaXplXCIsIGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICBjb25zb2xlLmxvZyhcIlJlc291cmNlIGNvbnNjaW91cyByZXNpemUgY2FsbGJhY2shXCIpO1xuICAgIC8vIH0pO1xuXG4gICAgLy8gVXRpbGl0eVxuICAgIC8vIHNldHVwIHdheXBvaW50c1xuICAgIHZhciBkZWZpbmVXYXlwb2ludHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB3aW5kb3cud2F5cG9pbnRzID0gW107XG4gICAgICB2YXIgd2F5cG9pbnRVbml0ID0gTWF0aC5mbG9vcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3JhcHBlcicpLmNsaWVudEhlaWdodCAvIGJncy5sZW5ndGgpO1xuICAgICAgYmdzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHdheXBvaW50VW5pdCAqIChpbmRleCArIDEpKTtcbiAgICAgICAgd2luZG93LndheXBvaW50c1tpbmRleF0gPSBuZXcgV2F5cG9pbnQoe1xuICAgICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YXlwb2ludEhlYWRlcicpLFxuICAgICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImxvYWRpbmcgXCIgKyBiZ3NbaW5kZXhdICsgXCIgZnJvbSBsb29wIGZ1bmN0aW9uXCIpOyAvL3Rlc3RcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb2Zmc2V0OiB3YXlwb2ludFVuaXQgKiAoaW5kZXggKyAxKSAqIC0xXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSgpO1xuICAgIC8vIHByZWxvYWQgaW1hZ2VzXG4gICAgaWYgKGJnSW1hZ2VzTG9hZGVkICE9PSB0cnVlKSB7XG4gICAgICBiZ3MuZm9yRWFjaChmdW5jdGlvbiAoYmcpIHtcbiAgICAgICAgbmV3IEltYWdlKCkuc3JjID0gYmdQYXRoICsgYmcgKyBpbWdFeHQ7XG4gICAgICAgIC8vIGNhY2hlcyBpbWFnZXMsIGF2b2lkaW5nIHdoaXRlIGZsYXNoIGJldHdlZW4gYmFja2dyb3VuZCByZXBsYWNlbWVudHNcbiAgICAgIH0pO1xuICAgICAgYmdJbWFnZXNMb2FkZWQgPSB0cnVlO1xuICAgIH1cbiAgICAvLyBsb2FkIGJnIGltYWdlXG4gICAgdmFyIGxvYWRCZyA9IGZ1bmN0aW9uIGxvYWRCZyhiZykge1xuICAgICAgZG9jU3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBiZ1BhdGggKyBiZ3NbYmddICsgaW1nRXh0ICsgXCIpXCI7XG4gICAgICBjb25zb2xlLmxvZyhcImxvYWRpbmcgXCIgKyBiZ1BhdGggKyBiZ3NbYmddICsgaW1nRXh0KTtcbiAgICB9O1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8gYnVzaW5lc3Mgc2VsZWN0IGJ1dHRvbnNcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIHZhciBidXNpbmVzc1NlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5idXNpbmVzcy10eXBlLXNlbGVjdCcpO1xuICAgIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGJ1c2luZXNzU2VsZWN0KS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVsKTtcbiAgICAgICAgLy8gZ2V0IHRoZSBhY3RpdmUgbWVudSBpdGVtIGFuZCB0dXJuIGl0IG9mZlxuICAgICAgICB2YXIgY3VycmVudEFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXNpbmVzcy10eXBlLXNlbGVjdC5hY3RpdmUnKTtcbiAgICAgICAgaWYgKGN1cnJlbnRBY3RpdmUpIHtcbiAgICAgICAgICBjdXJyZW50QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHR1cm4gb24gdGhlIG5ldyBtZW51IGl0ZW1cbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgIC8vIHNob3cgdGhlIG5hdlxuICAgICAgICB2YXIgbWVudXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGNyLW1lbnUnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZW51cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIG1lbnVzW2ldLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgIH1cbiAgICAgICAgZm9sZE1lbnUuYWNjb3JkaW9uKDAsICdib3R0b20nLCBmdW5jdGlvbiAoZXYsIG9yaSkge1xuICAgICAgICAgIG9yaS5lbC5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7XG4gICAgICAgICAgY29uc29sZS5sb2coZXYsIG9yaSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgLy8vLy8vLy8vLy9cbiAgICAvLyBoY3IgbWVudVxuICAgIC8vLy8vLy8vLy8vXG4gICAgdmFyIGZvbGRNZW51ID0gbmV3IE9yaURvbWkoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhjci1tZW51JyksIHtcbiAgICAgIGhQYW5lbHM6IDksXG4gICAgICByaXBwbGU6IDIsXG4gICAgICBzaGFkaW5nOiAnaGFyZCcsXG4gICAgICB0b3VjaEVuYWJsZWQ6IGZhbHNlXG4gICAgfSk7XG4gICAgLy8gbG9hZFxuICAgIGZvbGRNZW51LmZvbGRVcCgnYm90dG9tJyk7XG5cbiAgICAvLyBjbGlja1xuXG4gICAgLy8gbGV0IGZvbGRNZW51ID0gbmV3IE9yaURvbWkoZG9jdW0gZW50LnF1ZXJ5U2VsZWN0b3IoJy5oY3ItbWVudScpLCB7XG4gICAgLy8gICAgIC8vdlBhbmVsczogICAgICAgICA1LCAgICAgLy8gbnVtYmVyIG9mIHBhbmVscyB3aGVuIGZvbGRpbmcgbGVmdCBvciByaWdodCAodmVydGljYWxseSBvcmllbnRlZClcbiAgICAvLyAgICAgaFBhbmVsczogICAgICAgICA0LCAgICAvLyBudW1iZXIgb2YgcGFuZWxzIHdoZW4gZm9sZGluZyB0b3Agb3IgYm90dG9tXG4gICAgLy8gICAgIHRvdWNoRW5hYmxlZDogZmFsc2UsXG4gICAgLy8gICAgIC8vIHNwZWVkOiAgICAgICAgICAgMTIwMCwgIC8vIGZvbGRpbmcgZHVyYXRpb24gaW4gbXNcbiAgICAvLyAgICAgcmlwcGxlOiAgICAgICAgICAyLCAgICAgLy8gYmFja3dhcmRzIHJpcHBsZSBlZmZlY3Qgd2hlbiBhbmltYXRpbmdcbiAgICAvLyAgICAgc2hhZGluZ0ludGVzaXR5OiAuNSwgICAgLy8gbGVzc2VuIHRoZSBzaGFkaW5nIGVmZmVjdFxuICAgIC8vICAgICAvLyBwZXJzcGVjdGl2ZTogICAgIDgwMCwgICAvLyBzbWFsbGVyIHZhbHVlcyBleGFnZ2VyYXRlIDNEIGRpc3RvcnRpb25cbiAgICAvLyAgICAgLy8gbWF4QW5nbGU6ICAgICAgICA0MCwgICAgLy8ga2VlcCB0aGUgdXNlcidzIGZvbGRzIHdpdGhpbiBhIHJhbmdlIG9mIC00MCB0byA0MCBkZWdyZWVzXG4gICAgLy8gICAgIC8vIHNoYWRpbmc6ICAgICAgICAgJ3NvZnQnIC8vIGNoYW5nZSB0aGUgc2hhZGluZyB0eXBlXG4gICAgLy8gfSk7XG4gICAgLy8gZm9sZE1lbnUuYWNjb3JkaW9uKDYwLCAndG9wJyk7XG4gICAgLy8gZm9sZE1lbnUub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgLy8gICAgIHRoaXMudW5mb2xkKCk7XG4gICAgLy8gfVxuICB9LCB7IFwiLi4vbm9kZV9tb2R1bGVzL3dheXBvaW50cy9saWIvbm9mcmFtZXdvcmsud2F5cG9pbnRzXCI6IDIgfV0sIDI6IFtmdW5jdGlvbiAocmVxdWlyZSwgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgLyohXG4gICAgV2F5cG9pbnRzIC0gNC4wLjBcbiAgICBDb3B5cmlnaHQgwqkgMjAxMS0yMDE1IENhbGViIFRyb3VnaHRvblxuICAgIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAgICBodHRwczovL2dpdGh1Yi5jb20vaW1ha2V3ZWJ0aGluZ3Mvd2F5cG9pbnRzL2Jsb2cvbWFzdGVyL2xpY2Vuc2VzLnR4dFxuICAgICovXG4gICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgdmFyIGtleUNvdW50ZXIgPSAwO1xuICAgICAgdmFyIGFsbFdheXBvaW50cyA9IHt9O1xuXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvd2F5cG9pbnQgKi9cbiAgICAgIGZ1bmN0aW9uIFdheXBvaW50KG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBvcHRpb25zIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb3B0aW9ucy5lbGVtZW50KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBlbGVtZW50IG9wdGlvbiBwYXNzZWQgdG8gV2F5cG9pbnQgY29uc3RydWN0b3InKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW9wdGlvbnMuaGFuZGxlcikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gaGFuZGxlciBvcHRpb24gcGFzc2VkIHRvIFdheXBvaW50IGNvbnN0cnVjdG9yJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmtleSA9ICd3YXlwb2ludC0nICsga2V5Q291bnRlcjtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gV2F5cG9pbnQuQWRhcHRlci5leHRlbmQoe30sIFdheXBvaW50LmRlZmF1bHRzLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gdGhpcy5vcHRpb25zLmVsZW1lbnQ7XG4gICAgICAgIHRoaXMuYWRhcHRlciA9IG5ldyBXYXlwb2ludC5BZGFwdGVyKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBvcHRpb25zLmhhbmRsZXI7XG4gICAgICAgIHRoaXMuYXhpcyA9IHRoaXMub3B0aW9ucy5ob3Jpem9udGFsID8gJ2hvcml6b250YWwnIDogJ3ZlcnRpY2FsJztcbiAgICAgICAgdGhpcy5lbmFibGVkID0gdGhpcy5vcHRpb25zLmVuYWJsZWQ7XG4gICAgICAgIHRoaXMudHJpZ2dlclBvaW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5ncm91cCA9IFdheXBvaW50Lkdyb3VwLmZpbmRPckNyZWF0ZSh7XG4gICAgICAgICAgbmFtZTogdGhpcy5vcHRpb25zLmdyb3VwLFxuICAgICAgICAgIGF4aXM6IHRoaXMuYXhpc1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gV2F5cG9pbnQuQ29udGV4dC5maW5kT3JDcmVhdGVCeUVsZW1lbnQodGhpcy5vcHRpb25zLmNvbnRleHQpO1xuXG4gICAgICAgIGlmIChXYXlwb2ludC5vZmZzZXRBbGlhc2VzW3RoaXMub3B0aW9ucy5vZmZzZXRdKSB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zLm9mZnNldCA9IFdheXBvaW50Lm9mZnNldEFsaWFzZXNbdGhpcy5vcHRpb25zLm9mZnNldF07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ncm91cC5hZGQodGhpcyk7XG4gICAgICAgIHRoaXMuY29udGV4dC5hZGQodGhpcyk7XG4gICAgICAgIGFsbFdheXBvaW50c1t0aGlzLmtleV0gPSB0aGlzO1xuICAgICAgICBrZXlDb3VudGVyICs9IDE7XG4gICAgICB9XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIFdheXBvaW50LnByb3RvdHlwZS5xdWV1ZVRyaWdnZXIgPSBmdW5jdGlvbiAoZGlyZWN0aW9uKSB7XG4gICAgICAgIHRoaXMuZ3JvdXAucXVldWVUcmlnZ2VyKHRoaXMsIGRpcmVjdGlvbik7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBXYXlwb2ludC5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5jYWxsYmFjay5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZGVzdHJveSAqL1xuICAgICAgV2F5cG9pbnQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY29udGV4dC5yZW1vdmUodGhpcyk7XG4gICAgICAgIHRoaXMuZ3JvdXAucmVtb3ZlKHRoaXMpO1xuICAgICAgICBkZWxldGUgYWxsV2F5cG9pbnRzW3RoaXMua2V5XTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rpc2FibGUgKi9cbiAgICAgIFdheXBvaW50LnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9lbmFibGUgKi9cbiAgICAgIFdheXBvaW50LnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY29udGV4dC5yZWZyZXNoKCk7XG4gICAgICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvbmV4dCAqL1xuICAgICAgV2F5cG9pbnQucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdyb3VwLm5leHQodGhpcyk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9wcmV2aW91cyAqL1xuICAgICAgV2F5cG9pbnQucHJvdG90eXBlLnByZXZpb3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ncm91cC5wcmV2aW91cyh0aGlzKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIFdheXBvaW50Lmludm9rZUFsbCA9IGZ1bmN0aW9uIChtZXRob2QpIHtcbiAgICAgICAgdmFyIGFsbFdheXBvaW50c0FycmF5ID0gW107XG4gICAgICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIGFsbFdheXBvaW50cykge1xuICAgICAgICAgIGFsbFdheXBvaW50c0FycmF5LnB1c2goYWxsV2F5cG9pbnRzW3dheXBvaW50S2V5XSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IGFsbFdheXBvaW50c0FycmF5Lmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgYWxsV2F5cG9pbnRzQXJyYXlbaV1bbWV0aG9kXSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kZXN0cm95LWFsbCAqL1xuICAgICAgV2F5cG9pbnQuZGVzdHJveUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgV2F5cG9pbnQuaW52b2tlQWxsKCdkZXN0cm95Jyk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kaXNhYmxlLWFsbCAqL1xuICAgICAgV2F5cG9pbnQuZGlzYWJsZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgV2F5cG9pbnQuaW52b2tlQWxsKCdkaXNhYmxlJyk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9lbmFibGUtYWxsICovXG4gICAgICBXYXlwb2ludC5lbmFibGVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFdheXBvaW50Lmludm9rZUFsbCgnZW5hYmxlJyk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9yZWZyZXNoLWFsbCAqL1xuICAgICAgV2F5cG9pbnQucmVmcmVzaEFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgV2F5cG9pbnQuQ29udGV4dC5yZWZyZXNoQWxsKCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS92aWV3cG9ydC1oZWlnaHQgKi9cbiAgICAgIFdheXBvaW50LnZpZXdwb3J0SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS92aWV3cG9ydC13aWR0aCAqL1xuICAgICAgV2F5cG9pbnQudmlld3BvcnRXaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICAgIH07XG5cbiAgICAgIFdheXBvaW50LmFkYXB0ZXJzID0gW107XG5cbiAgICAgIFdheXBvaW50LmRlZmF1bHRzID0ge1xuICAgICAgICBjb250ZXh0OiB3aW5kb3csXG4gICAgICAgIGNvbnRpbnVvdXM6IHRydWUsXG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgIGdyb3VwOiAnZGVmYXVsdCcsXG4gICAgICAgIGhvcml6b250YWw6IGZhbHNlLFxuICAgICAgICBvZmZzZXQ6IDBcbiAgICAgIH07XG5cbiAgICAgIFdheXBvaW50Lm9mZnNldEFsaWFzZXMgPSB7XG4gICAgICAgICdib3R0b20taW4tdmlldyc6IGZ1bmN0aW9uIGJvdHRvbUluVmlldygpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmlubmVySGVpZ2h0KCkgLSB0aGlzLmFkYXB0ZXIub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgJ3JpZ2h0LWluLXZpZXcnOiBmdW5jdGlvbiByaWdodEluVmlldygpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmlubmVyV2lkdGgoKSAtIHRoaXMuYWRhcHRlci5vdXRlcldpZHRoKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHdpbmRvdy5XYXlwb2ludCA9IFdheXBvaW50O1xuICAgIH0pKCk7KGZ1bmN0aW9uICgpIHtcbiAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgZnVuY3Rpb24gcmVxdWVzdEFuaW1hdGlvbkZyYW1lU2hpbShjYWxsYmFjaykge1xuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGtleUNvdW50ZXIgPSAwO1xuICAgICAgdmFyIGNvbnRleHRzID0ge307XG4gICAgICB2YXIgV2F5cG9pbnQgPSB3aW5kb3cuV2F5cG9pbnQ7XG4gICAgICB2YXIgb2xkV2luZG93TG9hZCA9IHdpbmRvdy5vbmxvYWQ7XG5cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0ICovXG4gICAgICBmdW5jdGlvbiBDb250ZXh0KGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5BZGFwdGVyID0gV2F5cG9pbnQuQWRhcHRlcjtcbiAgICAgICAgdGhpcy5hZGFwdGVyID0gbmV3IHRoaXMuQWRhcHRlcihlbGVtZW50KTtcbiAgICAgICAgdGhpcy5rZXkgPSAnd2F5cG9pbnQtY29udGV4dC0nICsga2V5Q291bnRlcjtcbiAgICAgICAgdGhpcy5kaWRTY3JvbGwgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5kaWRSZXNpemUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vbGRTY3JvbGwgPSB7XG4gICAgICAgICAgeDogdGhpcy5hZGFwdGVyLnNjcm9sbExlZnQoKSxcbiAgICAgICAgICB5OiB0aGlzLmFkYXB0ZXIuc2Nyb2xsVG9wKClcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy53YXlwb2ludHMgPSB7XG4gICAgICAgICAgdmVydGljYWw6IHt9LFxuICAgICAgICAgIGhvcml6b250YWw6IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgZWxlbWVudC53YXlwb2ludENvbnRleHRLZXkgPSB0aGlzLmtleTtcbiAgICAgICAgY29udGV4dHNbZWxlbWVudC53YXlwb2ludENvbnRleHRLZXldID0gdGhpcztcbiAgICAgICAga2V5Q291bnRlciArPSAxO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlVGhyb3R0bGVkU2Nyb2xsSGFuZGxlcigpO1xuICAgICAgICB0aGlzLmNyZWF0ZVRocm90dGxlZFJlc2l6ZUhhbmRsZXIoKTtcbiAgICAgIH1cblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHdheXBvaW50KSB7XG4gICAgICAgIHZhciBheGlzID0gd2F5cG9pbnQub3B0aW9ucy5ob3Jpem9udGFsID8gJ2hvcml6b250YWwnIDogJ3ZlcnRpY2FsJztcbiAgICAgICAgdGhpcy53YXlwb2ludHNbYXhpc11bd2F5cG9pbnQua2V5XSA9IHdheXBvaW50O1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmNoZWNrRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBob3Jpem9udGFsRW1wdHkgPSB0aGlzLkFkYXB0ZXIuaXNFbXB0eU9iamVjdCh0aGlzLndheXBvaW50cy5ob3Jpem9udGFsKTtcbiAgICAgICAgdmFyIHZlcnRpY2FsRW1wdHkgPSB0aGlzLkFkYXB0ZXIuaXNFbXB0eU9iamVjdCh0aGlzLndheXBvaW50cy52ZXJ0aWNhbCk7XG4gICAgICAgIGlmIChob3Jpem9udGFsRW1wdHkgJiYgdmVydGljYWxFbXB0eSkge1xuICAgICAgICAgIHRoaXMuYWRhcHRlci5vZmYoJy53YXlwb2ludHMnKTtcbiAgICAgICAgICBkZWxldGUgY29udGV4dHNbdGhpcy5rZXldO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5jcmVhdGVUaHJvdHRsZWRSZXNpemVIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgZnVuY3Rpb24gcmVzaXplSGFuZGxlcigpIHtcbiAgICAgICAgICBzZWxmLmhhbmRsZVJlc2l6ZSgpO1xuICAgICAgICAgIHNlbGYuZGlkUmVzaXplID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFkYXB0ZXIub24oJ3Jlc2l6ZS53YXlwb2ludHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKCFzZWxmLmRpZFJlc2l6ZSkge1xuICAgICAgICAgICAgc2VsZi5kaWRSZXNpemUgPSB0cnVlO1xuICAgICAgICAgICAgV2F5cG9pbnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlc2l6ZUhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5jcmVhdGVUaHJvdHRsZWRTY3JvbGxIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHNjcm9sbEhhbmRsZXIoKSB7XG4gICAgICAgICAgc2VsZi5oYW5kbGVTY3JvbGwoKTtcbiAgICAgICAgICBzZWxmLmRpZFNjcm9sbCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hZGFwdGVyLm9uKCdzY3JvbGwud2F5cG9pbnRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICghc2VsZi5kaWRTY3JvbGwgfHwgV2F5cG9pbnQuaXNUb3VjaCkge1xuICAgICAgICAgICAgc2VsZi5kaWRTY3JvbGwgPSB0cnVlO1xuICAgICAgICAgICAgV2F5cG9pbnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNjcm9sbEhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5oYW5kbGVSZXNpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFdheXBvaW50LkNvbnRleHQucmVmcmVzaEFsbCgpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuaGFuZGxlU2Nyb2xsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdHJpZ2dlcmVkR3JvdXBzID0ge307XG4gICAgICAgIHZhciBheGVzID0ge1xuICAgICAgICAgIGhvcml6b250YWw6IHtcbiAgICAgICAgICAgIG5ld1Njcm9sbDogdGhpcy5hZGFwdGVyLnNjcm9sbExlZnQoKSxcbiAgICAgICAgICAgIG9sZFNjcm9sbDogdGhpcy5vbGRTY3JvbGwueCxcbiAgICAgICAgICAgIGZvcndhcmQ6ICdyaWdodCcsXG4gICAgICAgICAgICBiYWNrd2FyZDogJ2xlZnQnXG4gICAgICAgICAgfSxcbiAgICAgICAgICB2ZXJ0aWNhbDoge1xuICAgICAgICAgICAgbmV3U2Nyb2xsOiB0aGlzLmFkYXB0ZXIuc2Nyb2xsVG9wKCksXG4gICAgICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLnksXG4gICAgICAgICAgICBmb3J3YXJkOiAnZG93bicsXG4gICAgICAgICAgICBiYWNrd2FyZDogJ3VwJ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBheGlzS2V5IGluIGF4ZXMpIHtcbiAgICAgICAgICB2YXIgYXhpcyA9IGF4ZXNbYXhpc0tleV07XG4gICAgICAgICAgdmFyIGlzRm9yd2FyZCA9IGF4aXMubmV3U2Nyb2xsID4gYXhpcy5vbGRTY3JvbGw7XG4gICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IGlzRm9yd2FyZCA/IGF4aXMuZm9yd2FyZCA6IGF4aXMuYmFja3dhcmQ7XG5cbiAgICAgICAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiB0aGlzLndheXBvaW50c1theGlzS2V5XSkge1xuICAgICAgICAgICAgdmFyIHdheXBvaW50ID0gdGhpcy53YXlwb2ludHNbYXhpc0tleV1bd2F5cG9pbnRLZXldO1xuICAgICAgICAgICAgdmFyIHdhc0JlZm9yZVRyaWdnZXJQb2ludCA9IGF4aXMub2xkU2Nyb2xsIDwgd2F5cG9pbnQudHJpZ2dlclBvaW50O1xuICAgICAgICAgICAgdmFyIG5vd0FmdGVyVHJpZ2dlclBvaW50ID0gYXhpcy5uZXdTY3JvbGwgPj0gd2F5cG9pbnQudHJpZ2dlclBvaW50O1xuICAgICAgICAgICAgdmFyIGNyb3NzZWRGb3J3YXJkID0gd2FzQmVmb3JlVHJpZ2dlclBvaW50ICYmIG5vd0FmdGVyVHJpZ2dlclBvaW50O1xuICAgICAgICAgICAgdmFyIGNyb3NzZWRCYWNrd2FyZCA9ICF3YXNCZWZvcmVUcmlnZ2VyUG9pbnQgJiYgIW5vd0FmdGVyVHJpZ2dlclBvaW50O1xuICAgICAgICAgICAgaWYgKGNyb3NzZWRGb3J3YXJkIHx8IGNyb3NzZWRCYWNrd2FyZCkge1xuICAgICAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGdyb3VwS2V5IGluIHRyaWdnZXJlZEdyb3Vwcykge1xuICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1tncm91cEtleV0uZmx1c2hUcmlnZ2VycygpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5vbGRTY3JvbGwgPSB7XG4gICAgICAgICAgeDogYXhlcy5ob3Jpem9udGFsLm5ld1Njcm9sbCxcbiAgICAgICAgICB5OiBheGVzLnZlcnRpY2FsLm5ld1Njcm9sbFxuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuaW5uZXJIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qZXNsaW50LWRpc2FibGUgZXFlcWVxICovXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT0gdGhpcy5lbGVtZW50LndpbmRvdykge1xuICAgICAgICAgIHJldHVybiBXYXlwb2ludC52aWV3cG9ydEhlaWdodCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qZXNsaW50LWVuYWJsZSBlcWVxZXEgKi9cbiAgICAgICAgcmV0dXJuIHRoaXMuYWRhcHRlci5pbm5lckhlaWdodCgpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHdheXBvaW50KSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLndheXBvaW50c1t3YXlwb2ludC5heGlzXVt3YXlwb2ludC5rZXldO1xuICAgICAgICB0aGlzLmNoZWNrRW1wdHkoKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmlubmVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qZXNsaW50LWRpc2FibGUgZXFlcWVxICovXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT0gdGhpcy5lbGVtZW50LndpbmRvdykge1xuICAgICAgICAgIHJldHVybiBXYXlwb2ludC52aWV3cG9ydFdpZHRoKCk7XG4gICAgICAgIH1cbiAgICAgICAgLyplc2xpbnQtZW5hYmxlIGVxZXFlcSAqL1xuICAgICAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmlubmVyV2lkdGgoKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQtZGVzdHJveSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFsbFdheXBvaW50cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBheGlzIGluIHRoaXMud2F5cG9pbnRzKSB7XG4gICAgICAgICAgZm9yICh2YXIgd2F5cG9pbnRLZXkgaW4gdGhpcy53YXlwb2ludHNbYXhpc10pIHtcbiAgICAgICAgICAgIGFsbFdheXBvaW50cy5wdXNoKHRoaXMud2F5cG9pbnRzW2F4aXNdW3dheXBvaW50S2V5XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSBhbGxXYXlwb2ludHMubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICBhbGxXYXlwb2ludHNbaV0uZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0LXJlZnJlc2ggKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qZXNsaW50LWRpc2FibGUgZXFlcWVxICovXG4gICAgICAgIHZhciBpc1dpbmRvdyA9IHRoaXMuZWxlbWVudCA9PSB0aGlzLmVsZW1lbnQud2luZG93O1xuICAgICAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgICAgIHZhciBjb250ZXh0T2Zmc2V0ID0gaXNXaW5kb3cgPyB1bmRlZmluZWQgOiB0aGlzLmFkYXB0ZXIub2Zmc2V0KCk7XG4gICAgICAgIHZhciB0cmlnZ2VyZWRHcm91cHMgPSB7fTtcbiAgICAgICAgdmFyIGF4ZXM7XG5cbiAgICAgICAgdGhpcy5oYW5kbGVTY3JvbGwoKTtcbiAgICAgICAgYXhlcyA9IHtcbiAgICAgICAgICBob3Jpem9udGFsOiB7XG4gICAgICAgICAgICBjb250ZXh0T2Zmc2V0OiBpc1dpbmRvdyA/IDAgOiBjb250ZXh0T2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICBjb250ZXh0U2Nyb2xsOiBpc1dpbmRvdyA/IDAgOiB0aGlzLm9sZFNjcm9sbC54LFxuICAgICAgICAgICAgY29udGV4dERpbWVuc2lvbjogdGhpcy5pbm5lcldpZHRoKCksXG4gICAgICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLngsXG4gICAgICAgICAgICBmb3J3YXJkOiAncmlnaHQnLFxuICAgICAgICAgICAgYmFja3dhcmQ6ICdsZWZ0JyxcbiAgICAgICAgICAgIG9mZnNldFByb3A6ICdsZWZ0J1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdmVydGljYWw6IHtcbiAgICAgICAgICAgIGNvbnRleHRPZmZzZXQ6IGlzV2luZG93ID8gMCA6IGNvbnRleHRPZmZzZXQudG9wLFxuICAgICAgICAgICAgY29udGV4dFNjcm9sbDogaXNXaW5kb3cgPyAwIDogdGhpcy5vbGRTY3JvbGwueSxcbiAgICAgICAgICAgIGNvbnRleHREaW1lbnNpb246IHRoaXMuaW5uZXJIZWlnaHQoKSxcbiAgICAgICAgICAgIG9sZFNjcm9sbDogdGhpcy5vbGRTY3JvbGwueSxcbiAgICAgICAgICAgIGZvcndhcmQ6ICdkb3duJyxcbiAgICAgICAgICAgIGJhY2t3YXJkOiAndXAnLFxuICAgICAgICAgICAgb2Zmc2V0UHJvcDogJ3RvcCdcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgYXhpc0tleSBpbiBheGVzKSB7XG4gICAgICAgICAgdmFyIGF4aXMgPSBheGVzW2F4aXNLZXldO1xuICAgICAgICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIHRoaXMud2F5cG9pbnRzW2F4aXNLZXldKSB7XG4gICAgICAgICAgICB2YXIgd2F5cG9pbnQgPSB0aGlzLndheXBvaW50c1theGlzS2V5XVt3YXlwb2ludEtleV07XG4gICAgICAgICAgICB2YXIgYWRqdXN0bWVudCA9IHdheXBvaW50Lm9wdGlvbnMub2Zmc2V0O1xuICAgICAgICAgICAgdmFyIG9sZFRyaWdnZXJQb2ludCA9IHdheXBvaW50LnRyaWdnZXJQb2ludDtcbiAgICAgICAgICAgIHZhciBlbGVtZW50T2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHZhciBmcmVzaFdheXBvaW50ID0gb2xkVHJpZ2dlclBvaW50ID09IG51bGw7XG4gICAgICAgICAgICB2YXIgY29udGV4dE1vZGlmaWVyLCB3YXNCZWZvcmVTY3JvbGwsIG5vd0FmdGVyU2Nyb2xsO1xuICAgICAgICAgICAgdmFyIHRyaWdnZXJlZEJhY2t3YXJkLCB0cmlnZ2VyZWRGb3J3YXJkO1xuXG4gICAgICAgICAgICBpZiAod2F5cG9pbnQuZWxlbWVudCAhPT0gd2F5cG9pbnQuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgICAgICAgICAgZWxlbWVudE9mZnNldCA9IHdheXBvaW50LmFkYXB0ZXIub2Zmc2V0KClbYXhpcy5vZmZzZXRQcm9wXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhZGp1c3RtZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgIGFkanVzdG1lbnQgPSBhZGp1c3RtZW50LmFwcGx5KHdheXBvaW50KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFkanVzdG1lbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGFkanVzdG1lbnQgPSBwYXJzZUZsb2F0KGFkanVzdG1lbnQpO1xuICAgICAgICAgICAgICBpZiAod2F5cG9pbnQub3B0aW9ucy5vZmZzZXQuaW5kZXhPZignJScpID4gLTEpIHtcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50ID0gTWF0aC5jZWlsKGF4aXMuY29udGV4dERpbWVuc2lvbiAqIGFkanVzdG1lbnQgLyAxMDApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnRleHRNb2RpZmllciA9IGF4aXMuY29udGV4dFNjcm9sbCAtIGF4aXMuY29udGV4dE9mZnNldDtcbiAgICAgICAgICAgIHdheXBvaW50LnRyaWdnZXJQb2ludCA9IGVsZW1lbnRPZmZzZXQgKyBjb250ZXh0TW9kaWZpZXIgLSBhZGp1c3RtZW50O1xuICAgICAgICAgICAgd2FzQmVmb3JlU2Nyb2xsID0gb2xkVHJpZ2dlclBvaW50IDwgYXhpcy5vbGRTY3JvbGw7XG4gICAgICAgICAgICBub3dBZnRlclNjcm9sbCA9IHdheXBvaW50LnRyaWdnZXJQb2ludCA+PSBheGlzLm9sZFNjcm9sbDtcbiAgICAgICAgICAgIHRyaWdnZXJlZEJhY2t3YXJkID0gd2FzQmVmb3JlU2Nyb2xsICYmIG5vd0FmdGVyU2Nyb2xsO1xuICAgICAgICAgICAgdHJpZ2dlcmVkRm9yd2FyZCA9ICF3YXNCZWZvcmVTY3JvbGwgJiYgIW5vd0FmdGVyU2Nyb2xsO1xuXG4gICAgICAgICAgICBpZiAoIWZyZXNoV2F5cG9pbnQgJiYgdHJpZ2dlcmVkQmFja3dhcmQpIHtcbiAgICAgICAgICAgICAgd2F5cG9pbnQucXVldWVUcmlnZ2VyKGF4aXMuYmFja3dhcmQpO1xuICAgICAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbd2F5cG9pbnQuZ3JvdXAuaWRdID0gd2F5cG9pbnQuZ3JvdXA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFmcmVzaFdheXBvaW50ICYmIHRyaWdnZXJlZEZvcndhcmQpIHtcbiAgICAgICAgICAgICAgd2F5cG9pbnQucXVldWVUcmlnZ2VyKGF4aXMuZm9yd2FyZCk7XG4gICAgICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZnJlc2hXYXlwb2ludCAmJiBheGlzLm9sZFNjcm9sbCA+PSB3YXlwb2ludC50cmlnZ2VyUG9pbnQpIHtcbiAgICAgICAgICAgICAgd2F5cG9pbnQucXVldWVUcmlnZ2VyKGF4aXMuZm9yd2FyZCk7XG4gICAgICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGZvciAodmFyIGdyb3VwS2V5IGluIHRyaWdnZXJlZEdyb3Vwcykge1xuICAgICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW2dyb3VwS2V5XS5mbHVzaFRyaWdnZXJzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQuZmluZE9yQ3JlYXRlQnlFbGVtZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIENvbnRleHQuZmluZEJ5RWxlbWVudChlbGVtZW50KSB8fCBuZXcgQ29udGV4dChlbGVtZW50KTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucmVmcmVzaEFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgY29udGV4dElkIGluIGNvbnRleHRzKSB7XG4gICAgICAgICAgY29udGV4dHNbY29udGV4dElkXS5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQtZmluZC1ieS1lbGVtZW50ICovXG4gICAgICBDb250ZXh0LmZpbmRCeUVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gY29udGV4dHNbZWxlbWVudC53YXlwb2ludENvbnRleHRLZXldO1xuICAgICAgfTtcblxuICAgICAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKG9sZFdpbmRvd0xvYWQpIHtcbiAgICAgICAgICBvbGRXaW5kb3dMb2FkKCk7XG4gICAgICAgIH1cbiAgICAgICAgQ29udGV4dC5yZWZyZXNoQWxsKCk7XG4gICAgICB9O1xuXG4gICAgICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHJlcXVlc3RGbiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHJlcXVlc3RBbmltYXRpb25GcmFtZVNoaW07XG4gICAgICAgIHJlcXVlc3RGbi5jYWxsKHdpbmRvdywgY2FsbGJhY2spO1xuICAgICAgfTtcbiAgICAgIFdheXBvaW50LkNvbnRleHQgPSBDb250ZXh0O1xuICAgIH0pKCk7KGZ1bmN0aW9uICgpIHtcbiAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgZnVuY3Rpb24gYnlUcmlnZ2VyUG9pbnQoYSwgYikge1xuICAgICAgICByZXR1cm4gYS50cmlnZ2VyUG9pbnQgLSBiLnRyaWdnZXJQb2ludDtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYnlSZXZlcnNlVHJpZ2dlclBvaW50KGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGIudHJpZ2dlclBvaW50IC0gYS50cmlnZ2VyUG9pbnQ7XG4gICAgICB9XG5cbiAgICAgIHZhciBncm91cHMgPSB7XG4gICAgICAgIHZlcnRpY2FsOiB7fSxcbiAgICAgICAgaG9yaXpvbnRhbDoge31cbiAgICAgIH07XG4gICAgICB2YXIgV2F5cG9pbnQgPSB3aW5kb3cuV2F5cG9pbnQ7XG5cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9ncm91cCAqL1xuICAgICAgZnVuY3Rpb24gR3JvdXAob3B0aW9ucykge1xuICAgICAgICB0aGlzLm5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMuYXhpcyA9IG9wdGlvbnMuYXhpcztcbiAgICAgICAgdGhpcy5pZCA9IHRoaXMubmFtZSArICctJyArIHRoaXMuYXhpcztcbiAgICAgICAgdGhpcy53YXlwb2ludHMgPSBbXTtcbiAgICAgICAgdGhpcy5jbGVhclRyaWdnZXJRdWV1ZXMoKTtcbiAgICAgICAgZ3JvdXBzW3RoaXMuYXhpc11bdGhpcy5uYW1lXSA9IHRoaXM7XG4gICAgICB9XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAod2F5cG9pbnQpIHtcbiAgICAgICAgdGhpcy53YXlwb2ludHMucHVzaCh3YXlwb2ludCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5wcm90b3R5cGUuY2xlYXJUcmlnZ2VyUXVldWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnRyaWdnZXJRdWV1ZXMgPSB7XG4gICAgICAgICAgdXA6IFtdLFxuICAgICAgICAgIGRvd246IFtdLFxuICAgICAgICAgIGxlZnQ6IFtdLFxuICAgICAgICAgIHJpZ2h0OiBbXVxuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLmZsdXNoVHJpZ2dlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGRpcmVjdGlvbiBpbiB0aGlzLnRyaWdnZXJRdWV1ZXMpIHtcbiAgICAgICAgICB2YXIgd2F5cG9pbnRzID0gdGhpcy50cmlnZ2VyUXVldWVzW2RpcmVjdGlvbl07XG4gICAgICAgICAgdmFyIHJldmVyc2UgPSBkaXJlY3Rpb24gPT09ICd1cCcgfHwgZGlyZWN0aW9uID09PSAnbGVmdCc7XG4gICAgICAgICAgd2F5cG9pbnRzLnNvcnQocmV2ZXJzZSA/IGJ5UmV2ZXJzZVRyaWdnZXJQb2ludCA6IGJ5VHJpZ2dlclBvaW50KTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gd2F5cG9pbnRzLmxlbmd0aDsgaSA8IGVuZDsgaSArPSAxKSB7XG4gICAgICAgICAgICB2YXIgd2F5cG9pbnQgPSB3YXlwb2ludHNbaV07XG4gICAgICAgICAgICBpZiAod2F5cG9pbnQub3B0aW9ucy5jb250aW51b3VzIHx8IGkgPT09IHdheXBvaW50cy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgIHdheXBvaW50LnRyaWdnZXIoW2RpcmVjdGlvbl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsZWFyVHJpZ2dlclF1ZXVlcygpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAod2F5cG9pbnQpIHtcbiAgICAgICAgdGhpcy53YXlwb2ludHMuc29ydChieVRyaWdnZXJQb2ludCk7XG4gICAgICAgIHZhciBpbmRleCA9IFdheXBvaW50LkFkYXB0ZXIuaW5BcnJheSh3YXlwb2ludCwgdGhpcy53YXlwb2ludHMpO1xuICAgICAgICB2YXIgaXNMYXN0ID0gaW5kZXggPT09IHRoaXMud2F5cG9pbnRzLmxlbmd0aCAtIDE7XG4gICAgICAgIHJldHVybiBpc0xhc3QgPyBudWxsIDogdGhpcy53YXlwb2ludHNbaW5kZXggKyAxXTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5wcmV2aW91cyA9IGZ1bmN0aW9uICh3YXlwb2ludCkge1xuICAgICAgICB0aGlzLndheXBvaW50cy5zb3J0KGJ5VHJpZ2dlclBvaW50KTtcbiAgICAgICAgdmFyIGluZGV4ID0gV2F5cG9pbnQuQWRhcHRlci5pbkFycmF5KHdheXBvaW50LCB0aGlzLndheXBvaW50cyk7XG4gICAgICAgIHJldHVybiBpbmRleCA/IHRoaXMud2F5cG9pbnRzW2luZGV4IC0gMV0gOiBudWxsO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLnF1ZXVlVHJpZ2dlciA9IGZ1bmN0aW9uICh3YXlwb2ludCwgZGlyZWN0aW9uKSB7XG4gICAgICAgIHRoaXMudHJpZ2dlclF1ZXVlc1tkaXJlY3Rpb25dLnB1c2god2F5cG9pbnQpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICh3YXlwb2ludCkge1xuICAgICAgICB2YXIgaW5kZXggPSBXYXlwb2ludC5BZGFwdGVyLmluQXJyYXkod2F5cG9pbnQsIHRoaXMud2F5cG9pbnRzKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICB0aGlzLndheXBvaW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9maXJzdCAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy53YXlwb2ludHNbMF07XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9sYXN0ICovXG4gICAgICBHcm91cC5wcm90b3R5cGUubGFzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud2F5cG9pbnRzW3RoaXMud2F5cG9pbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAuZmluZE9yQ3JlYXRlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIGdyb3Vwc1tvcHRpb25zLmF4aXNdW29wdGlvbnMubmFtZV0gfHwgbmV3IEdyb3VwKG9wdGlvbnMpO1xuICAgICAgfTtcblxuICAgICAgV2F5cG9pbnQuR3JvdXAgPSBHcm91cDtcbiAgICB9KSgpOyhmdW5jdGlvbiAoKSB7XG4gICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgIHZhciBXYXlwb2ludCA9IHdpbmRvdy5XYXlwb2ludDtcblxuICAgICAgZnVuY3Rpb24gaXNXaW5kb3coZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZWxlbWVudCA9PT0gZWxlbWVudC53aW5kb3c7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGdldFdpbmRvdyhlbGVtZW50KSB7XG4gICAgICAgIGlmIChpc1dpbmRvdyhlbGVtZW50KSkge1xuICAgICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50LmRlZmF1bHRWaWV3O1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBOb0ZyYW1ld29ya0FkYXB0ZXIoZWxlbWVudCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLmhhbmRsZXJzID0ge307XG4gICAgICB9XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuaW5uZXJIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpc1dpbiA9IGlzV2luZG93KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHJldHVybiBpc1dpbiA/IHRoaXMuZWxlbWVudC5pbm5lckhlaWdodCA6IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLmlubmVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpc1dpbiA9IGlzV2luZG93KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHJldHVybiBpc1dpbiA/IHRoaXMuZWxlbWVudC5pbm5lcldpZHRoIDogdGhpcy5lbGVtZW50LmNsaWVudFdpZHRoO1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoZXZlbnQsIGhhbmRsZXIpIHtcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIGxpc3RlbmVycywgaGFuZGxlcikge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSBsaXN0ZW5lcnMubGVuZ3RoIC0gMTsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV07XG4gICAgICAgICAgICBpZiAoIWhhbmRsZXIgfHwgaGFuZGxlciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZXZlbnRQYXJ0cyA9IGV2ZW50LnNwbGl0KCcuJyk7XG4gICAgICAgIHZhciBldmVudFR5cGUgPSBldmVudFBhcnRzWzBdO1xuICAgICAgICB2YXIgbmFtZXNwYWNlID0gZXZlbnRQYXJ0c1sxXTtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG5cbiAgICAgICAgaWYgKG5hbWVzcGFjZSAmJiB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0gJiYgZXZlbnRUeXBlKSB7XG4gICAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXVtldmVudFR5cGVdLCBoYW5kbGVyKTtcbiAgICAgICAgICB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV1bZXZlbnRUeXBlXSA9IFtdO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50VHlwZSkge1xuICAgICAgICAgIGZvciAodmFyIG5zIGluIHRoaXMuaGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCB0aGlzLmhhbmRsZXJzW25zXVtldmVudFR5cGVdIHx8IFtdLCBoYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlcnNbbnNdW2V2ZW50VHlwZV0gPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZXNwYWNlICYmIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSkge1xuICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdKSB7XG4gICAgICAgICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW3R5cGVdLCBoYW5kbGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdID0ge307XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8qIEFkYXB0ZWQgZnJvbSBqUXVlcnkgMS54IG9mZnNldCgpICovXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm9mZnNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGRvY3VtZW50RWxlbWVudCA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgdmFyIHdpbiA9IGdldFdpbmRvdyh0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudCk7XG4gICAgICAgIHZhciByZWN0ID0ge1xuICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICBsZWZ0OiAwXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHtcbiAgICAgICAgICByZWN0ID0gdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0b3A6IHJlY3QudG9wICsgd2luLnBhZ2VZT2Zmc2V0IC0gZG9jdW1lbnRFbGVtZW50LmNsaWVudFRvcCxcbiAgICAgICAgICBsZWZ0OiByZWN0LmxlZnQgKyB3aW4ucGFnZVhPZmZzZXQgLSBkb2N1bWVudEVsZW1lbnQuY2xpZW50TGVmdFxuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudCwgaGFuZGxlcikge1xuICAgICAgICB2YXIgZXZlbnRQYXJ0cyA9IGV2ZW50LnNwbGl0KCcuJyk7XG4gICAgICAgIHZhciBldmVudFR5cGUgPSBldmVudFBhcnRzWzBdO1xuICAgICAgICB2YXIgbmFtZXNwYWNlID0gZXZlbnRQYXJ0c1sxXSB8fCAnX19kZWZhdWx0JztcbiAgICAgICAgdmFyIG5zSGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0gPSB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0gfHwge307XG4gICAgICAgIHZhciBuc1R5cGVMaXN0ID0gbnNIYW5kbGVyc1tldmVudFR5cGVdID0gbnNIYW5kbGVyc1tldmVudFR5cGVdIHx8IFtdO1xuXG4gICAgICAgIG5zVHlwZUxpc3QucHVzaChoYW5kbGVyKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBoYW5kbGVyKTtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub3V0ZXJIZWlnaHQgPSBmdW5jdGlvbiAoaW5jbHVkZU1hcmdpbikge1xuICAgICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5pbm5lckhlaWdodCgpO1xuICAgICAgICB2YXIgY29tcHV0ZWRTdHlsZTtcblxuICAgICAgICBpZiAoaW5jbHVkZU1hcmdpbiAmJiAhaXNXaW5kb3codGhpcy5lbGVtZW50KSkge1xuICAgICAgICAgIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgIGhlaWdodCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpblRvcCwgMTApO1xuICAgICAgICAgIGhlaWdodCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpbkJvdHRvbSwgMTApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGhlaWdodDtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub3V0ZXJXaWR0aCA9IGZ1bmN0aW9uIChpbmNsdWRlTWFyZ2luKSB7XG4gICAgICAgIHZhciB3aWR0aCA9IHRoaXMuaW5uZXJXaWR0aCgpO1xuICAgICAgICB2YXIgY29tcHV0ZWRTdHlsZTtcblxuICAgICAgICBpZiAoaW5jbHVkZU1hcmdpbiAmJiAhaXNXaW5kb3codGhpcy5lbGVtZW50KSkge1xuICAgICAgICAgIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgIHdpZHRoICs9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUubWFyZ2luTGVmdCwgMTApO1xuICAgICAgICAgIHdpZHRoICs9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUubWFyZ2luUmlnaHQsIDEwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB3aWR0aDtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuc2Nyb2xsTGVmdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdpbiA9IGdldFdpbmRvdyh0aGlzLmVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gd2luID8gd2luLnBhZ2VYT2Zmc2V0IDogdGhpcy5lbGVtZW50LnNjcm9sbExlZnQ7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLnNjcm9sbFRvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdpbiA9IGdldFdpbmRvdyh0aGlzLmVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gd2luID8gd2luLnBhZ2VZT2Zmc2V0IDogdGhpcy5lbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5leHRlbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblxuICAgICAgICBmdW5jdGlvbiBtZXJnZSh0YXJnZXQsIG9iaikge1xuICAgICAgICAgIGlmICgodHlwZW9mIHRhcmdldCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHRhcmdldCkpID09PSAnb2JqZWN0JyAmJiAodHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKG9iaikpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRba2V5XSA9IG9ialtrZXldO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAxLCBlbmQgPSBhcmdzLmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgbWVyZ2UoYXJnc1swXSwgYXJnc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFyZ3NbMF07XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIuaW5BcnJheSA9IGZ1bmN0aW9uIChlbGVtZW50LCBhcnJheSwgaSkge1xuICAgICAgICByZXR1cm4gYXJyYXkgPT0gbnVsbCA/IC0xIDogYXJyYXkuaW5kZXhPZihlbGVtZW50LCBpKTtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5pc0VtcHR5T2JqZWN0ID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAvKiBlc2xpbnQgbm8tdW51c2VkLXZhcnM6IDAgKi9cbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBvYmopIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuXG4gICAgICBXYXlwb2ludC5hZGFwdGVycy5wdXNoKHtcbiAgICAgICAgbmFtZTogJ25vZnJhbWV3b3JrJyxcbiAgICAgICAgQWRhcHRlcjogTm9GcmFtZXdvcmtBZGFwdGVyXG4gICAgICB9KTtcbiAgICAgIFdheXBvaW50LkFkYXB0ZXIgPSBOb0ZyYW1ld29ya0FkYXB0ZXI7XG4gICAgfSkoKTtcbiAgfSwge31dIH0sIHt9LCBbMV0pOyIsIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0J1xuXG5yZXF1aXJlKCcuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHMnKTtcblxubGV0IGRvY1N0eWxlID0gZG9jdW1lbnQuYm9keS5zdHlsZTtcbmxldCBiZ1BhdGggPSBkb2N1bWVudC5sb2NhdGlvbiArICdpbWFnZXMvYmcvJztcbmxldCBpbWdFeHQgPSAnLnBuZyc7XG5sZXQgYmdzID0gWydXYWxsUGFwZXIyJywgJ1dhbGxQYXBlcjJfdG9uZScsICdXYWxsUGFwZXIyLjUnLCAnV2FsbFBhcGVyMycsICdXYWxsUGFwZXIzLjUnLCAnV2FsbFBhcGVyNCcsICdXYWxsUGFwZXI0LjUnLCAnV2FsbFBhcGVyNS41JywgJ1dhbGxQYXBlcjUuNV90b25lJywgJ1dhbGxQYXBlcjYnLCAnV2FsbFBhcGVyNi41JywgJ1dhbGxQYXBlcjcuNScsICdXYWxsUGFwZXI3LjVfdG9uZSddO1xudmFyIGJnSW1hZ2VzTG9hZGVkID0gZmFsc2U7XG5cbm5ldyBXYXlwb2ludCh7XG4gICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dheXBvaW50SGVhZGVyJyksXG4gICAgaGFuZGxlcjogZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdTY3JvbGxlZCB0byB3YXlwb2ludCAxJylcbiAgICB9XG59KVxuXG4vLyA7KGZ1bmN0aW9uKCkge1xuLy8gICAgIHZhciB0aHJvdHRsZSA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIG9iaikge1xuLy8gICAgICAgICBvYmogPSBvYmogfHwgd2luZG93O1xuLy8gICAgICAgICB2YXIgcnVubmluZyA9IGZhbHNlO1xuLy8gICAgICAgICB2YXIgZnVuYyA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHsgcmV0dXJuOyB9XG4vLyAgICAgICAgICAgICBydW5uaW5nID0gdHJ1ZTtcbi8vICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcbi8vICAgICAgICAgICAgICAgICBvYmouZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQobmFtZSkpO1xuLy8gICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICB9O1xuLy8gICAgICAgICBvYmouYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmdW5jKTtcbi8vICAgICB9O1xuLy9cbi8vICAgICAvKiBpbml0IC0geW91IGNhbiBpbml0IGFueSBldmVudCAqL1xuLy8gICAgIHRocm90dGxlKFwicmVzaXplXCIsIFwib3B0aW1pemVkUmVzaXplXCIpO1xuLy8gfSkoKTtcbi8vXG4vLyAvLyBoYW5kbGUgZXZlbnRcbi8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwib3B0aW1pemVkUmVzaXplXCIsIGZ1bmN0aW9uKCkge1xuLy8gICAgIGNvbnNvbGUubG9nKFwiUmVzb3VyY2UgY29uc2Npb3VzIHJlc2l6ZSBjYWxsYmFjayFcIik7XG4vLyB9KTtcblxuXG4vLyBVdGlsaXR5XG4vLyBzZXR1cCB3YXlwb2ludHNcbmxldCBkZWZpbmVXYXlwb2ludHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93LndheXBvaW50cyA9IFtdO1xuICAgIGxldCB3YXlwb2ludFVuaXQgPSBNYXRoLmZsb29yKChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3JhcHBlcicpLmNsaWVudEhlaWdodCAvIGJncy5sZW5ndGgpKTtcbiAgICBiZ3MuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCwgaW5kZXgpIHtcbiAgICAgICAgY29uc29sZS5sb2cod2F5cG9pbnRVbml0ICogKGluZGV4ICsgMSkpO1xuICAgICAgICB3aW5kb3cud2F5cG9pbnRzW2luZGV4XSA9IG5ldyBXYXlwb2ludCh7XG4gICAgICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2F5cG9pbnRIZWFkZXInKSxcbiAgICAgICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgbG9hZGluZyAke2Jnc1tpbmRleF19IGZyb20gbG9vcCBmdW5jdGlvbmApOyAvL3Rlc3RcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvZmZzZXQ6IHdheXBvaW50VW5pdCAqIChpbmRleCArIDEpICogLTFcbiAgICAgICAgfSlcbiAgICB9KVxufSgpO1xuLy8gcHJlbG9hZCBpbWFnZXNcbmlmIChiZ0ltYWdlc0xvYWRlZCAhPT0gdHJ1ZSkge1xuICAgIGJncy5mb3JFYWNoKGZ1bmN0aW9uIChiZykge1xuICAgICAgICBuZXcgSW1hZ2UoKS5zcmMgPSBiZ1BhdGggKyBiZyArIGltZ0V4dDtcbiAgICAgICAgLy8gY2FjaGVzIGltYWdlcywgYXZvaWRpbmcgd2hpdGUgZmxhc2ggYmV0d2VlbiBiYWNrZ3JvdW5kIHJlcGxhY2VtZW50c1xuICAgIH0pO1xuICAgIGJnSW1hZ2VzTG9hZGVkID0gdHJ1ZTtcbn1cbi8vIGxvYWQgYmcgaW1hZ2VcbmNvbnN0IGxvYWRCZyA9IGZ1bmN0aW9uIChiZykge1xuICAgIGRvY1N0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHtiZ1BhdGh9JHtiZ3NbYmddfSR7aW1nRXh0fSlgO1xuICAgIGNvbnNvbGUubG9nKGBsb2FkaW5nICR7YmdQYXRofSR7YmdzW2JnXX0ke2ltZ0V4dH1gKVxufVxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIGJ1c2luZXNzIHNlbGVjdCBidXR0b25zXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xubGV0IGJ1c2luZXNzU2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJ1c2luZXNzLXR5cGUtc2VsZWN0Jyk7XG5BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChidXNpbmVzc1NlbGVjdCkuZm9yRWFjaChmdW5jdGlvbihlbCl7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coZWwpO1xuICAgICAgICAvLyBnZXQgdGhlIGFjdGl2ZSBtZW51IGl0ZW0gYW5kIHR1cm4gaXQgb2ZmXG4gICAgICAgIGxldCBjdXJyZW50QWN0aXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1c2luZXNzLXR5cGUtc2VsZWN0LmFjdGl2ZScpO1xuICAgICAgICBpZiAoY3VycmVudEFjdGl2ZSkge1xuICAgICAgICAgICAgY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0dXJuIG9uIHRoZSBuZXcgbWVudSBpdGVtXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgICAgIC8vIHNob3cgdGhlIG5hdlxuICAgICAgICBsZXQgbWVudXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGNyLW1lbnUnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZW51cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWVudXNbaV0uc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgfVxuICAgICAgICBmb2xkTWVudS5hY2NvcmRpb24oMCwgJ2JvdHRvbScsIGZ1bmN0aW9uKGV2LCBvcmkpIHtcbiAgICAgICAgICAgIG9yaS5lbC5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldiwgb3JpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbi8vLy8vLy8vLy8vXG4vLyBoY3IgbWVudVxuLy8vLy8vLy8vLy9cbmxldCBmb2xkTWVudSA9IG5ldyBPcmlEb21pKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oY3ItbWVudScpLCB7XG4gICAgaFBhbmVsczogOSxcbiAgICByaXBwbGU6IDIsXG4gICAgc2hhZGluZzogJ2hhcmQnLFxuICAgIHRvdWNoRW5hYmxlZDogZmFsc2Vcbn0pO1xuLy8gbG9hZFxuZm9sZE1lbnUuZm9sZFVwKCdib3R0b20nKTtcblxuLy8gY2xpY2tcblxuXG5cbi8vIGxldCBmb2xkTWVudSA9IG5ldyBPcmlEb21pKGRvY3VtIGVudC5xdWVyeVNlbGVjdG9yKCcuaGNyLW1lbnUnKSwge1xuLy8gICAgIC8vdlBhbmVsczogICAgICAgICA1LCAgICAgLy8gbnVtYmVyIG9mIHBhbmVscyB3aGVuIGZvbGRpbmcgbGVmdCBvciByaWdodCAodmVydGljYWxseSBvcmllbnRlZClcbi8vICAgICBoUGFuZWxzOiAgICAgICAgIDQsICAgIC8vIG51bWJlciBvZiBwYW5lbHMgd2hlbiBmb2xkaW5nIHRvcCBvciBib3R0b21cbi8vICAgICB0b3VjaEVuYWJsZWQ6IGZhbHNlLFxuLy8gICAgIC8vIHNwZWVkOiAgICAgICAgICAgMTIwMCwgIC8vIGZvbGRpbmcgZHVyYXRpb24gaW4gbXNcbi8vICAgICByaXBwbGU6ICAgICAgICAgIDIsICAgICAvLyBiYWNrd2FyZHMgcmlwcGxlIGVmZmVjdCB3aGVuIGFuaW1hdGluZ1xuLy8gICAgIHNoYWRpbmdJbnRlc2l0eTogLjUsICAgIC8vIGxlc3NlbiB0aGUgc2hhZGluZyBlZmZlY3Rcbi8vICAgICAvLyBwZXJzcGVjdGl2ZTogICAgIDgwMCwgICAvLyBzbWFsbGVyIHZhbHVlcyBleGFnZ2VyYXRlIDNEIGRpc3RvcnRpb25cbi8vICAgICAvLyBtYXhBbmdsZTogICAgICAgIDQwLCAgICAvLyBrZWVwIHRoZSB1c2VyJ3MgZm9sZHMgd2l0aGluIGEgcmFuZ2Ugb2YgLTQwIHRvIDQwIGRlZ3JlZXNcbi8vICAgICAvLyBzaGFkaW5nOiAgICAgICAgICdzb2Z0JyAvLyBjaGFuZ2UgdGhlIHNoYWRpbmcgdHlwZVxuLy8gfSk7XG4vLyBmb2xkTWVudS5hY2NvcmRpb24oNjAsICd0b3AnKTtcbi8vIGZvbGRNZW51Lm9ubW91c2VvdmVyID0gKCkgPT4ge1xuLy8gICAgIHRoaXMudW5mb2xkKCk7XG4vLyB9XG59LHtcIi4uL25vZGVfbW9kdWxlcy93YXlwb2ludHMvbGliL25vZnJhbWV3b3JrLndheXBvaW50c1wiOjJ9XSwyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbi8qIVxuV2F5cG9pbnRzIC0gNC4wLjBcbkNvcHlyaWdodCDCqSAyMDExLTIwMTUgQ2FsZWIgVHJvdWdodG9uXG5MaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5odHRwczovL2dpdGh1Yi5jb20vaW1ha2V3ZWJ0aGluZ3Mvd2F5cG9pbnRzL2Jsb2cvbWFzdGVyL2xpY2Vuc2VzLnR4dFxuKi9cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnXG5cbiAgdmFyIGtleUNvdW50ZXIgPSAwXG4gIHZhciBhbGxXYXlwb2ludHMgPSB7fVxuXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS93YXlwb2ludCAqL1xuICBmdW5jdGlvbiBXYXlwb2ludChvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIG9wdGlvbnMgcGFzc2VkIHRvIFdheXBvaW50IGNvbnN0cnVjdG9yJylcbiAgICB9XG4gICAgaWYgKCFvcHRpb25zLmVsZW1lbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZWxlbWVudCBvcHRpb24gcGFzc2VkIHRvIFdheXBvaW50IGNvbnN0cnVjdG9yJylcbiAgICB9XG4gICAgaWYgKCFvcHRpb25zLmhhbmRsZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gaGFuZGxlciBvcHRpb24gcGFzc2VkIHRvIFdheXBvaW50IGNvbnN0cnVjdG9yJylcbiAgICB9XG5cbiAgICB0aGlzLmtleSA9ICd3YXlwb2ludC0nICsga2V5Q291bnRlclxuICAgIHRoaXMub3B0aW9ucyA9IFdheXBvaW50LkFkYXB0ZXIuZXh0ZW5kKHt9LCBXYXlwb2ludC5kZWZhdWx0cywgb3B0aW9ucylcbiAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLm9wdGlvbnMuZWxlbWVudFxuICAgIHRoaXMuYWRhcHRlciA9IG5ldyBXYXlwb2ludC5BZGFwdGVyKHRoaXMuZWxlbWVudClcbiAgICB0aGlzLmNhbGxiYWNrID0gb3B0aW9ucy5oYW5kbGVyXG4gICAgdGhpcy5heGlzID0gdGhpcy5vcHRpb25zLmhvcml6b250YWwgPyAnaG9yaXpvbnRhbCcgOiAndmVydGljYWwnXG4gICAgdGhpcy5lbmFibGVkID0gdGhpcy5vcHRpb25zLmVuYWJsZWRcbiAgICB0aGlzLnRyaWdnZXJQb2ludCA9IG51bGxcbiAgICB0aGlzLmdyb3VwID0gV2F5cG9pbnQuR3JvdXAuZmluZE9yQ3JlYXRlKHtcbiAgICAgIG5hbWU6IHRoaXMub3B0aW9ucy5ncm91cCxcbiAgICAgIGF4aXM6IHRoaXMuYXhpc1xuICAgIH0pXG4gICAgdGhpcy5jb250ZXh0ID0gV2F5cG9pbnQuQ29udGV4dC5maW5kT3JDcmVhdGVCeUVsZW1lbnQodGhpcy5vcHRpb25zLmNvbnRleHQpXG5cbiAgICBpZiAoV2F5cG9pbnQub2Zmc2V0QWxpYXNlc1t0aGlzLm9wdGlvbnMub2Zmc2V0XSkge1xuICAgICAgdGhpcy5vcHRpb25zLm9mZnNldCA9IFdheXBvaW50Lm9mZnNldEFsaWFzZXNbdGhpcy5vcHRpb25zLm9mZnNldF1cbiAgICB9XG4gICAgdGhpcy5ncm91cC5hZGQodGhpcylcbiAgICB0aGlzLmNvbnRleHQuYWRkKHRoaXMpXG4gICAgYWxsV2F5cG9pbnRzW3RoaXMua2V5XSA9IHRoaXNcbiAgICBrZXlDb3VudGVyICs9IDFcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLnF1ZXVlVHJpZ2dlciA9IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xuICAgIHRoaXMuZ3JvdXAucXVldWVUcmlnZ2VyKHRoaXMsIGRpcmVjdGlvbilcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAodGhpcy5jYWxsYmFjaykge1xuICAgICAgdGhpcy5jYWxsYmFjay5hcHBseSh0aGlzLCBhcmdzKVxuICAgIH1cbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZGVzdHJveSAqL1xuICBXYXlwb2ludC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuY29udGV4dC5yZW1vdmUodGhpcylcbiAgICB0aGlzLmdyb3VwLnJlbW92ZSh0aGlzKVxuICAgIGRlbGV0ZSBhbGxXYXlwb2ludHNbdGhpcy5rZXldXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rpc2FibGUgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2VuYWJsZSAqL1xuICBXYXlwb2ludC5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jb250ZXh0LnJlZnJlc2goKVxuICAgIHRoaXMuZW5hYmxlZCA9IHRydWVcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9uZXh0ICovXG4gIFdheXBvaW50LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ3JvdXAubmV4dCh0aGlzKVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9wcmV2aW91cyAqL1xuICBXYXlwb2ludC5wcm90b3R5cGUucHJldmlvdXMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5ncm91cC5wcmV2aW91cyh0aGlzKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBXYXlwb2ludC5pbnZva2VBbGwgPSBmdW5jdGlvbihtZXRob2QpIHtcbiAgICB2YXIgYWxsV2F5cG9pbnRzQXJyYXkgPSBbXVxuICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIGFsbFdheXBvaW50cykge1xuICAgICAgYWxsV2F5cG9pbnRzQXJyYXkucHVzaChhbGxXYXlwb2ludHNbd2F5cG9pbnRLZXldKVxuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gYWxsV2F5cG9pbnRzQXJyYXkubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIGFsbFdheXBvaW50c0FycmF5W2ldW21ldGhvZF0oKVxuICAgIH1cbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZGVzdHJveS1hbGwgKi9cbiAgV2F5cG9pbnQuZGVzdHJveUFsbCA9IGZ1bmN0aW9uKCkge1xuICAgIFdheXBvaW50Lmludm9rZUFsbCgnZGVzdHJveScpXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rpc2FibGUtYWxsICovXG4gIFdheXBvaW50LmRpc2FibGVBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2Rpc2FibGUnKVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9lbmFibGUtYWxsICovXG4gIFdheXBvaW50LmVuYWJsZUFsbCA9IGZ1bmN0aW9uKCkge1xuICAgIFdheXBvaW50Lmludm9rZUFsbCgnZW5hYmxlJylcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvcmVmcmVzaC1hbGwgKi9cbiAgV2F5cG9pbnQucmVmcmVzaEFsbCA9IGZ1bmN0aW9uKCkge1xuICAgIFdheXBvaW50LkNvbnRleHQucmVmcmVzaEFsbCgpXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3ZpZXdwb3J0LWhlaWdodCAqL1xuICBXYXlwb2ludC52aWV3cG9ydEhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodFxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS92aWV3cG9ydC13aWR0aCAqL1xuICBXYXlwb2ludC52aWV3cG9ydFdpZHRoID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aFxuICB9XG5cbiAgV2F5cG9pbnQuYWRhcHRlcnMgPSBbXVxuXG4gIFdheXBvaW50LmRlZmF1bHRzID0ge1xuICAgIGNvbnRleHQ6IHdpbmRvdyxcbiAgICBjb250aW51b3VzOiB0cnVlLFxuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgZ3JvdXA6ICdkZWZhdWx0JyxcbiAgICBob3Jpem9udGFsOiBmYWxzZSxcbiAgICBvZmZzZXQ6IDBcbiAgfVxuXG4gIFdheXBvaW50Lm9mZnNldEFsaWFzZXMgPSB7XG4gICAgJ2JvdHRvbS1pbi12aWV3JzogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmlubmVySGVpZ2h0KCkgLSB0aGlzLmFkYXB0ZXIub3V0ZXJIZWlnaHQoKVxuICAgIH0sXG4gICAgJ3JpZ2h0LWluLXZpZXcnOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaW5uZXJXaWR0aCgpIC0gdGhpcy5hZGFwdGVyLm91dGVyV2lkdGgoKVxuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy5XYXlwb2ludCA9IFdheXBvaW50XG59KCkpXG47KGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCdcblxuICBmdW5jdGlvbiByZXF1ZXN0QW5pbWF0aW9uRnJhbWVTaGltKGNhbGxiYWNrKSB7XG4gICAgd2luZG93LnNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyA2MClcbiAgfVxuXG4gIHZhciBrZXlDb3VudGVyID0gMFxuICB2YXIgY29udGV4dHMgPSB7fVxuICB2YXIgV2F5cG9pbnQgPSB3aW5kb3cuV2F5cG9pbnRcbiAgdmFyIG9sZFdpbmRvd0xvYWQgPSB3aW5kb3cub25sb2FkXG5cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQgKi9cbiAgZnVuY3Rpb24gQ29udGV4dChlbGVtZW50KSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudFxuICAgIHRoaXMuQWRhcHRlciA9IFdheXBvaW50LkFkYXB0ZXJcbiAgICB0aGlzLmFkYXB0ZXIgPSBuZXcgdGhpcy5BZGFwdGVyKGVsZW1lbnQpXG4gICAgdGhpcy5rZXkgPSAnd2F5cG9pbnQtY29udGV4dC0nICsga2V5Q291bnRlclxuICAgIHRoaXMuZGlkU2Nyb2xsID0gZmFsc2VcbiAgICB0aGlzLmRpZFJlc2l6ZSA9IGZhbHNlXG4gICAgdGhpcy5vbGRTY3JvbGwgPSB7XG4gICAgICB4OiB0aGlzLmFkYXB0ZXIuc2Nyb2xsTGVmdCgpLFxuICAgICAgeTogdGhpcy5hZGFwdGVyLnNjcm9sbFRvcCgpXG4gICAgfVxuICAgIHRoaXMud2F5cG9pbnRzID0ge1xuICAgICAgdmVydGljYWw6IHt9LFxuICAgICAgaG9yaXpvbnRhbDoge31cbiAgICB9XG5cbiAgICBlbGVtZW50LndheXBvaW50Q29udGV4dEtleSA9IHRoaXMua2V5XG4gICAgY29udGV4dHNbZWxlbWVudC53YXlwb2ludENvbnRleHRLZXldID0gdGhpc1xuICAgIGtleUNvdW50ZXIgKz0gMVxuXG4gICAgdGhpcy5jcmVhdGVUaHJvdHRsZWRTY3JvbGxIYW5kbGVyKClcbiAgICB0aGlzLmNyZWF0ZVRocm90dGxlZFJlc2l6ZUhhbmRsZXIoKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbih3YXlwb2ludCkge1xuICAgIHZhciBheGlzID0gd2F5cG9pbnQub3B0aW9ucy5ob3Jpem9udGFsID8gJ2hvcml6b250YWwnIDogJ3ZlcnRpY2FsJ1xuICAgIHRoaXMud2F5cG9pbnRzW2F4aXNdW3dheXBvaW50LmtleV0gPSB3YXlwb2ludFxuICAgIHRoaXMucmVmcmVzaCgpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLmNoZWNrRW1wdHkgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaG9yaXpvbnRhbEVtcHR5ID0gdGhpcy5BZGFwdGVyLmlzRW1wdHlPYmplY3QodGhpcy53YXlwb2ludHMuaG9yaXpvbnRhbClcbiAgICB2YXIgdmVydGljYWxFbXB0eSA9IHRoaXMuQWRhcHRlci5pc0VtcHR5T2JqZWN0KHRoaXMud2F5cG9pbnRzLnZlcnRpY2FsKVxuICAgIGlmIChob3Jpem9udGFsRW1wdHkgJiYgdmVydGljYWxFbXB0eSkge1xuICAgICAgdGhpcy5hZGFwdGVyLm9mZignLndheXBvaW50cycpXG4gICAgICBkZWxldGUgY29udGV4dHNbdGhpcy5rZXldXG4gICAgfVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5jcmVhdGVUaHJvdHRsZWRSZXNpemVIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzXG5cbiAgICBmdW5jdGlvbiByZXNpemVIYW5kbGVyKCkge1xuICAgICAgc2VsZi5oYW5kbGVSZXNpemUoKVxuICAgICAgc2VsZi5kaWRSZXNpemUgPSBmYWxzZVxuICAgIH1cblxuICAgIHRoaXMuYWRhcHRlci5vbigncmVzaXplLndheXBvaW50cycsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFzZWxmLmRpZFJlc2l6ZSkge1xuICAgICAgICBzZWxmLmRpZFJlc2l6ZSA9IHRydWVcbiAgICAgICAgV2F5cG9pbnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlc2l6ZUhhbmRsZXIpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlVGhyb3R0bGVkU2Nyb2xsSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpc1xuICAgIGZ1bmN0aW9uIHNjcm9sbEhhbmRsZXIoKSB7XG4gICAgICBzZWxmLmhhbmRsZVNjcm9sbCgpXG4gICAgICBzZWxmLmRpZFNjcm9sbCA9IGZhbHNlXG4gICAgfVxuXG4gICAgdGhpcy5hZGFwdGVyLm9uKCdzY3JvbGwud2F5cG9pbnRzJywgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXNlbGYuZGlkU2Nyb2xsIHx8IFdheXBvaW50LmlzVG91Y2gpIHtcbiAgICAgICAgc2VsZi5kaWRTY3JvbGwgPSB0cnVlXG4gICAgICAgIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZShzY3JvbGxIYW5kbGVyKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLmhhbmRsZVJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgIFdheXBvaW50LkNvbnRleHQucmVmcmVzaEFsbCgpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLmhhbmRsZVNjcm9sbCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0cmlnZ2VyZWRHcm91cHMgPSB7fVxuICAgIHZhciBheGVzID0ge1xuICAgICAgaG9yaXpvbnRhbDoge1xuICAgICAgICBuZXdTY3JvbGw6IHRoaXMuYWRhcHRlci5zY3JvbGxMZWZ0KCksXG4gICAgICAgIG9sZFNjcm9sbDogdGhpcy5vbGRTY3JvbGwueCxcbiAgICAgICAgZm9yd2FyZDogJ3JpZ2h0JyxcbiAgICAgICAgYmFja3dhcmQ6ICdsZWZ0J1xuICAgICAgfSxcbiAgICAgIHZlcnRpY2FsOiB7XG4gICAgICAgIG5ld1Njcm9sbDogdGhpcy5hZGFwdGVyLnNjcm9sbFRvcCgpLFxuICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLnksXG4gICAgICAgIGZvcndhcmQ6ICdkb3duJyxcbiAgICAgICAgYmFja3dhcmQ6ICd1cCdcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKHZhciBheGlzS2V5IGluIGF4ZXMpIHtcbiAgICAgIHZhciBheGlzID0gYXhlc1theGlzS2V5XVxuICAgICAgdmFyIGlzRm9yd2FyZCA9IGF4aXMubmV3U2Nyb2xsID4gYXhpcy5vbGRTY3JvbGxcbiAgICAgIHZhciBkaXJlY3Rpb24gPSBpc0ZvcndhcmQgPyBheGlzLmZvcndhcmQgOiBheGlzLmJhY2t3YXJkXG5cbiAgICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIHRoaXMud2F5cG9pbnRzW2F4aXNLZXldKSB7XG4gICAgICAgIHZhciB3YXlwb2ludCA9IHRoaXMud2F5cG9pbnRzW2F4aXNLZXldW3dheXBvaW50S2V5XVxuICAgICAgICB2YXIgd2FzQmVmb3JlVHJpZ2dlclBvaW50ID0gYXhpcy5vbGRTY3JvbGwgPCB3YXlwb2ludC50cmlnZ2VyUG9pbnRcbiAgICAgICAgdmFyIG5vd0FmdGVyVHJpZ2dlclBvaW50ID0gYXhpcy5uZXdTY3JvbGwgPj0gd2F5cG9pbnQudHJpZ2dlclBvaW50XG4gICAgICAgIHZhciBjcm9zc2VkRm9yd2FyZCA9IHdhc0JlZm9yZVRyaWdnZXJQb2ludCAmJiBub3dBZnRlclRyaWdnZXJQb2ludFxuICAgICAgICB2YXIgY3Jvc3NlZEJhY2t3YXJkID0gIXdhc0JlZm9yZVRyaWdnZXJQb2ludCAmJiAhbm93QWZ0ZXJUcmlnZ2VyUG9pbnRcbiAgICAgICAgaWYgKGNyb3NzZWRGb3J3YXJkIHx8IGNyb3NzZWRCYWNrd2FyZCkge1xuICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihkaXJlY3Rpb24pXG4gICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKHZhciBncm91cEtleSBpbiB0cmlnZ2VyZWRHcm91cHMpIHtcbiAgICAgIHRyaWdnZXJlZEdyb3Vwc1tncm91cEtleV0uZmx1c2hUcmlnZ2VycygpXG4gICAgfVxuXG4gICAgdGhpcy5vbGRTY3JvbGwgPSB7XG4gICAgICB4OiBheGVzLmhvcml6b250YWwubmV3U2Nyb2xsLFxuICAgICAgeTogYXhlcy52ZXJ0aWNhbC5uZXdTY3JvbGxcbiAgICB9XG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLmlubmVySGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgLyplc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi9cbiAgICBpZiAodGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgIHJldHVybiBXYXlwb2ludC52aWV3cG9ydEhlaWdodCgpXG4gICAgfVxuICAgIC8qZXNsaW50LWVuYWJsZSBlcWVxZXEgKi9cbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmlubmVySGVpZ2h0KClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24od2F5cG9pbnQpIHtcbiAgICBkZWxldGUgdGhpcy53YXlwb2ludHNbd2F5cG9pbnQuYXhpc11bd2F5cG9pbnQua2V5XVxuICAgIHRoaXMuY2hlY2tFbXB0eSgpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLmlubmVyV2lkdGggPSBmdW5jdGlvbigpIHtcbiAgICAvKmVzbGludC1kaXNhYmxlIGVxZXFlcSAqL1xuICAgIGlmICh0aGlzLmVsZW1lbnQgPT0gdGhpcy5lbGVtZW50LndpbmRvdykge1xuICAgICAgcmV0dXJuIFdheXBvaW50LnZpZXdwb3J0V2lkdGgoKVxuICAgIH1cbiAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5pbm5lcldpZHRoKClcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvY29udGV4dC1kZXN0cm95ICovXG4gIENvbnRleHQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYWxsV2F5cG9pbnRzID0gW11cbiAgICBmb3IgKHZhciBheGlzIGluIHRoaXMud2F5cG9pbnRzKSB7XG4gICAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiB0aGlzLndheXBvaW50c1theGlzXSkge1xuICAgICAgICBhbGxXYXlwb2ludHMucHVzaCh0aGlzLndheXBvaW50c1theGlzXVt3YXlwb2ludEtleV0pXG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSBhbGxXYXlwb2ludHMubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIGFsbFdheXBvaW50c1tpXS5kZXN0cm95KClcbiAgICB9XG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQtcmVmcmVzaCAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24oKSB7XG4gICAgLyplc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi9cbiAgICB2YXIgaXNXaW5kb3cgPSB0aGlzLmVsZW1lbnQgPT0gdGhpcy5lbGVtZW50LndpbmRvd1xuICAgIC8qZXNsaW50LWVuYWJsZSBlcWVxZXEgKi9cbiAgICB2YXIgY29udGV4dE9mZnNldCA9IGlzV2luZG93ID8gdW5kZWZpbmVkIDogdGhpcy5hZGFwdGVyLm9mZnNldCgpXG4gICAgdmFyIHRyaWdnZXJlZEdyb3VwcyA9IHt9XG4gICAgdmFyIGF4ZXNcblxuICAgIHRoaXMuaGFuZGxlU2Nyb2xsKClcbiAgICBheGVzID0ge1xuICAgICAgaG9yaXpvbnRhbDoge1xuICAgICAgICBjb250ZXh0T2Zmc2V0OiBpc1dpbmRvdyA/IDAgOiBjb250ZXh0T2Zmc2V0LmxlZnQsXG4gICAgICAgIGNvbnRleHRTY3JvbGw6IGlzV2luZG93ID8gMCA6IHRoaXMub2xkU2Nyb2xsLngsXG4gICAgICAgIGNvbnRleHREaW1lbnNpb246IHRoaXMuaW5uZXJXaWR0aCgpLFxuICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLngsXG4gICAgICAgIGZvcndhcmQ6ICdyaWdodCcsXG4gICAgICAgIGJhY2t3YXJkOiAnbGVmdCcsXG4gICAgICAgIG9mZnNldFByb3A6ICdsZWZ0J1xuICAgICAgfSxcbiAgICAgIHZlcnRpY2FsOiB7XG4gICAgICAgIGNvbnRleHRPZmZzZXQ6IGlzV2luZG93ID8gMCA6IGNvbnRleHRPZmZzZXQudG9wLFxuICAgICAgICBjb250ZXh0U2Nyb2xsOiBpc1dpbmRvdyA/IDAgOiB0aGlzLm9sZFNjcm9sbC55LFxuICAgICAgICBjb250ZXh0RGltZW5zaW9uOiB0aGlzLmlubmVySGVpZ2h0KCksXG4gICAgICAgIG9sZFNjcm9sbDogdGhpcy5vbGRTY3JvbGwueSxcbiAgICAgICAgZm9yd2FyZDogJ2Rvd24nLFxuICAgICAgICBiYWNrd2FyZDogJ3VwJyxcbiAgICAgICAgb2Zmc2V0UHJvcDogJ3RvcCdcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKHZhciBheGlzS2V5IGluIGF4ZXMpIHtcbiAgICAgIHZhciBheGlzID0gYXhlc1theGlzS2V5XVxuICAgICAgZm9yICh2YXIgd2F5cG9pbnRLZXkgaW4gdGhpcy53YXlwb2ludHNbYXhpc0tleV0pIHtcbiAgICAgICAgdmFyIHdheXBvaW50ID0gdGhpcy53YXlwb2ludHNbYXhpc0tleV1bd2F5cG9pbnRLZXldXG4gICAgICAgIHZhciBhZGp1c3RtZW50ID0gd2F5cG9pbnQub3B0aW9ucy5vZmZzZXRcbiAgICAgICAgdmFyIG9sZFRyaWdnZXJQb2ludCA9IHdheXBvaW50LnRyaWdnZXJQb2ludFxuICAgICAgICB2YXIgZWxlbWVudE9mZnNldCA9IDBcbiAgICAgICAgdmFyIGZyZXNoV2F5cG9pbnQgPSBvbGRUcmlnZ2VyUG9pbnQgPT0gbnVsbFxuICAgICAgICB2YXIgY29udGV4dE1vZGlmaWVyLCB3YXNCZWZvcmVTY3JvbGwsIG5vd0FmdGVyU2Nyb2xsXG4gICAgICAgIHZhciB0cmlnZ2VyZWRCYWNrd2FyZCwgdHJpZ2dlcmVkRm9yd2FyZFxuXG4gICAgICAgIGlmICh3YXlwb2ludC5lbGVtZW50ICE9PSB3YXlwb2ludC5lbGVtZW50LndpbmRvdykge1xuICAgICAgICAgIGVsZW1lbnRPZmZzZXQgPSB3YXlwb2ludC5hZGFwdGVyLm9mZnNldCgpW2F4aXMub2Zmc2V0UHJvcF1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgYWRqdXN0bWVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGFkanVzdG1lbnQgPSBhZGp1c3RtZW50LmFwcGx5KHdheXBvaW50KVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhZGp1c3RtZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIGFkanVzdG1lbnQgPSBwYXJzZUZsb2F0KGFkanVzdG1lbnQpXG4gICAgICAgICAgaWYgKHdheXBvaW50Lm9wdGlvbnMub2Zmc2V0LmluZGV4T2YoJyUnKSA+IC0gMSkge1xuICAgICAgICAgICAgYWRqdXN0bWVudCA9IE1hdGguY2VpbChheGlzLmNvbnRleHREaW1lbnNpb24gKiBhZGp1c3RtZW50IC8gMTAwKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRleHRNb2RpZmllciA9IGF4aXMuY29udGV4dFNjcm9sbCAtIGF4aXMuY29udGV4dE9mZnNldFxuICAgICAgICB3YXlwb2ludC50cmlnZ2VyUG9pbnQgPSBlbGVtZW50T2Zmc2V0ICsgY29udGV4dE1vZGlmaWVyIC0gYWRqdXN0bWVudFxuICAgICAgICB3YXNCZWZvcmVTY3JvbGwgPSBvbGRUcmlnZ2VyUG9pbnQgPCBheGlzLm9sZFNjcm9sbFxuICAgICAgICBub3dBZnRlclNjcm9sbCA9IHdheXBvaW50LnRyaWdnZXJQb2ludCA+PSBheGlzLm9sZFNjcm9sbFxuICAgICAgICB0cmlnZ2VyZWRCYWNrd2FyZCA9IHdhc0JlZm9yZVNjcm9sbCAmJiBub3dBZnRlclNjcm9sbFxuICAgICAgICB0cmlnZ2VyZWRGb3J3YXJkID0gIXdhc0JlZm9yZVNjcm9sbCAmJiAhbm93QWZ0ZXJTY3JvbGxcblxuICAgICAgICBpZiAoIWZyZXNoV2F5cG9pbnQgJiYgdHJpZ2dlcmVkQmFja3dhcmQpIHtcbiAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoYXhpcy5iYWNrd2FyZClcbiAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbd2F5cG9pbnQuZ3JvdXAuaWRdID0gd2F5cG9pbnQuZ3JvdXBcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghZnJlc2hXYXlwb2ludCAmJiB0cmlnZ2VyZWRGb3J3YXJkKSB7XG4gICAgICAgICAgd2F5cG9pbnQucXVldWVUcmlnZ2VyKGF4aXMuZm9yd2FyZClcbiAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbd2F5cG9pbnQuZ3JvdXAuaWRdID0gd2F5cG9pbnQuZ3JvdXBcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChmcmVzaFdheXBvaW50ICYmIGF4aXMub2xkU2Nyb2xsID49IHdheXBvaW50LnRyaWdnZXJQb2ludCkge1xuICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihheGlzLmZvcndhcmQpXG4gICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKHZhciBncm91cEtleSBpbiB0cmlnZ2VyZWRHcm91cHMpIHtcbiAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW2dyb3VwS2V5XS5mbHVzaFRyaWdnZXJzKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5maW5kT3JDcmVhdGVCeUVsZW1lbnQgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIENvbnRleHQuZmluZEJ5RWxlbWVudChlbGVtZW50KSB8fCBuZXcgQ29udGV4dChlbGVtZW50KVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnJlZnJlc2hBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBmb3IgKHZhciBjb250ZXh0SWQgaW4gY29udGV4dHMpIHtcbiAgICAgIGNvbnRleHRzW2NvbnRleHRJZF0ucmVmcmVzaCgpXG4gICAgfVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0LWZpbmQtYnktZWxlbWVudCAqL1xuICBDb250ZXh0LmZpbmRCeUVsZW1lbnQgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIGNvbnRleHRzW2VsZW1lbnQud2F5cG9pbnRDb250ZXh0S2V5XVxuICB9XG5cbiAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChvbGRXaW5kb3dMb2FkKSB7XG4gICAgICBvbGRXaW5kb3dMb2FkKClcbiAgICB9XG4gICAgQ29udGV4dC5yZWZyZXNoQWxsKClcbiAgfVxuXG4gIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgdmFyIHJlcXVlc3RGbiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZVNoaW1cbiAgICByZXF1ZXN0Rm4uY2FsbCh3aW5kb3csIGNhbGxiYWNrKVxuICB9XG4gIFdheXBvaW50LkNvbnRleHQgPSBDb250ZXh0XG59KCkpXG47KGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCdcblxuICBmdW5jdGlvbiBieVRyaWdnZXJQb2ludChhLCBiKSB7XG4gICAgcmV0dXJuIGEudHJpZ2dlclBvaW50IC0gYi50cmlnZ2VyUG9pbnRcbiAgfVxuXG4gIGZ1bmN0aW9uIGJ5UmV2ZXJzZVRyaWdnZXJQb2ludChhLCBiKSB7XG4gICAgcmV0dXJuIGIudHJpZ2dlclBvaW50IC0gYS50cmlnZ2VyUG9pbnRcbiAgfVxuXG4gIHZhciBncm91cHMgPSB7XG4gICAgdmVydGljYWw6IHt9LFxuICAgIGhvcml6b250YWw6IHt9XG4gIH1cbiAgdmFyIFdheXBvaW50ID0gd2luZG93LldheXBvaW50XG5cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2dyb3VwICovXG4gIGZ1bmN0aW9uIEdyb3VwKG9wdGlvbnMpIHtcbiAgICB0aGlzLm5hbWUgPSBvcHRpb25zLm5hbWVcbiAgICB0aGlzLmF4aXMgPSBvcHRpb25zLmF4aXNcbiAgICB0aGlzLmlkID0gdGhpcy5uYW1lICsgJy0nICsgdGhpcy5heGlzXG4gICAgdGhpcy53YXlwb2ludHMgPSBbXVxuICAgIHRoaXMuY2xlYXJUcmlnZ2VyUXVldWVzKClcbiAgICBncm91cHNbdGhpcy5heGlzXVt0aGlzLm5hbWVdID0gdGhpc1xuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24od2F5cG9pbnQpIHtcbiAgICB0aGlzLndheXBvaW50cy5wdXNoKHdheXBvaW50KVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUuY2xlYXJUcmlnZ2VyUXVldWVzID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy50cmlnZ2VyUXVldWVzID0ge1xuICAgICAgdXA6IFtdLFxuICAgICAgZG93bjogW10sXG4gICAgICBsZWZ0OiBbXSxcbiAgICAgIHJpZ2h0OiBbXVxuICAgIH1cbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgR3JvdXAucHJvdG90eXBlLmZsdXNoVHJpZ2dlcnMgPSBmdW5jdGlvbigpIHtcbiAgICBmb3IgKHZhciBkaXJlY3Rpb24gaW4gdGhpcy50cmlnZ2VyUXVldWVzKSB7XG4gICAgICB2YXIgd2F5cG9pbnRzID0gdGhpcy50cmlnZ2VyUXVldWVzW2RpcmVjdGlvbl1cbiAgICAgIHZhciByZXZlcnNlID0gZGlyZWN0aW9uID09PSAndXAnIHx8IGRpcmVjdGlvbiA9PT0gJ2xlZnQnXG4gICAgICB3YXlwb2ludHMuc29ydChyZXZlcnNlID8gYnlSZXZlcnNlVHJpZ2dlclBvaW50IDogYnlUcmlnZ2VyUG9pbnQpXG4gICAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gd2F5cG9pbnRzLmxlbmd0aDsgaSA8IGVuZDsgaSArPSAxKSB7XG4gICAgICAgIHZhciB3YXlwb2ludCA9IHdheXBvaW50c1tpXVxuICAgICAgICBpZiAod2F5cG9pbnQub3B0aW9ucy5jb250aW51b3VzIHx8IGkgPT09IHdheXBvaW50cy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgd2F5cG9pbnQudHJpZ2dlcihbZGlyZWN0aW9uXSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmNsZWFyVHJpZ2dlclF1ZXVlcygpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24od2F5cG9pbnQpIHtcbiAgICB0aGlzLndheXBvaW50cy5zb3J0KGJ5VHJpZ2dlclBvaW50KVxuICAgIHZhciBpbmRleCA9IFdheXBvaW50LkFkYXB0ZXIuaW5BcnJheSh3YXlwb2ludCwgdGhpcy53YXlwb2ludHMpXG4gICAgdmFyIGlzTGFzdCA9IGluZGV4ID09PSB0aGlzLndheXBvaW50cy5sZW5ndGggLSAxXG4gICAgcmV0dXJuIGlzTGFzdCA/IG51bGwgOiB0aGlzLndheXBvaW50c1tpbmRleCArIDFdXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLnByb3RvdHlwZS5wcmV2aW91cyA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgdGhpcy53YXlwb2ludHMuc29ydChieVRyaWdnZXJQb2ludClcbiAgICB2YXIgaW5kZXggPSBXYXlwb2ludC5BZGFwdGVyLmluQXJyYXkod2F5cG9pbnQsIHRoaXMud2F5cG9pbnRzKVxuICAgIHJldHVybiBpbmRleCA/IHRoaXMud2F5cG9pbnRzW2luZGV4IC0gMV0gOiBudWxsXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLnByb3RvdHlwZS5xdWV1ZVRyaWdnZXIgPSBmdW5jdGlvbih3YXlwb2ludCwgZGlyZWN0aW9uKSB7XG4gICAgdGhpcy50cmlnZ2VyUXVldWVzW2RpcmVjdGlvbl0ucHVzaCh3YXlwb2ludClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgR3JvdXAucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgdmFyIGluZGV4ID0gV2F5cG9pbnQuQWRhcHRlci5pbkFycmF5KHdheXBvaW50LCB0aGlzLndheXBvaW50cylcbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgdGhpcy53YXlwb2ludHMuc3BsaWNlKGluZGV4LCAxKVxuICAgIH1cbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZmlyc3QgKi9cbiAgR3JvdXAucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMud2F5cG9pbnRzWzBdXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2xhc3QgKi9cbiAgR3JvdXAucHJvdG90eXBlLmxhc3QgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy53YXlwb2ludHNbdGhpcy53YXlwb2ludHMubGVuZ3RoIC0gMV1cbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgR3JvdXAuZmluZE9yQ3JlYXRlID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIHJldHVybiBncm91cHNbb3B0aW9ucy5heGlzXVtvcHRpb25zLm5hbWVdIHx8IG5ldyBHcm91cChvcHRpb25zKVxuICB9XG5cbiAgV2F5cG9pbnQuR3JvdXAgPSBHcm91cFxufSgpKVxuOyhmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnXG5cbiAgdmFyIFdheXBvaW50ID0gd2luZG93LldheXBvaW50XG5cbiAgZnVuY3Rpb24gaXNXaW5kb3coZWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50ID09PSBlbGVtZW50LndpbmRvd1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0V2luZG93KGVsZW1lbnQpIHtcbiAgICBpZiAoaXNXaW5kb3coZWxlbWVudCkpIHtcbiAgICAgIHJldHVybiBlbGVtZW50XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50LmRlZmF1bHRWaWV3XG4gIH1cblxuICBmdW5jdGlvbiBOb0ZyYW1ld29ya0FkYXB0ZXIoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnRcbiAgICB0aGlzLmhhbmRsZXJzID0ge31cbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuaW5uZXJIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXNXaW4gPSBpc1dpbmRvdyh0aGlzLmVsZW1lbnQpXG4gICAgcmV0dXJuIGlzV2luID8gdGhpcy5lbGVtZW50LmlubmVySGVpZ2h0IDogdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodFxuICB9XG5cbiAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5pbm5lcldpZHRoID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGlzV2luID0gaXNXaW5kb3codGhpcy5lbGVtZW50KVxuICAgIHJldHVybiBpc1dpbiA/IHRoaXMuZWxlbWVudC5pbm5lcldpZHRoIDogdGhpcy5lbGVtZW50LmNsaWVudFdpZHRoXG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uKGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIGxpc3RlbmVycywgaGFuZGxlcikge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IGxpc3RlbmVycy5sZW5ndGggLSAxOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldXG4gICAgICAgIGlmICghaGFuZGxlciB8fCBoYW5kbGVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBldmVudFBhcnRzID0gZXZlbnQuc3BsaXQoJy4nKVxuICAgIHZhciBldmVudFR5cGUgPSBldmVudFBhcnRzWzBdXG4gICAgdmFyIG5hbWVzcGFjZSA9IGV2ZW50UGFydHNbMV1cbiAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudFxuXG4gICAgaWYgKG5hbWVzcGFjZSAmJiB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0gJiYgZXZlbnRUeXBlKSB7XG4gICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW2V2ZW50VHlwZV0sIGhhbmRsZXIpXG4gICAgICB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV1bZXZlbnRUeXBlXSA9IFtdXG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50VHlwZSkge1xuICAgICAgZm9yICh2YXIgbnMgaW4gdGhpcy5oYW5kbGVycykge1xuICAgICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgdGhpcy5oYW5kbGVyc1tuc11bZXZlbnRUeXBlXSB8fCBbXSwgaGFuZGxlcilcbiAgICAgICAgdGhpcy5oYW5kbGVyc1tuc11bZXZlbnRUeXBlXSA9IFtdXG4gICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hbWVzcGFjZSAmJiB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0pIHtcbiAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV1bdHlwZV0sIGhhbmRsZXIpXG4gICAgICB9XG4gICAgICB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0gPSB7fVxuICAgIH1cbiAgfVxuXG4gIC8qIEFkYXB0ZWQgZnJvbSBqUXVlcnkgMS54IG9mZnNldCgpICovXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub2Zmc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICB2YXIgZG9jdW1lbnRFbGVtZW50ID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50XG4gICAgdmFyIHdpbiA9IGdldFdpbmRvdyh0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudClcbiAgICB2YXIgcmVjdCA9IHtcbiAgICAgIHRvcDogMCxcbiAgICAgIGxlZnQ6IDBcbiAgICB9XG5cbiAgICBpZiAodGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCkge1xuICAgICAgcmVjdCA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0b3A6IHJlY3QudG9wICsgd2luLnBhZ2VZT2Zmc2V0IC0gZG9jdW1lbnRFbGVtZW50LmNsaWVudFRvcCxcbiAgICAgIGxlZnQ6IHJlY3QubGVmdCArIHdpbi5wYWdlWE9mZnNldCAtIGRvY3VtZW50RWxlbWVudC5jbGllbnRMZWZ0XG4gICAgfVxuICB9XG5cbiAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgdmFyIGV2ZW50UGFydHMgPSBldmVudC5zcGxpdCgnLicpXG4gICAgdmFyIGV2ZW50VHlwZSA9IGV2ZW50UGFydHNbMF1cbiAgICB2YXIgbmFtZXNwYWNlID0gZXZlbnRQYXJ0c1sxXSB8fCAnX19kZWZhdWx0J1xuICAgIHZhciBuc0hhbmRsZXJzID0gdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdID0gdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdIHx8IHt9XG4gICAgdmFyIG5zVHlwZUxpc3QgPSBuc0hhbmRsZXJzW2V2ZW50VHlwZV0gPSBuc0hhbmRsZXJzW2V2ZW50VHlwZV0gfHwgW11cblxuICAgIG5zVHlwZUxpc3QucHVzaChoYW5kbGVyKVxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgaGFuZGxlcilcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub3V0ZXJIZWlnaHQgPSBmdW5jdGlvbihpbmNsdWRlTWFyZ2luKSB7XG4gICAgdmFyIGhlaWdodCA9IHRoaXMuaW5uZXJIZWlnaHQoKVxuICAgIHZhciBjb21wdXRlZFN0eWxlXG5cbiAgICBpZiAoaW5jbHVkZU1hcmdpbiAmJiAhaXNXaW5kb3codGhpcy5lbGVtZW50KSkge1xuICAgICAgY29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudClcbiAgICAgIGhlaWdodCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpblRvcCwgMTApXG4gICAgICBoZWlnaHQgKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5Cb3R0b20sIDEwKVxuICAgIH1cblxuICAgIHJldHVybiBoZWlnaHRcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub3V0ZXJXaWR0aCA9IGZ1bmN0aW9uKGluY2x1ZGVNYXJnaW4pIHtcbiAgICB2YXIgd2lkdGggPSB0aGlzLmlubmVyV2lkdGgoKVxuICAgIHZhciBjb21wdXRlZFN0eWxlXG5cbiAgICBpZiAoaW5jbHVkZU1hcmdpbiAmJiAhaXNXaW5kb3codGhpcy5lbGVtZW50KSkge1xuICAgICAgY29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudClcbiAgICAgIHdpZHRoICs9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUubWFyZ2luTGVmdCwgMTApXG4gICAgICB3aWR0aCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpblJpZ2h0LCAxMClcbiAgICB9XG5cbiAgICByZXR1cm4gd2lkdGhcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuc2Nyb2xsTGVmdCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB3aW4gPSBnZXRXaW5kb3codGhpcy5lbGVtZW50KVxuICAgIHJldHVybiB3aW4gPyB3aW4ucGFnZVhPZmZzZXQgOiB0aGlzLmVsZW1lbnQuc2Nyb2xsTGVmdFxuICB9XG5cbiAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5zY3JvbGxUb3AgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgd2luID0gZ2V0V2luZG93KHRoaXMuZWxlbWVudClcbiAgICByZXR1cm4gd2luID8gd2luLnBhZ2VZT2Zmc2V0IDogdGhpcy5lbGVtZW50LnNjcm9sbFRvcFxuICB9XG5cbiAgTm9GcmFtZXdvcmtBZGFwdGVyLmV4dGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKVxuXG4gICAgZnVuY3Rpb24gbWVyZ2UodGFyZ2V0LCBvYmopIHtcbiAgICAgIGlmICh0eXBlb2YgdGFyZ2V0ID09PSAnb2JqZWN0JyAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0Jykge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICB0YXJnZXRba2V5XSA9IG9ialtrZXldXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0YXJnZXRcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpID0gMSwgZW5kID0gYXJncy5sZW5ndGg7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgbWVyZ2UoYXJnc1swXSwgYXJnc1tpXSlcbiAgICB9XG4gICAgcmV0dXJuIGFyZ3NbMF1cbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5pbkFycmF5ID0gZnVuY3Rpb24oZWxlbWVudCwgYXJyYXksIGkpIHtcbiAgICByZXR1cm4gYXJyYXkgPT0gbnVsbCA/IC0xIDogYXJyYXkuaW5kZXhPZihlbGVtZW50LCBpKVxuICB9XG5cbiAgTm9GcmFtZXdvcmtBZGFwdGVyLmlzRW1wdHlPYmplY3QgPSBmdW5jdGlvbihvYmopIHtcbiAgICAvKiBlc2xpbnQgbm8tdW51c2VkLXZhcnM6IDAgKi9cbiAgICBmb3IgKHZhciBuYW1lIGluIG9iaikge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBXYXlwb2ludC5hZGFwdGVycy5wdXNoKHtcbiAgICBuYW1lOiAnbm9mcmFtZXdvcmsnLFxuICAgIEFkYXB0ZXI6IE5vRnJhbWV3b3JrQWRhcHRlclxuICB9KVxuICBXYXlwb2ludC5BZGFwdGVyID0gTm9GcmFtZXdvcmtBZGFwdGVyXG59KCkpXG47XG59LHt9XX0se30sWzFdKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
