"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function t(e,n,o){function i(s,l){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return i(n?n:t)},h,h.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){t("../node_modules/waypoints/lib/noframework.waypoints");var o=document.body.style,i=document.location+"images/bg/",r=".png",s=["WallPaper2","WallPaper2_tone","WallPaper2.5","WallPaper3","WallPaper3.5","WallPaper4","WallPaper4.5","WallPaper5.5","WallPaper5.5_tone","WallPaper6","WallPaper6.5","WallPaper7.5","WallPaper7.5_tone"],l=!1;new Waypoint({element:document.getElementById("waypointHeader"),handler:function(t){}}),l!==!0&&(s.forEach(function(t){(new Image).src=i+t+r}),l=!0);var a=function(t){o.backgroundImage="url("+i+s[t]+r+")",console.log("loading "+i+s[t]+r)},h=document.querySelectorAll(".business-type-select");Array.prototype.slice.call(h).forEach(function(t){t.addEventListener("click",function(){console.log(t);var e=document.querySelector(".business-type-select.active");e&&e.classList.remove("active"),t.classList.add("active");for(var n=document.querySelectorAll(".hcr-menu"),o=0;o<n.length;o++)n[o].style.visibility="visible";c.accordion(0,"top",function(t,e){e.el.classList.add("open"),console.log(t,e)});var i=document.querySelector(".business-container.visible");i&&(i.style.display="none",i.classList.remove("visible"));var r=document.querySelector("."+t.dataset.business+"-container");console.log(r),$(r).fadeIn(),r.classList.add("visible"),jQuery("html, body").animate({scrollTop:$(r).offset().top},2e3,function(){$(r).find("h3").addClass("animated").addClass("pulse")}),a(Math.floor(12*Math.random())+0)})});var c=new OriDomi(document.querySelector(".hcr-menu"),{hPanels:3,ripple:2,shading:"hard",touchEnabled:!1});c.foldUp("top");var p=document.querySelectorAll(".hcr-menu-item a");Array.prototype.slice.call(p).forEach(function(t){t.addEventListener("click",function(e){e.preventDefault();var n=document.querySelector(".hcr-menu-item a.active");n&&n.classList.remove("active"),t.classList.add("active"),c.reveal(60,"bottom",function(t,e){console.log(t,e),e.modifyContent(function(t){t.style.backgroundColor="#000"})})})})},{"../node_modules/waypoints/lib/noframework.waypoints":2}],2:[function(t,e,n){!function(){function t(o){if(!o)throw new Error("No options passed to Waypoint constructor");if(!o.element)throw new Error("No element option passed to Waypoint constructor");if(!o.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+e,this.options=t.Adapter.extend({},t.defaults,o),this.element=this.options.element,this.adapter=new t.Adapter(this.element),this.callback=o.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=t.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=t.Context.findOrCreateByElement(this.options.context),t.offsetAliases[this.options.offset]&&(this.options.offset=t.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),n[this.key]=this,e+=1}var e=0,n={};t.prototype.queueTrigger=function(t){this.group.queueTrigger(this,t)},t.prototype.trigger=function(t){this.enabled&&this.callback&&this.callback.apply(this,t)},t.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete n[this.key]},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},t.prototype.next=function(){return this.group.next(this)},t.prototype.previous=function(){return this.group.previous(this)},t.invokeAll=function(t){var e=[];for(var o in n)e.push(n[o]);for(var i=0,r=e.length;r>i;i++)e[i][t]()},t.destroyAll=function(){t.invokeAll("destroy")},t.disableAll=function(){t.invokeAll("disable")},t.enableAll=function(){t.invokeAll("enable")},t.refreshAll=function(){t.Context.refreshAll()},t.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},t.viewportWidth=function(){return document.documentElement.clientWidth},t.adapters=[],t.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},t.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=t}(),function(){function t(t){window.setTimeout(t,1e3/60)}function e(t){this.element=t,this.Adapter=i.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+n,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,o[t.waypointContextKey]=this,n+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var n=0,o={},i=window.Waypoint,r=window.onload;e.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},e.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical);t&&e&&(this.adapter.off(".waypoints"),delete o[this.key])},e.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,i.requestAnimationFrame(t))})},e.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){e.didScroll&&!i.isTouch||(e.didScroll=!0,i.requestAnimationFrame(t))})},e.prototype.handleResize=function(){i.Context.refreshAll()},e.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var n in e){var o=e[n],i=o.newScroll>o.oldScroll,r=i?o.forward:o.backward;for(var s in this.waypoints[n]){var l=this.waypoints[n][s],a=o.oldScroll<l.triggerPoint,h=o.newScroll>=l.triggerPoint,c=a&&h,p=!a&&!h;(c||p)&&(l.queueTrigger(r),t[l.group.id]=l.group)}}for(var u in t)t[u].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.innerHeight=function(){return this.element==this.element.window?i.viewportHeight():this.adapter.innerHeight()},e.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},e.prototype.innerWidth=function(){return this.element==this.element.window?i.viewportWidth():this.adapter.innerWidth()},e.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var n in this.waypoints[e])t.push(this.waypoints[e][n]);for(var o=0,i=t.length;i>o;o++)t[o].destroy()},e.prototype.refresh=function(){var t,e=this.element==this.element.window,n=e?void 0:this.adapter.offset(),o={};this.handleScroll(),t={horizontal:{contextOffset:e?0:n.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:n.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var r in t){var s=t[r];for(var l in this.waypoints[r]){var a,h,c,p,u,d=this.waypoints[r][l],f=d.options.offset,y=d.triggerPoint,m=0,g=null==y;d.element!==d.element.window&&(m=d.adapter.offset()[s.offsetProp]),"function"==typeof f?f=f.apply(d):"string"==typeof f&&(f=parseFloat(f),d.options.offset.indexOf("%")>-1&&(f=Math.ceil(s.contextDimension*f/100))),a=s.contextScroll-s.contextOffset,d.triggerPoint=m+a-f,h=y<s.oldScroll,c=d.triggerPoint>=s.oldScroll,p=h&&c,u=!h&&!c,!g&&p?(d.queueTrigger(s.backward),o[d.group.id]=d.group):!g&&u?(d.queueTrigger(s.forward),o[d.group.id]=d.group):g&&s.oldScroll>=d.triggerPoint&&(d.queueTrigger(s.forward),o[d.group.id]=d.group)}}return i.requestAnimationFrame(function(){for(var t in o)o[t].flushTriggers()}),this},e.findOrCreateByElement=function(t){return e.findByElement(t)||new e(t)},e.refreshAll=function(){for(var t in o)o[t].refresh()},e.findByElement=function(t){return o[t.waypointContextKey]},window.onload=function(){r&&r(),e.refreshAll()},i.requestAnimationFrame=function(e){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t;n.call(window,e)},i.Context=e}(),function(){function t(t,e){return t.triggerPoint-e.triggerPoint}function e(t,e){return e.triggerPoint-t.triggerPoint}function n(t){this.name=t.name,this.axis=t.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),o[this.axis][this.name]=this}var o={vertical:{},horizontal:{}},i=window.Waypoint;n.prototype.add=function(t){this.waypoints.push(t)},n.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},n.prototype.flushTriggers=function(){for(var n in this.triggerQueues){var o=this.triggerQueues[n],i="up"===n||"left"===n;o.sort(i?e:t);for(var r=0,s=o.length;s>r;r+=1){var l=o[r];(l.options.continuous||r===o.length-1)&&l.trigger([n])}}this.clearTriggerQueues()},n.prototype.next=function(e){this.waypoints.sort(t);var n=i.Adapter.inArray(e,this.waypoints),o=n===this.waypoints.length-1;return o?null:this.waypoints[n+1]},n.prototype.previous=function(e){this.waypoints.sort(t);var n=i.Adapter.inArray(e,this.waypoints);return n?this.waypoints[n-1]:null},n.prototype.queueTrigger=function(t,e){this.triggerQueues[e].push(t)},n.prototype.remove=function(t){var e=i.Adapter.inArray(t,this.waypoints);e>-1&&this.waypoints.splice(e,1)},n.prototype.first=function(){return this.waypoints[0]},n.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},n.findOrCreate=function(t){return o[t.axis][t.name]||new n(t)},i.Group=n}(),function(){function t(t){return t===t.window}function e(e){return t(e)?e:e.defaultView}function n(t){this.element=t,this.handlers={}}var o=window.Waypoint;n.prototype.innerHeight=function(){var e=t(this.element);return e?this.element.innerHeight:this.element.clientHeight},n.prototype.innerWidth=function(){var e=t(this.element);return e?this.element.innerWidth:this.element.clientWidth},n.prototype.off=function(t,e){function n(t,e,n){for(var o=0,i=e.length-1;i>o;o++){var r=e[o];n&&n!==r||t.removeEventListener(r)}}var o=t.split("."),i=o[0],r=o[1],s=this.element;if(r&&this.handlers[r]&&i)n(s,this.handlers[r][i],e),this.handlers[r][i]=[];else if(i)for(var l in this.handlers)n(s,this.handlers[l][i]||[],e),this.handlers[l][i]=[];else if(r&&this.handlers[r]){for(var a in this.handlers[r])n(s,this.handlers[r][a],e);this.handlers[r]={}}},n.prototype.offset=function(){if(!this.element.ownerDocument)return null;var t=this.element.ownerDocument.documentElement,n=e(this.element.ownerDocument),o={top:0,left:0};return this.element.getBoundingClientRect&&(o=this.element.getBoundingClientRect()),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}},n.prototype.on=function(t,e){var n=t.split("."),o=n[0],i=n[1]||"__default",r=this.handlers[i]=this.handlers[i]||{},s=r[o]=r[o]||[];s.push(e),this.element.addEventListener(o,e)},n.prototype.outerHeight=function(e){var n,o=this.innerHeight();return e&&!t(this.element)&&(n=window.getComputedStyle(this.element),o+=parseInt(n.marginTop,10),o+=parseInt(n.marginBottom,10)),o},n.prototype.outerWidth=function(e){var n,o=this.innerWidth();return e&&!t(this.element)&&(n=window.getComputedStyle(this.element),o+=parseInt(n.marginLeft,10),o+=parseInt(n.marginRight,10)),o},n.prototype.scrollLeft=function(){var t=e(this.element);return t?t.pageXOffset:this.element.scrollLeft},n.prototype.scrollTop=function(){var t=e(this.element);return t?t.pageYOffset:this.element.scrollTop},n.extend=function(){function t(t,e){if("object"===("undefined"==typeof t?"undefined":_typeof(t))&&"object"===("undefined"==typeof e?"undefined":_typeof(e)))for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}for(var e=Array.prototype.slice.call(arguments),n=1,o=e.length;o>n;n++)t(e[0],e[n]);return e[0]},n.inArray=function(t,e,n){return null==e?-1:e.indexOf(t,n)},n.isEmptyObject=function(t){for(var e in t)return!1;return!0},o.adapters.push({name:"noframework",Adapter:n}),o.Adapter=n}()},{}]},{},[1]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5taW4uanMiLCJhcHAuanMiXSwibmFtZXMiOlsiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJlIiwidCIsIm4iLCJyIiwicyIsIm8iLCJ1IiwiYSIsInJlcXVpcmUiLCJpIiwiRXJyb3IiLCJmIiwiZXhwb3J0cyIsImNhbGwiLCJsZW5ndGgiLCIxIiwibW9kdWxlIiwiZG9jU3R5bGUiLCJkb2N1bWVudCIsImJvZHkiLCJzdHlsZSIsImJnUGF0aCIsImxvY2F0aW9uIiwiaW1nRXh0IiwiYmdzIiwiYmdJbWFnZXNMb2FkZWQiLCJXYXlwb2ludCIsImVsZW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhhbmRsZXIiLCJkaXJlY3Rpb24iLCJmb3JFYWNoIiwiYmciLCJJbWFnZSIsInNyYyIsImxvYWRCZyIsImJhY2tncm91bmRJbWFnZSIsImNvbnNvbGUiLCJsb2ciLCJidXNpbmVzc1NlbGVjdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJBcnJheSIsInByb3RvdHlwZSIsInNsaWNlIiwiZWwiLCJhZGRFdmVudExpc3RlbmVyIiwiY3VycmVudEFjdGl2ZSIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJtZW51cyIsInZpc2liaWxpdHkiLCJmb2xkTWVudSIsImFjY29yZGlvbiIsImV2Iiwib3JpIiwiY3VycmVudFZpc2libGUiLCJkaXNwbGF5Iiwic2VjdGlvblRvU2hvdyIsImRhdGFzZXQiLCJidXNpbmVzcyIsIiQiLCJmYWRlSW4iLCJqUXVlcnkiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwib2Zmc2V0IiwidG9wIiwiZmluZCIsImFkZENsYXNzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiT3JpRG9taSIsImhQYW5lbHMiLCJyaXBwbGUiLCJzaGFkaW5nIiwidG91Y2hFbmFibGVkIiwiZm9sZFVwIiwiaGNyTWVudUl0ZW1MaW5rIiwicHJldmVudERlZmF1bHQiLCJyZXZlYWwiLCJtb2RpZnlDb250ZW50IiwiYmFja2dyb3VuZENvbG9yIiwiLi4vbm9kZV9tb2R1bGVzL3dheXBvaW50cy9saWIvbm9mcmFtZXdvcmsud2F5cG9pbnRzIiwiMiIsIm9wdGlvbnMiLCJ0aGlzIiwia2V5Iiwia2V5Q291bnRlciIsIkFkYXB0ZXIiLCJleHRlbmQiLCJkZWZhdWx0cyIsImFkYXB0ZXIiLCJjYWxsYmFjayIsImF4aXMiLCJob3Jpem9udGFsIiwiZW5hYmxlZCIsInRyaWdnZXJQb2ludCIsImdyb3VwIiwiR3JvdXAiLCJmaW5kT3JDcmVhdGUiLCJuYW1lIiwiY29udGV4dCIsIkNvbnRleHQiLCJmaW5kT3JDcmVhdGVCeUVsZW1lbnQiLCJvZmZzZXRBbGlhc2VzIiwiYWxsV2F5cG9pbnRzIiwicXVldWVUcmlnZ2VyIiwidHJpZ2dlciIsImFyZ3MiLCJhcHBseSIsImRlc3Ryb3kiLCJkaXNhYmxlIiwiZW5hYmxlIiwicmVmcmVzaCIsIm5leHQiLCJwcmV2aW91cyIsImludm9rZUFsbCIsIm1ldGhvZCIsImFsbFdheXBvaW50c0FycmF5Iiwid2F5cG9pbnRLZXkiLCJwdXNoIiwiZW5kIiwiZGVzdHJveUFsbCIsImRpc2FibGVBbGwiLCJlbmFibGVBbGwiLCJyZWZyZXNoQWxsIiwidmlld3BvcnRIZWlnaHQiLCJ3aW5kb3ciLCJpbm5lckhlaWdodCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsInZpZXdwb3J0V2lkdGgiLCJjbGllbnRXaWR0aCIsImFkYXB0ZXJzIiwiY29udGludW91cyIsImJvdHRvbS1pbi12aWV3Iiwib3V0ZXJIZWlnaHQiLCJyaWdodC1pbi12aWV3IiwiaW5uZXJXaWR0aCIsIm91dGVyV2lkdGgiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWVTaGltIiwic2V0VGltZW91dCIsImRpZFNjcm9sbCIsImRpZFJlc2l6ZSIsIm9sZFNjcm9sbCIsIngiLCJzY3JvbGxMZWZ0IiwieSIsIndheXBvaW50cyIsInZlcnRpY2FsIiwid2F5cG9pbnRDb250ZXh0S2V5IiwiY29udGV4dHMiLCJjcmVhdGVUaHJvdHRsZWRTY3JvbGxIYW5kbGVyIiwiY3JlYXRlVGhyb3R0bGVkUmVzaXplSGFuZGxlciIsIm9sZFdpbmRvd0xvYWQiLCJvbmxvYWQiLCJ3YXlwb2ludCIsImNoZWNrRW1wdHkiLCJob3Jpem9udGFsRW1wdHkiLCJpc0VtcHR5T2JqZWN0IiwidmVydGljYWxFbXB0eSIsIm9mZiIsInJlc2l6ZUhhbmRsZXIiLCJzZWxmIiwiaGFuZGxlUmVzaXplIiwib24iLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJzY3JvbGxIYW5kbGVyIiwiaGFuZGxlU2Nyb2xsIiwiaXNUb3VjaCIsInRyaWdnZXJlZEdyb3VwcyIsImF4ZXMiLCJuZXdTY3JvbGwiLCJmb3J3YXJkIiwiYmFja3dhcmQiLCJheGlzS2V5IiwiaXNGb3J3YXJkIiwid2FzQmVmb3JlVHJpZ2dlclBvaW50Iiwibm93QWZ0ZXJUcmlnZ2VyUG9pbnQiLCJjcm9zc2VkRm9yd2FyZCIsImNyb3NzZWRCYWNrd2FyZCIsImlkIiwiZ3JvdXBLZXkiLCJmbHVzaFRyaWdnZXJzIiwiaXNXaW5kb3ciLCJjb250ZXh0T2Zmc2V0IiwidW5kZWZpbmVkIiwibGVmdCIsImNvbnRleHRTY3JvbGwiLCJjb250ZXh0RGltZW5zaW9uIiwib2Zmc2V0UHJvcCIsImNvbnRleHRNb2RpZmllciIsIndhc0JlZm9yZVNjcm9sbCIsIm5vd0FmdGVyU2Nyb2xsIiwidHJpZ2dlcmVkQmFja3dhcmQiLCJ0cmlnZ2VyZWRGb3J3YXJkIiwiYWRqdXN0bWVudCIsIm9sZFRyaWdnZXJQb2ludCIsImVsZW1lbnRPZmZzZXQiLCJmcmVzaFdheXBvaW50IiwicGFyc2VGbG9hdCIsImluZGV4T2YiLCJjZWlsIiwiZmluZEJ5RWxlbWVudCIsImNvbnRleHRJZCIsInJlcXVlc3RGbiIsIm1velJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJ5VHJpZ2dlclBvaW50IiwiYiIsImJ5UmV2ZXJzZVRyaWdnZXJQb2ludCIsImNsZWFyVHJpZ2dlclF1ZXVlcyIsImdyb3VwcyIsInRyaWdnZXJRdWV1ZXMiLCJ1cCIsImRvd24iLCJyaWdodCIsInJldmVyc2UiLCJzb3J0IiwiaW5kZXgiLCJpbkFycmF5IiwiaXNMYXN0Iiwic3BsaWNlIiwiZmlyc3QiLCJsYXN0IiwiZ2V0V2luZG93IiwiZGVmYXVsdFZpZXciLCJOb0ZyYW1ld29ya0FkYXB0ZXIiLCJoYW5kbGVycyIsImlzV2luIiwiZXZlbnQiLCJyZW1vdmVMaXN0ZW5lcnMiLCJsaXN0ZW5lcnMiLCJsaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudFBhcnRzIiwic3BsaXQiLCJldmVudFR5cGUiLCJuYW1lc3BhY2UiLCJucyIsInR5cGUiLCJvd25lckRvY3VtZW50Iiwid2luIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInBhZ2VZT2Zmc2V0IiwiY2xpZW50VG9wIiwicGFnZVhPZmZzZXQiLCJjbGllbnRMZWZ0IiwibnNIYW5kbGVycyIsIm5zVHlwZUxpc3QiLCJpbmNsdWRlTWFyZ2luIiwiY29tcHV0ZWRTdHlsZSIsImhlaWdodCIsImdldENvbXB1dGVkU3R5bGUiLCJwYXJzZUludCIsIm1hcmdpblRvcCIsIm1hcmdpbkJvdHRvbSIsIndpZHRoIiwibWFyZ2luTGVmdCIsIm1hcmdpblJpZ2h0IiwibWVyZ2UiLCJ0YXJnZXQiLCJoYXNPd25Qcm9wZXJ0eSIsImFyZ3VtZW50cyIsImFycmF5Il0sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLElBQUlBLFNBQTRCLGtCQUFYQyxTQUFvRCxnQkFBcEJBLFFBQU9DLFNBQXdCLFNBQVVDLEdBQU8sYUFBY0EsSUFBUyxTQUFVQSxHQUFPLE1BQU9BLElBQXlCLGtCQUFYRixTQUF5QkUsRUFBSUMsY0FBZ0JILE9BQVMsZUFBa0JFLEtDRjFPLFFBQVVFLEdBQUVDLEVBQUVDLEVBQUVDLEdBQUcsUUFBU0MsR0FBRUMsRUFBRUMsR0FBRyxJQUFJSixFQUFFRyxHQUFHLENBQUMsSUFBSUosRUFBRUksR0FBRyxDQUFDLEdBQUlF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QkFBTzNRLEdBQVAsWUFBQUgsUUFBT0csSUFDdkMsSUFBSyxHQUFJMkYsS0FBTzNGLEdBQ1ZBLEVBQUk0USxlQUFlakwsS0FDckJnTCxFQUFPaEwsR0FBTzNGLEVBQUkyRixHQUt4QixPQUFPZ0wsR0FHVCxJQUFLLEdBZEQxSixHQUFPdEUsTUFBTUMsVUFBVUMsTUFBTTlCLEtBQUs4UCxXQWM3QmxRLEVBQUksRUFBR21ILEVBQU1iLEVBQUtqRyxPQUFZOEcsRUFBSm5ILEVBQVNBLElBQzFDK1AsRUFBTXpKLEVBQUssR0FBSUEsRUFBS3RHLEdBRXRCLE9BQU9zRyxHQUFLLElBR2R1SCxFQUFtQlAsUUFBVSxTQUFTcE0sRUFBU2lQLEVBQU9uUSxHQUNwRCxNQUFnQixPQUFUbVEsRUFBZ0IsR0FBS0EsRUFBTWhFLFFBQVFqTCxFQUFTbEIsSUFHckQ2TixFQUFtQnBFLGNBQWdCLFNBQVNwSyxHQUUxQyxJQUFLLEdBQUl5RyxLQUFRekcsR0FDZixPQUFPLENBRVQsUUFBTyxHQUdUNEIsRUFBUzhHLFNBQVNiLE1BQ2hCcEIsS0FBTSxjQUNOWixRQUFTMkksSUFFWDVNLEVBQVNpRSxRQUFVMkksZUFHViIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG4oZnVuY3Rpb24gZSh0LCBuLCByKSB7XG4gIGZ1bmN0aW9uIHMobywgdSkge1xuICAgIGlmICghbltvXSkge1xuICAgICAgaWYgKCF0W29dKSB7XG4gICAgICAgIHZhciBhID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7aWYgKCF1ICYmIGEpIHJldHVybiBhKG8sICEwKTtpZiAoaSkgcmV0dXJuIGkobywgITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyBvICsgXCInXCIpO1xuICAgICAgfXZhciBmID0gbltvXSA9IHsgZXhwb3J0czoge30gfTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgbiA9IHRbb11bMV1bZV07cmV0dXJuIHMobiA/IG4gOiBlKTtcbiAgICAgIH0sIGYsIGYuZXhwb3J0cywgZSwgdCwgbiwgcik7XG4gICAgfXJldHVybiBuW29dLmV4cG9ydHM7XG4gIH12YXIgaSA9IHR5cGVvZiByZXF1aXJlID09IFwiZnVuY3Rpb25cIiAmJiByZXF1aXJlO2ZvciAodmFyIG8gPSAwOyBvIDwgci5sZW5ndGg7IG8rKykge1xuICAgIHMocltvXSk7XG4gIH1yZXR1cm4gcztcbn0pKHsgMTogW2Z1bmN0aW9uIChyZXF1aXJlLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICByZXF1aXJlKCcuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHMnKTtcblxuICAgIHZhciBkb2NTdHlsZSA9IGRvY3VtZW50LmJvZHkuc3R5bGU7XG4gICAgdmFyIGJnUGF0aCA9IGRvY3VtZW50LmxvY2F0aW9uICsgJ2ltYWdlcy9iZy8nO1xuICAgIHZhciBpbWdFeHQgPSAnLnBuZyc7XG4gICAgdmFyIGJncyA9IFsnV2FsbFBhcGVyMicsICdXYWxsUGFwZXIyX3RvbmUnLCAnV2FsbFBhcGVyMi41JywgJ1dhbGxQYXBlcjMnLCAnV2FsbFBhcGVyMy41JywgJ1dhbGxQYXBlcjQnLCAnV2FsbFBhcGVyNC41JywgJ1dhbGxQYXBlcjUuNScsICdXYWxsUGFwZXI1LjVfdG9uZScsICdXYWxsUGFwZXI2JywgJ1dhbGxQYXBlcjYuNScsICdXYWxsUGFwZXI3LjUnLCAnV2FsbFBhcGVyNy41X3RvbmUnXTtcbiAgICB2YXIgYmdJbWFnZXNMb2FkZWQgPSBmYWxzZTtcblxuICAgIG5ldyBXYXlwb2ludCh7XG4gICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2F5cG9pbnRIZWFkZXInKSxcbiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoZGlyZWN0aW9uKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ1Njcm9sbGVkIHRvIHdheXBvaW50IDEnKVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gVXRpbGl0eVxuICAgIC8vIHNldHVwIHdheXBvaW50c1xuICAgIC8vIGNvbnN0IGRlZmluZVdheXBvaW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyAgICAgd2luZG93LndheXBvaW50cyA9IFtdO1xuICAgIC8vICAgICBsZXQgd2F5cG9pbnRVbml0ID0gTWF0aC5mbG9vcigoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndyYXBwZXInKS5jbGllbnRIZWlnaHQgLyBiZ3MubGVuZ3RoKSk7XG4gICAgLy8gICAgIGJncy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCkge1xuICAgIC8vICAgICAgICAgY29uc29sZS5sb2cod2F5cG9pbnRVbml0ICogKGluZGV4ICsgMSkpO1xuICAgIC8vICAgICAgICAgd2luZG93LndheXBvaW50c1tpbmRleF0gPSBuZXcgV2F5cG9pbnQoe1xuICAgIC8vICAgICAgICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YXlwb2ludEhlYWRlcicpLFxuICAgIC8vICAgICAgICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYGxvYWRpbmcgJHtiZ3NbaW5kZXhdfSBmcm9tIGxvb3AgZnVuY3Rpb25gKTsgLy90ZXN0XG4gICAgLy8gICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgIC8vICAgICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgICAgb2Zmc2V0OiB3YXlwb2ludFVuaXQgKiAoaW5kZXggKyAxKSAqIC0xXG4gICAgLy8gICAgICAgICB9KVxuICAgIC8vICAgICB9KVxuICAgIC8vIH0oKTtcbiAgICAvLyBwcmVsb2FkIGltYWdlc1xuICAgIGlmIChiZ0ltYWdlc0xvYWRlZCAhPT0gdHJ1ZSkge1xuICAgICAgYmdzLmZvckVhY2goZnVuY3Rpb24gKGJnKSB7XG4gICAgICAgIG5ldyBJbWFnZSgpLnNyYyA9IGJnUGF0aCArIGJnICsgaW1nRXh0O1xuICAgICAgICAvLyBjYWNoZXMgaW1hZ2VzLCBhdm9pZGluZyB3aGl0ZSBmbGFzaCBiZXR3ZWVuIGJhY2tncm91bmQgcmVwbGFjZW1lbnRzXG4gICAgICB9KTtcbiAgICAgIGJnSW1hZ2VzTG9hZGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgLy8gbG9hZCBiZyBpbWFnZVxuICAgIHZhciBsb2FkQmcgPSBmdW5jdGlvbiBsb2FkQmcoYmcpIHtcbiAgICAgIGRvY1N0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgYmdQYXRoICsgYmdzW2JnXSArIGltZ0V4dCArIFwiKVwiO1xuICAgICAgY29uc29sZS5sb2coXCJsb2FkaW5nIFwiICsgYmdQYXRoICsgYmdzW2JnXSArIGltZ0V4dCk7XG4gICAgfTtcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vIGJ1c2luZXNzIHNlbGVjdCBidXR0b25zXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICB2YXIgYnVzaW5lc3NTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnVzaW5lc3MtdHlwZS1zZWxlY3QnKTtcbiAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChidXNpbmVzc1NlbGVjdCkuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhlbCk7XG4gICAgICAgIC8vIGdldCB0aGUgYWN0aXZlIG1lbnUgaXRlbSBhbmQgdHVybiBpdCBvZmZcbiAgICAgICAgdmFyIGN1cnJlbnRBY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVzaW5lc3MtdHlwZS1zZWxlY3QuYWN0aXZlJyk7XG4gICAgICAgIGlmIChjdXJyZW50QWN0aXZlKSB7XG4gICAgICAgICAgY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0dXJuIG9uIHRoZSBuZXcgbWVudSBpdGVtXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAvLyBzaG93IHRoZSBuYXZcbiAgICAgICAgdmFyIG1lbnVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmhjci1tZW51Jyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWVudXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBtZW51c1tpXS5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICB9XG4gICAgICAgIGZvbGRNZW51LmFjY29yZGlvbigwLCAndG9wJywgZnVuY3Rpb24gKGV2LCBvcmkpIHtcbiAgICAgICAgICBvcmkuZWwuY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGV2LCBvcmkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGN1cnJlbnRWaXNpYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1c2luZXNzLWNvbnRhaW5lci52aXNpYmxlJyk7XG4gICAgICAgIGlmIChjdXJyZW50VmlzaWJsZSkge1xuICAgICAgICAgIGN1cnJlbnRWaXNpYmxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgY3VycmVudFZpc2libGUuY2xhc3NMaXN0LnJlbW92ZSgndmlzaWJsZScpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWN0aW9uVG9TaG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5cIiArIGVsLmRhdGFzZXQuYnVzaW5lc3MgKyBcIi1jb250YWluZXJcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKHNlY3Rpb25Ub1Nob3cpO1xuICAgICAgICAkKHNlY3Rpb25Ub1Nob3cpLmZhZGVJbigpO1xuICAgICAgICBzZWN0aW9uVG9TaG93LmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKTtcbiAgICAgICAgalF1ZXJ5KCdodG1sLCBib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgc2Nyb2xsVG9wOiAkKHNlY3Rpb25Ub1Nob3cpLm9mZnNldCgpLnRvcFxuICAgICAgICB9LCAyMDAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJChzZWN0aW9uVG9TaG93KS5maW5kKCdoMycpLmFkZENsYXNzKCdhbmltYXRlZCcpLmFkZENsYXNzKCdwdWxzZScpO1xuICAgICAgICB9KTtcbiAgICAgICAgbG9hZEJnKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEyKSArIDApO1xuICAgICAgICAvL2RlZmluZVdheXBvaW50cygpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgLy8vLy8vLy8vLy9cbiAgICAvLyBoY3IgbWVudVxuICAgIC8vLy8vLy8vLy8vXG4gICAgdmFyIGZvbGRNZW51ID0gbmV3IE9yaURvbWkoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhjci1tZW51JyksIHtcbiAgICAgIGhQYW5lbHM6IDMsXG4gICAgICByaXBwbGU6IDIsXG4gICAgICBzaGFkaW5nOiAnaGFyZCcsXG4gICAgICB0b3VjaEVuYWJsZWQ6IGZhbHNlXG4gICAgfSk7XG4gICAgLy8gbG9hZFxuICAgIGZvbGRNZW51LmZvbGRVcCgndG9wJyk7XG5cbiAgICAvLyBjbGlja1xuICAgIHZhciBoY3JNZW51SXRlbUxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGNyLW1lbnUtaXRlbSBhJyk7XG4gICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoaGNyTWVudUl0ZW1MaW5rKS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgLy8gZ2V0IHRoZSBhY3RpdmUgbWVudSBpdGVtIGFuZCB0dXJuIGl0IG9mZlxuICAgICAgICB2YXIgY3VycmVudEFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oY3ItbWVudS1pdGVtIGEuYWN0aXZlJyk7XG4gICAgICAgIGlmIChjdXJyZW50QWN0aXZlKSB7XG4gICAgICAgICAgY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0dXJuIG9uIHRoZSBuZXcgbWVudSBpdGVtXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAvLyBmb2xkIHVwIGFuZCBzaG93IGxpbmsgdGV4dFxuICAgICAgICBmb2xkTWVudS5yZXZlYWwoNjAsICdib3R0b20nLCBmdW5jdGlvbiAoZXYsIG9yaSkge1xuICAgICAgICAgIC8vb3JpLmVsLmNsYXNzTGlzdC5hZGQoJ29wZW4nKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhldiwgb3JpKTtcbiAgICAgICAgICBvcmkubW9kaWZ5Q29udGVudChmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgIGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjMDAwJztcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSwgeyBcIi4uL25vZGVfbW9kdWxlcy93YXlwb2ludHMvbGliL25vZnJhbWV3b3JrLndheXBvaW50c1wiOiAyIH1dLCAyOiBbZnVuY3Rpb24gKHJlcXVpcmUsIG1vZHVsZSwgZXhwb3J0cykge1xuICAgIC8qIVxuICAgIFdheXBvaW50cyAtIDQuMC4wXG4gICAgQ29weXJpZ2h0IMKpIDIwMTEtMjAxNSBDYWxlYiBUcm91Z2h0b25cbiAgICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gICAgaHR0cHM6Ly9naXRodWIuY29tL2ltYWtld2VidGhpbmdzL3dheXBvaW50cy9ibG9nL21hc3Rlci9saWNlbnNlcy50eHRcbiAgICAqL1xuICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgIHZhciBrZXlDb3VudGVyID0gMDtcbiAgICAgIHZhciBhbGxXYXlwb2ludHMgPSB7fTtcblxuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3dheXBvaW50ICovXG4gICAgICBmdW5jdGlvbiBXYXlwb2ludChvcHRpb25zKSB7XG4gICAgICAgIGlmICghb3B0aW9ucykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gb3B0aW9ucyBwYXNzZWQgdG8gV2F5cG9pbnQgY29uc3RydWN0b3InKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW9wdGlvbnMuZWxlbWVudCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZWxlbWVudCBvcHRpb24gcGFzc2VkIHRvIFdheXBvaW50IGNvbnN0cnVjdG9yJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvcHRpb25zLmhhbmRsZXIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGhhbmRsZXIgb3B0aW9uIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5rZXkgPSAnd2F5cG9pbnQtJyArIGtleUNvdW50ZXI7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IFdheXBvaW50LkFkYXB0ZXIuZXh0ZW5kKHt9LCBXYXlwb2ludC5kZWZhdWx0cywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IHRoaXMub3B0aW9ucy5lbGVtZW50O1xuICAgICAgICB0aGlzLmFkYXB0ZXIgPSBuZXcgV2F5cG9pbnQuQWRhcHRlcih0aGlzLmVsZW1lbnQpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrID0gb3B0aW9ucy5oYW5kbGVyO1xuICAgICAgICB0aGlzLmF4aXMgPSB0aGlzLm9wdGlvbnMuaG9yaXpvbnRhbCA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XG4gICAgICAgIHRoaXMuZW5hYmxlZCA9IHRoaXMub3B0aW9ucy5lbmFibGVkO1xuICAgICAgICB0aGlzLnRyaWdnZXJQb2ludCA9IG51bGw7XG4gICAgICAgIHRoaXMuZ3JvdXAgPSBXYXlwb2ludC5Hcm91cC5maW5kT3JDcmVhdGUoe1xuICAgICAgICAgIG5hbWU6IHRoaXMub3B0aW9ucy5ncm91cCxcbiAgICAgICAgICBheGlzOiB0aGlzLmF4aXNcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IFdheXBvaW50LkNvbnRleHQuZmluZE9yQ3JlYXRlQnlFbGVtZW50KHRoaXMub3B0aW9ucy5jb250ZXh0KTtcblxuICAgICAgICBpZiAoV2F5cG9pbnQub2Zmc2V0QWxpYXNlc1t0aGlzLm9wdGlvbnMub2Zmc2V0XSkge1xuICAgICAgICAgIHRoaXMub3B0aW9ucy5vZmZzZXQgPSBXYXlwb2ludC5vZmZzZXRBbGlhc2VzW3RoaXMub3B0aW9ucy5vZmZzZXRdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ3JvdXAuYWRkKHRoaXMpO1xuICAgICAgICB0aGlzLmNvbnRleHQuYWRkKHRoaXMpO1xuICAgICAgICBhbGxXYXlwb2ludHNbdGhpcy5rZXldID0gdGhpcztcbiAgICAgICAga2V5Q291bnRlciArPSAxO1xuICAgICAgfVxuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBXYXlwb2ludC5wcm90b3R5cGUucXVldWVUcmlnZ2VyID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICB0aGlzLmdyb3VwLnF1ZXVlVHJpZ2dlcih0aGlzLCBkaXJlY3Rpb24pO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgV2F5cG9pbnQucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jYWxsYmFjaykge1xuICAgICAgICAgIHRoaXMuY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rlc3Ryb3kgKi9cbiAgICAgIFdheXBvaW50LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlKHRoaXMpO1xuICAgICAgICB0aGlzLmdyb3VwLnJlbW92ZSh0aGlzKTtcbiAgICAgICAgZGVsZXRlIGFsbFdheXBvaW50c1t0aGlzLmtleV07XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kaXNhYmxlICovXG4gICAgICBXYXlwb2ludC5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5lbmFibGVkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZW5hYmxlICovXG4gICAgICBXYXlwb2ludC5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNvbnRleHQucmVmcmVzaCgpO1xuICAgICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL25leHQgKi9cbiAgICAgIFdheXBvaW50LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ncm91cC5uZXh0KHRoaXMpO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvcHJldmlvdXMgKi9cbiAgICAgIFdheXBvaW50LnByb3RvdHlwZS5wcmV2aW91cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ3JvdXAucHJldmlvdXModGhpcyk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBXYXlwb2ludC5pbnZva2VBbGwgPSBmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICAgIHZhciBhbGxXYXlwb2ludHNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiBhbGxXYXlwb2ludHMpIHtcbiAgICAgICAgICBhbGxXYXlwb2ludHNBcnJheS5wdXNoKGFsbFdheXBvaW50c1t3YXlwb2ludEtleV0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSBhbGxXYXlwb2ludHNBcnJheS5sZW5ndGg7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgIGFsbFdheXBvaW50c0FycmF5W2ldW21ldGhvZF0oKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZGVzdHJveS1hbGwgKi9cbiAgICAgIFdheXBvaW50LmRlc3Ryb3lBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFdheXBvaW50Lmludm9rZUFsbCgnZGVzdHJveScpO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZGlzYWJsZS1hbGwgKi9cbiAgICAgIFdheXBvaW50LmRpc2FibGVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFdheXBvaW50Lmludm9rZUFsbCgnZGlzYWJsZScpO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZW5hYmxlLWFsbCAqL1xuICAgICAgV2F5cG9pbnQuZW5hYmxlQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2VuYWJsZScpO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvcmVmcmVzaC1hbGwgKi9cbiAgICAgIFdheXBvaW50LnJlZnJlc2hBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFdheXBvaW50LkNvbnRleHQucmVmcmVzaEFsbCgpO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvdmlld3BvcnQtaGVpZ2h0ICovXG4gICAgICBXYXlwb2ludC52aWV3cG9ydEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvdmlld3BvcnQtd2lkdGggKi9cbiAgICAgIFdheXBvaW50LnZpZXdwb3J0V2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7XG4gICAgICB9O1xuXG4gICAgICBXYXlwb2ludC5hZGFwdGVycyA9IFtdO1xuXG4gICAgICBXYXlwb2ludC5kZWZhdWx0cyA9IHtcbiAgICAgICAgY29udGV4dDogd2luZG93LFxuICAgICAgICBjb250aW51b3VzOiB0cnVlLFxuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICBncm91cDogJ2RlZmF1bHQnLFxuICAgICAgICBob3Jpem9udGFsOiBmYWxzZSxcbiAgICAgICAgb2Zmc2V0OiAwXG4gICAgICB9O1xuXG4gICAgICBXYXlwb2ludC5vZmZzZXRBbGlhc2VzID0ge1xuICAgICAgICAnYm90dG9tLWluLXZpZXcnOiBmdW5jdGlvbiBib3R0b21JblZpZXcoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pbm5lckhlaWdodCgpIC0gdGhpcy5hZGFwdGVyLm91dGVySGVpZ2h0KCk7XG4gICAgICAgIH0sXG4gICAgICAgICdyaWdodC1pbi12aWV3JzogZnVuY3Rpb24gcmlnaHRJblZpZXcoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pbm5lcldpZHRoKCkgLSB0aGlzLmFkYXB0ZXIub3V0ZXJXaWR0aCgpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB3aW5kb3cuV2F5cG9pbnQgPSBXYXlwb2ludDtcbiAgICB9KSgpOyhmdW5jdGlvbiAoKSB7XG4gICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgIGZ1bmN0aW9uIHJlcXVlc3RBbmltYXRpb25GcmFtZVNoaW0oY2FsbGJhY2spIHtcbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyA2MCk7XG4gICAgICB9XG5cbiAgICAgIHZhciBrZXlDb3VudGVyID0gMDtcbiAgICAgIHZhciBjb250ZXh0cyA9IHt9O1xuICAgICAgdmFyIFdheXBvaW50ID0gd2luZG93LldheXBvaW50O1xuICAgICAgdmFyIG9sZFdpbmRvd0xvYWQgPSB3aW5kb3cub25sb2FkO1xuXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvY29udGV4dCAqL1xuICAgICAgZnVuY3Rpb24gQ29udGV4dChlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuQWRhcHRlciA9IFdheXBvaW50LkFkYXB0ZXI7XG4gICAgICAgIHRoaXMuYWRhcHRlciA9IG5ldyB0aGlzLkFkYXB0ZXIoZWxlbWVudCk7XG4gICAgICAgIHRoaXMua2V5ID0gJ3dheXBvaW50LWNvbnRleHQtJyArIGtleUNvdW50ZXI7XG4gICAgICAgIHRoaXMuZGlkU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZGlkUmVzaXplID0gZmFsc2U7XG4gICAgICAgIHRoaXMub2xkU2Nyb2xsID0ge1xuICAgICAgICAgIHg6IHRoaXMuYWRhcHRlci5zY3JvbGxMZWZ0KCksXG4gICAgICAgICAgeTogdGhpcy5hZGFwdGVyLnNjcm9sbFRvcCgpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMud2F5cG9pbnRzID0ge1xuICAgICAgICAgIHZlcnRpY2FsOiB7fSxcbiAgICAgICAgICBob3Jpem9udGFsOiB7fVxuICAgICAgICB9O1xuXG4gICAgICAgIGVsZW1lbnQud2F5cG9pbnRDb250ZXh0S2V5ID0gdGhpcy5rZXk7XG4gICAgICAgIGNvbnRleHRzW2VsZW1lbnQud2F5cG9pbnRDb250ZXh0S2V5XSA9IHRoaXM7XG4gICAgICAgIGtleUNvdW50ZXIgKz0gMTtcblxuICAgICAgICB0aGlzLmNyZWF0ZVRocm90dGxlZFNjcm9sbEhhbmRsZXIoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVUaHJvdHRsZWRSZXNpemVIYW5kbGVyKCk7XG4gICAgICB9XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh3YXlwb2ludCkge1xuICAgICAgICB2YXIgYXhpcyA9IHdheXBvaW50Lm9wdGlvbnMuaG9yaXpvbnRhbCA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XG4gICAgICAgIHRoaXMud2F5cG9pbnRzW2F4aXNdW3dheXBvaW50LmtleV0gPSB3YXlwb2ludDtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5jaGVja0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaG9yaXpvbnRhbEVtcHR5ID0gdGhpcy5BZGFwdGVyLmlzRW1wdHlPYmplY3QodGhpcy53YXlwb2ludHMuaG9yaXpvbnRhbCk7XG4gICAgICAgIHZhciB2ZXJ0aWNhbEVtcHR5ID0gdGhpcy5BZGFwdGVyLmlzRW1wdHlPYmplY3QodGhpcy53YXlwb2ludHMudmVydGljYWwpO1xuICAgICAgICBpZiAoaG9yaXpvbnRhbEVtcHR5ICYmIHZlcnRpY2FsRW1wdHkpIHtcbiAgICAgICAgICB0aGlzLmFkYXB0ZXIub2ZmKCcud2F5cG9pbnRzJyk7XG4gICAgICAgICAgZGVsZXRlIGNvbnRleHRzW3RoaXMua2V5XTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlVGhyb3R0bGVkUmVzaXplSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIGZ1bmN0aW9uIHJlc2l6ZUhhbmRsZXIoKSB7XG4gICAgICAgICAgc2VsZi5oYW5kbGVSZXNpemUoKTtcbiAgICAgICAgICBzZWxmLmRpZFJlc2l6ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hZGFwdGVyLm9uKCdyZXNpemUud2F5cG9pbnRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICghc2VsZi5kaWRSZXNpemUpIHtcbiAgICAgICAgICAgIHNlbGYuZGlkUmVzaXplID0gdHJ1ZTtcbiAgICAgICAgICAgIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZShyZXNpemVIYW5kbGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlVGhyb3R0bGVkU2Nyb2xsSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBzY3JvbGxIYW5kbGVyKCkge1xuICAgICAgICAgIHNlbGYuaGFuZGxlU2Nyb2xsKCk7XG4gICAgICAgICAgc2VsZi5kaWRTY3JvbGwgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYWRhcHRlci5vbignc2Nyb2xsLndheXBvaW50cycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoIXNlbGYuZGlkU2Nyb2xsIHx8IFdheXBvaW50LmlzVG91Y2gpIHtcbiAgICAgICAgICAgIHNlbGYuZGlkU2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgICAgIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZShzY3JvbGxIYW5kbGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuaGFuZGxlUmVzaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBXYXlwb2ludC5Db250ZXh0LnJlZnJlc2hBbGwoKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmhhbmRsZVNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRyaWdnZXJlZEdyb3VwcyA9IHt9O1xuICAgICAgICB2YXIgYXhlcyA9IHtcbiAgICAgICAgICBob3Jpem9udGFsOiB7XG4gICAgICAgICAgICBuZXdTY3JvbGw6IHRoaXMuYWRhcHRlci5zY3JvbGxMZWZ0KCksXG4gICAgICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLngsXG4gICAgICAgICAgICBmb3J3YXJkOiAncmlnaHQnLFxuICAgICAgICAgICAgYmFja3dhcmQ6ICdsZWZ0J1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdmVydGljYWw6IHtcbiAgICAgICAgICAgIG5ld1Njcm9sbDogdGhpcy5hZGFwdGVyLnNjcm9sbFRvcCgpLFxuICAgICAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC55LFxuICAgICAgICAgICAgZm9yd2FyZDogJ2Rvd24nLFxuICAgICAgICAgICAgYmFja3dhcmQ6ICd1cCdcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgYXhpc0tleSBpbiBheGVzKSB7XG4gICAgICAgICAgdmFyIGF4aXMgPSBheGVzW2F4aXNLZXldO1xuICAgICAgICAgIHZhciBpc0ZvcndhcmQgPSBheGlzLm5ld1Njcm9sbCA+IGF4aXMub2xkU2Nyb2xsO1xuICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSBpc0ZvcndhcmQgPyBheGlzLmZvcndhcmQgOiBheGlzLmJhY2t3YXJkO1xuXG4gICAgICAgICAgZm9yICh2YXIgd2F5cG9pbnRLZXkgaW4gdGhpcy53YXlwb2ludHNbYXhpc0tleV0pIHtcbiAgICAgICAgICAgIHZhciB3YXlwb2ludCA9IHRoaXMud2F5cG9pbnRzW2F4aXNLZXldW3dheXBvaW50S2V5XTtcbiAgICAgICAgICAgIHZhciB3YXNCZWZvcmVUcmlnZ2VyUG9pbnQgPSBheGlzLm9sZFNjcm9sbCA8IHdheXBvaW50LnRyaWdnZXJQb2ludDtcbiAgICAgICAgICAgIHZhciBub3dBZnRlclRyaWdnZXJQb2ludCA9IGF4aXMubmV3U2Nyb2xsID49IHdheXBvaW50LnRyaWdnZXJQb2ludDtcbiAgICAgICAgICAgIHZhciBjcm9zc2VkRm9yd2FyZCA9IHdhc0JlZm9yZVRyaWdnZXJQb2ludCAmJiBub3dBZnRlclRyaWdnZXJQb2ludDtcbiAgICAgICAgICAgIHZhciBjcm9zc2VkQmFja3dhcmQgPSAhd2FzQmVmb3JlVHJpZ2dlclBvaW50ICYmICFub3dBZnRlclRyaWdnZXJQb2ludDtcbiAgICAgICAgICAgIGlmIChjcm9zc2VkRm9yd2FyZCB8fCBjcm9zc2VkQmFja3dhcmQpIHtcbiAgICAgICAgICAgICAgd2F5cG9pbnQucXVldWVUcmlnZ2VyKGRpcmVjdGlvbik7XG4gICAgICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBncm91cEtleSBpbiB0cmlnZ2VyZWRHcm91cHMpIHtcbiAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbZ3JvdXBLZXldLmZsdXNoVHJpZ2dlcnMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub2xkU2Nyb2xsID0ge1xuICAgICAgICAgIHg6IGF4ZXMuaG9yaXpvbnRhbC5uZXdTY3JvbGwsXG4gICAgICAgICAgeTogYXhlcy52ZXJ0aWNhbC5uZXdTY3JvbGxcbiAgICAgICAgfTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmlubmVySGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvKmVzbGludC1kaXNhYmxlIGVxZXFlcSAqL1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgICAgICByZXR1cm4gV2F5cG9pbnQudmlld3BvcnRIZWlnaHQoKTtcbiAgICAgICAgfVxuICAgICAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuaW5uZXJIZWlnaHQoKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICh3YXlwb2ludCkge1xuICAgICAgICBkZWxldGUgdGhpcy53YXlwb2ludHNbd2F5cG9pbnQuYXhpc11bd2F5cG9pbnQua2V5XTtcbiAgICAgICAgdGhpcy5jaGVja0VtcHR5KCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5pbm5lcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvKmVzbGludC1kaXNhYmxlIGVxZXFlcSAqL1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgICAgICByZXR1cm4gV2F5cG9pbnQudmlld3BvcnRXaWR0aCgpO1xuICAgICAgICB9XG4gICAgICAgIC8qZXNsaW50LWVuYWJsZSBlcWVxZXEgKi9cbiAgICAgICAgcmV0dXJuIHRoaXMuYWRhcHRlci5pbm5lcldpZHRoKCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0LWRlc3Ryb3kgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhbGxXYXlwb2ludHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgYXhpcyBpbiB0aGlzLndheXBvaW50cykge1xuICAgICAgICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIHRoaXMud2F5cG9pbnRzW2F4aXNdKSB7XG4gICAgICAgICAgICBhbGxXYXlwb2ludHMucHVzaCh0aGlzLndheXBvaW50c1theGlzXVt3YXlwb2ludEtleV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gYWxsV2F5cG9pbnRzLmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgYWxsV2F5cG9pbnRzW2ldLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvY29udGV4dC1yZWZyZXNoICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvKmVzbGludC1kaXNhYmxlIGVxZXFlcSAqL1xuICAgICAgICB2YXIgaXNXaW5kb3cgPSB0aGlzLmVsZW1lbnQgPT0gdGhpcy5lbGVtZW50LndpbmRvdztcbiAgICAgICAgLyplc2xpbnQtZW5hYmxlIGVxZXFlcSAqL1xuICAgICAgICB2YXIgY29udGV4dE9mZnNldCA9IGlzV2luZG93ID8gdW5kZWZpbmVkIDogdGhpcy5hZGFwdGVyLm9mZnNldCgpO1xuICAgICAgICB2YXIgdHJpZ2dlcmVkR3JvdXBzID0ge307XG4gICAgICAgIHZhciBheGVzO1xuXG4gICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsKCk7XG4gICAgICAgIGF4ZXMgPSB7XG4gICAgICAgICAgaG9yaXpvbnRhbDoge1xuICAgICAgICAgICAgY29udGV4dE9mZnNldDogaXNXaW5kb3cgPyAwIDogY29udGV4dE9mZnNldC5sZWZ0LFxuICAgICAgICAgICAgY29udGV4dFNjcm9sbDogaXNXaW5kb3cgPyAwIDogdGhpcy5vbGRTY3JvbGwueCxcbiAgICAgICAgICAgIGNvbnRleHREaW1lbnNpb246IHRoaXMuaW5uZXJXaWR0aCgpLFxuICAgICAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC54LFxuICAgICAgICAgICAgZm9yd2FyZDogJ3JpZ2h0JyxcbiAgICAgICAgICAgIGJhY2t3YXJkOiAnbGVmdCcsXG4gICAgICAgICAgICBvZmZzZXRQcm9wOiAnbGVmdCdcbiAgICAgICAgICB9LFxuICAgICAgICAgIHZlcnRpY2FsOiB7XG4gICAgICAgICAgICBjb250ZXh0T2Zmc2V0OiBpc1dpbmRvdyA/IDAgOiBjb250ZXh0T2Zmc2V0LnRvcCxcbiAgICAgICAgICAgIGNvbnRleHRTY3JvbGw6IGlzV2luZG93ID8gMCA6IHRoaXMub2xkU2Nyb2xsLnksXG4gICAgICAgICAgICBjb250ZXh0RGltZW5zaW9uOiB0aGlzLmlubmVySGVpZ2h0KCksXG4gICAgICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLnksXG4gICAgICAgICAgICBmb3J3YXJkOiAnZG93bicsXG4gICAgICAgICAgICBiYWNrd2FyZDogJ3VwJyxcbiAgICAgICAgICAgIG9mZnNldFByb3A6ICd0b3AnXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAodmFyIGF4aXNLZXkgaW4gYXhlcykge1xuICAgICAgICAgIHZhciBheGlzID0gYXhlc1theGlzS2V5XTtcbiAgICAgICAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiB0aGlzLndheXBvaW50c1theGlzS2V5XSkge1xuICAgICAgICAgICAgdmFyIHdheXBvaW50ID0gdGhpcy53YXlwb2ludHNbYXhpc0tleV1bd2F5cG9pbnRLZXldO1xuICAgICAgICAgICAgdmFyIGFkanVzdG1lbnQgPSB3YXlwb2ludC5vcHRpb25zLm9mZnNldDtcbiAgICAgICAgICAgIHZhciBvbGRUcmlnZ2VyUG9pbnQgPSB3YXlwb2ludC50cmlnZ2VyUG9pbnQ7XG4gICAgICAgICAgICB2YXIgZWxlbWVudE9mZnNldCA9IDA7XG4gICAgICAgICAgICB2YXIgZnJlc2hXYXlwb2ludCA9IG9sZFRyaWdnZXJQb2ludCA9PSBudWxsO1xuICAgICAgICAgICAgdmFyIGNvbnRleHRNb2RpZmllciwgd2FzQmVmb3JlU2Nyb2xsLCBub3dBZnRlclNjcm9sbDtcbiAgICAgICAgICAgIHZhciB0cmlnZ2VyZWRCYWNrd2FyZCwgdHJpZ2dlcmVkRm9yd2FyZDtcblxuICAgICAgICAgICAgaWYgKHdheXBvaW50LmVsZW1lbnQgIT09IHdheXBvaW50LmVsZW1lbnQud2luZG93KSB7XG4gICAgICAgICAgICAgIGVsZW1lbnRPZmZzZXQgPSB3YXlwb2ludC5hZGFwdGVyLm9mZnNldCgpW2F4aXMub2Zmc2V0UHJvcF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgYWRqdXN0bWVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICBhZGp1c3RtZW50ID0gYWRqdXN0bWVudC5hcHBseSh3YXlwb2ludCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhZGp1c3RtZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBhZGp1c3RtZW50ID0gcGFyc2VGbG9hdChhZGp1c3RtZW50KTtcbiAgICAgICAgICAgICAgaWYgKHdheXBvaW50Lm9wdGlvbnMub2Zmc2V0LmluZGV4T2YoJyUnKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudCA9IE1hdGguY2VpbChheGlzLmNvbnRleHREaW1lbnNpb24gKiBhZGp1c3RtZW50IC8gMTAwKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb250ZXh0TW9kaWZpZXIgPSBheGlzLmNvbnRleHRTY3JvbGwgLSBheGlzLmNvbnRleHRPZmZzZXQ7XG4gICAgICAgICAgICB3YXlwb2ludC50cmlnZ2VyUG9pbnQgPSBlbGVtZW50T2Zmc2V0ICsgY29udGV4dE1vZGlmaWVyIC0gYWRqdXN0bWVudDtcbiAgICAgICAgICAgIHdhc0JlZm9yZVNjcm9sbCA9IG9sZFRyaWdnZXJQb2ludCA8IGF4aXMub2xkU2Nyb2xsO1xuICAgICAgICAgICAgbm93QWZ0ZXJTY3JvbGwgPSB3YXlwb2ludC50cmlnZ2VyUG9pbnQgPj0gYXhpcy5vbGRTY3JvbGw7XG4gICAgICAgICAgICB0cmlnZ2VyZWRCYWNrd2FyZCA9IHdhc0JlZm9yZVNjcm9sbCAmJiBub3dBZnRlclNjcm9sbDtcbiAgICAgICAgICAgIHRyaWdnZXJlZEZvcndhcmQgPSAhd2FzQmVmb3JlU2Nyb2xsICYmICFub3dBZnRlclNjcm9sbDtcblxuICAgICAgICAgICAgaWYgKCFmcmVzaFdheXBvaW50ICYmIHRyaWdnZXJlZEJhY2t3YXJkKSB7XG4gICAgICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihheGlzLmJhY2t3YXJkKTtcbiAgICAgICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghZnJlc2hXYXlwb2ludCAmJiB0cmlnZ2VyZWRGb3J3YXJkKSB7XG4gICAgICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihheGlzLmZvcndhcmQpO1xuICAgICAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbd2F5cG9pbnQuZ3JvdXAuaWRdID0gd2F5cG9pbnQuZ3JvdXA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZyZXNoV2F5cG9pbnQgJiYgYXhpcy5vbGRTY3JvbGwgPj0gd2F5cG9pbnQudHJpZ2dlclBvaW50KSB7XG4gICAgICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihheGlzLmZvcndhcmQpO1xuICAgICAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbd2F5cG9pbnQuZ3JvdXAuaWRdID0gd2F5cG9pbnQuZ3JvdXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgV2F5cG9pbnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBmb3IgKHZhciBncm91cEtleSBpbiB0cmlnZ2VyZWRHcm91cHMpIHtcbiAgICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1tncm91cEtleV0uZmx1c2hUcmlnZ2VycygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LmZpbmRPckNyZWF0ZUJ5RWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBDb250ZXh0LmZpbmRCeUVsZW1lbnQoZWxlbWVudCkgfHwgbmV3IENvbnRleHQoZWxlbWVudCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnJlZnJlc2hBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGNvbnRleHRJZCBpbiBjb250ZXh0cykge1xuICAgICAgICAgIGNvbnRleHRzW2NvbnRleHRJZF0ucmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0LWZpbmQtYnktZWxlbWVudCAqL1xuICAgICAgQ29udGV4dC5maW5kQnlFbGVtZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGNvbnRleHRzW2VsZW1lbnQud2F5cG9pbnRDb250ZXh0S2V5XTtcbiAgICAgIH07XG5cbiAgICAgIHdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChvbGRXaW5kb3dMb2FkKSB7XG4gICAgICAgICAgb2xkV2luZG93TG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIENvbnRleHQucmVmcmVzaEFsbCgpO1xuICAgICAgfTtcblxuICAgICAgV2F5cG9pbnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciByZXF1ZXN0Rm4gPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCByZXF1ZXN0QW5pbWF0aW9uRnJhbWVTaGltO1xuICAgICAgICByZXF1ZXN0Rm4uY2FsbCh3aW5kb3csIGNhbGxiYWNrKTtcbiAgICAgIH07XG4gICAgICBXYXlwb2ludC5Db250ZXh0ID0gQ29udGV4dDtcbiAgICB9KSgpOyhmdW5jdGlvbiAoKSB7XG4gICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgIGZ1bmN0aW9uIGJ5VHJpZ2dlclBvaW50KGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEudHJpZ2dlclBvaW50IC0gYi50cmlnZ2VyUG9pbnQ7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGJ5UmV2ZXJzZVRyaWdnZXJQb2ludChhLCBiKSB7XG4gICAgICAgIHJldHVybiBiLnRyaWdnZXJQb2ludCAtIGEudHJpZ2dlclBvaW50O1xuICAgICAgfVxuXG4gICAgICB2YXIgZ3JvdXBzID0ge1xuICAgICAgICB2ZXJ0aWNhbDoge30sXG4gICAgICAgIGhvcml6b250YWw6IHt9XG4gICAgICB9O1xuICAgICAgdmFyIFdheXBvaW50ID0gd2luZG93LldheXBvaW50O1xuXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZ3JvdXAgKi9cbiAgICAgIGZ1bmN0aW9uIEdyb3VwKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB0aGlzLmF4aXMgPSBvcHRpb25zLmF4aXM7XG4gICAgICAgIHRoaXMuaWQgPSB0aGlzLm5hbWUgKyAnLScgKyB0aGlzLmF4aXM7XG4gICAgICAgIHRoaXMud2F5cG9pbnRzID0gW107XG4gICAgICAgIHRoaXMuY2xlYXJUcmlnZ2VyUXVldWVzKCk7XG4gICAgICAgIGdyb3Vwc1t0aGlzLmF4aXNdW3RoaXMubmFtZV0gPSB0aGlzO1xuICAgICAgfVxuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHdheXBvaW50KSB7XG4gICAgICAgIHRoaXMud2F5cG9pbnRzLnB1c2god2F5cG9pbnQpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLmNsZWFyVHJpZ2dlclF1ZXVlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyUXVldWVzID0ge1xuICAgICAgICAgIHVwOiBbXSxcbiAgICAgICAgICBkb3duOiBbXSxcbiAgICAgICAgICBsZWZ0OiBbXSxcbiAgICAgICAgICByaWdodDogW11cbiAgICAgICAgfTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5mbHVzaFRyaWdnZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBkaXJlY3Rpb24gaW4gdGhpcy50cmlnZ2VyUXVldWVzKSB7XG4gICAgICAgICAgdmFyIHdheXBvaW50cyA9IHRoaXMudHJpZ2dlclF1ZXVlc1tkaXJlY3Rpb25dO1xuICAgICAgICAgIHZhciByZXZlcnNlID0gZGlyZWN0aW9uID09PSAndXAnIHx8IGRpcmVjdGlvbiA9PT0gJ2xlZnQnO1xuICAgICAgICAgIHdheXBvaW50cy5zb3J0KHJldmVyc2UgPyBieVJldmVyc2VUcmlnZ2VyUG9pbnQgOiBieVRyaWdnZXJQb2ludCk7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IHdheXBvaW50cy5sZW5ndGg7IGkgPCBlbmQ7IGkgKz0gMSkge1xuICAgICAgICAgICAgdmFyIHdheXBvaW50ID0gd2F5cG9pbnRzW2ldO1xuICAgICAgICAgICAgaWYgKHdheXBvaW50Lm9wdGlvbnMuY29udGludW91cyB8fCBpID09PSB3YXlwb2ludHMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICB3YXlwb2ludC50cmlnZ2VyKFtkaXJlY3Rpb25dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbGVhclRyaWdnZXJRdWV1ZXMoKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHdheXBvaW50KSB7XG4gICAgICAgIHRoaXMud2F5cG9pbnRzLnNvcnQoYnlUcmlnZ2VyUG9pbnQpO1xuICAgICAgICB2YXIgaW5kZXggPSBXYXlwb2ludC5BZGFwdGVyLmluQXJyYXkod2F5cG9pbnQsIHRoaXMud2F5cG9pbnRzKTtcbiAgICAgICAgdmFyIGlzTGFzdCA9IGluZGV4ID09PSB0aGlzLndheXBvaW50cy5sZW5ndGggLSAxO1xuICAgICAgICByZXR1cm4gaXNMYXN0ID8gbnVsbCA6IHRoaXMud2F5cG9pbnRzW2luZGV4ICsgMV07XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5wcm90b3R5cGUucHJldmlvdXMgPSBmdW5jdGlvbiAod2F5cG9pbnQpIHtcbiAgICAgICAgdGhpcy53YXlwb2ludHMuc29ydChieVRyaWdnZXJQb2ludCk7XG4gICAgICAgIHZhciBpbmRleCA9IFdheXBvaW50LkFkYXB0ZXIuaW5BcnJheSh3YXlwb2ludCwgdGhpcy53YXlwb2ludHMpO1xuICAgICAgICByZXR1cm4gaW5kZXggPyB0aGlzLndheXBvaW50c1tpbmRleCAtIDFdIDogbnVsbDtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5xdWV1ZVRyaWdnZXIgPSBmdW5jdGlvbiAod2F5cG9pbnQsIGRpcmVjdGlvbikge1xuICAgICAgICB0aGlzLnRyaWdnZXJRdWV1ZXNbZGlyZWN0aW9uXS5wdXNoKHdheXBvaW50KTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAod2F5cG9pbnQpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gV2F5cG9pbnQuQWRhcHRlci5pbkFycmF5KHdheXBvaW50LCB0aGlzLndheXBvaW50cyk7XG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgdGhpcy53YXlwb2ludHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZmlyc3QgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5maXJzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud2F5cG9pbnRzWzBdO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvbGFzdCAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLmxhc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLndheXBvaW50c1t0aGlzLndheXBvaW50cy5sZW5ndGggLSAxXTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLmZpbmRPckNyZWF0ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBncm91cHNbb3B0aW9ucy5heGlzXVtvcHRpb25zLm5hbWVdIHx8IG5ldyBHcm91cChvcHRpb25zKTtcbiAgICAgIH07XG5cbiAgICAgIFdheXBvaW50Lkdyb3VwID0gR3JvdXA7XG4gICAgfSkoKTsoZnVuY3Rpb24gKCkge1xuICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICB2YXIgV2F5cG9pbnQgPSB3aW5kb3cuV2F5cG9pbnQ7XG5cbiAgICAgIGZ1bmN0aW9uIGlzV2luZG93KGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQgPT09IGVsZW1lbnQud2luZG93O1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRXaW5kb3coZWxlbWVudCkge1xuICAgICAgICBpZiAoaXNXaW5kb3coZWxlbWVudCkpIHtcbiAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWxlbWVudC5kZWZhdWx0VmlldztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gTm9GcmFtZXdvcmtBZGFwdGVyKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IHt9O1xuICAgICAgfVxuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLmlubmVySGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXNXaW4gPSBpc1dpbmRvdyh0aGlzLmVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gaXNXaW4gPyB0aGlzLmVsZW1lbnQuaW5uZXJIZWlnaHQgOiB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5pbm5lcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXNXaW4gPSBpc1dpbmRvdyh0aGlzLmVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gaXNXaW4gPyB0aGlzLmVsZW1lbnQuaW5uZXJXaWR0aCA6IHRoaXMuZWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCBsaXN0ZW5lcnMsIGhhbmRsZXIpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gbGlzdGVuZXJzLmxlbmd0aCAtIDE7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldO1xuICAgICAgICAgICAgaWYgKCFoYW5kbGVyIHx8IGhhbmRsZXIgPT09IGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGV2ZW50UGFydHMgPSBldmVudC5zcGxpdCgnLicpO1xuICAgICAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnRQYXJ0c1swXTtcbiAgICAgICAgdmFyIG5hbWVzcGFjZSA9IGV2ZW50UGFydHNbMV07XG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuXG4gICAgICAgIGlmIChuYW1lc3BhY2UgJiYgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdICYmIGV2ZW50VHlwZSkge1xuICAgICAgICAgIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV1bZXZlbnRUeXBlXSwgaGFuZGxlcik7XG4gICAgICAgICAgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW2V2ZW50VHlwZV0gPSBbXTtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudFR5cGUpIHtcbiAgICAgICAgICBmb3IgKHZhciBucyBpbiB0aGlzLmhhbmRsZXJzKSB7XG4gICAgICAgICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgdGhpcy5oYW5kbGVyc1tuc11bZXZlbnRUeXBlXSB8fCBbXSwgaGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzW25zXVtldmVudFR5cGVdID0gW107XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKG5hbWVzcGFjZSAmJiB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0pIHtcbiAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSkge1xuICAgICAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXVt0eXBlXSwgaGFuZGxlcik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSA9IHt9O1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBBZGFwdGVkIGZyb20galF1ZXJ5IDEueCBvZmZzZXQoKSAqL1xuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vZmZzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkb2N1bWVudEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgIHZhciB3aW4gPSBnZXRXaW5kb3codGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQpO1xuICAgICAgICB2YXIgcmVjdCA9IHtcbiAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgbGVmdDogMFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KSB7XG4gICAgICAgICAgcmVjdCA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdG9wOiByZWN0LnRvcCArIHdpbi5wYWdlWU9mZnNldCAtIGRvY3VtZW50RWxlbWVudC5jbGllbnRUb3AsXG4gICAgICAgICAgbGVmdDogcmVjdC5sZWZ0ICsgd2luLnBhZ2VYT2Zmc2V0IC0gZG9jdW1lbnRFbGVtZW50LmNsaWVudExlZnRcbiAgICAgICAgfTtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAoZXZlbnQsIGhhbmRsZXIpIHtcbiAgICAgICAgdmFyIGV2ZW50UGFydHMgPSBldmVudC5zcGxpdCgnLicpO1xuICAgICAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnRQYXJ0c1swXTtcbiAgICAgICAgdmFyIG5hbWVzcGFjZSA9IGV2ZW50UGFydHNbMV0gfHwgJ19fZGVmYXVsdCc7XG4gICAgICAgIHZhciBuc0hhbmRsZXJzID0gdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdID0gdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdIHx8IHt9O1xuICAgICAgICB2YXIgbnNUeXBlTGlzdCA9IG5zSGFuZGxlcnNbZXZlbnRUeXBlXSA9IG5zSGFuZGxlcnNbZXZlbnRUeXBlXSB8fCBbXTtcblxuICAgICAgICBuc1R5cGVMaXN0LnB1c2goaGFuZGxlcik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgaGFuZGxlcik7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm91dGVySGVpZ2h0ID0gZnVuY3Rpb24gKGluY2x1ZGVNYXJnaW4pIHtcbiAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaW5uZXJIZWlnaHQoKTtcbiAgICAgICAgdmFyIGNvbXB1dGVkU3R5bGU7XG5cbiAgICAgICAgaWYgKGluY2x1ZGVNYXJnaW4gJiYgIWlzV2luZG93KHRoaXMuZWxlbWVudCkpIHtcbiAgICAgICAgICBjb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtZW50KTtcbiAgICAgICAgICBoZWlnaHQgKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5Ub3AsIDEwKTtcbiAgICAgICAgICBoZWlnaHQgKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5Cb3R0b20sIDEwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBoZWlnaHQ7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm91dGVyV2lkdGggPSBmdW5jdGlvbiAoaW5jbHVkZU1hcmdpbikge1xuICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmlubmVyV2lkdGgoKTtcbiAgICAgICAgdmFyIGNvbXB1dGVkU3R5bGU7XG5cbiAgICAgICAgaWYgKGluY2x1ZGVNYXJnaW4gJiYgIWlzV2luZG93KHRoaXMuZWxlbWVudCkpIHtcbiAgICAgICAgICBjb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtZW50KTtcbiAgICAgICAgICB3aWR0aCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpbkxlZnQsIDEwKTtcbiAgICAgICAgICB3aWR0aCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpblJpZ2h0LCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gd2lkdGg7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLnNjcm9sbExlZnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB3aW4gPSBnZXRXaW5kb3codGhpcy5lbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIHdpbiA/IHdpbi5wYWdlWE9mZnNldCA6IHRoaXMuZWxlbWVudC5zY3JvbGxMZWZ0O1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5zY3JvbGxUb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB3aW4gPSBnZXRXaW5kb3codGhpcy5lbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIHdpbiA/IHdpbi5wYWdlWU9mZnNldCA6IHRoaXMuZWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIuZXh0ZW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cbiAgICAgICAgZnVuY3Rpb24gbWVyZ2UodGFyZ2V0LCBvYmopIHtcbiAgICAgICAgICBpZiAoKHR5cGVvZiB0YXJnZXQgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZih0YXJnZXQpKSA9PT0gJ29iamVjdCcgJiYgKHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihvYmopKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBvYmpba2V5XTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMSwgZW5kID0gYXJncy5sZW5ndGg7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgIG1lcmdlKGFyZ3NbMF0sIGFyZ3NbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcmdzWzBdO1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLmluQXJyYXkgPSBmdW5jdGlvbiAoZWxlbWVudCwgYXJyYXksIGkpIHtcbiAgICAgICAgcmV0dXJuIGFycmF5ID09IG51bGwgPyAtMSA6IGFycmF5LmluZGV4T2YoZWxlbWVudCwgaSk7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIuaXNFbXB0eU9iamVjdCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgLyogZXNsaW50IG5vLXVudXNlZC12YXJzOiAwICovXG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gb2JqKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcblxuICAgICAgV2F5cG9pbnQuYWRhcHRlcnMucHVzaCh7XG4gICAgICAgIG5hbWU6ICdub2ZyYW1ld29yaycsXG4gICAgICAgIEFkYXB0ZXI6IE5vRnJhbWV3b3JrQWRhcHRlclxuICAgICAgfSk7XG4gICAgICBXYXlwb2ludC5BZGFwdGVyID0gTm9GcmFtZXdvcmtBZGFwdGVyO1xuICAgIH0pKCk7XG4gIH0sIHt9XSB9LCB7fSwgWzFdKTsiLCIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCdcblxucmVxdWlyZSgnLi4vbm9kZV9tb2R1bGVzL3dheXBvaW50cy9saWIvbm9mcmFtZXdvcmsud2F5cG9pbnRzJyk7XG5cbmxldCBkb2NTdHlsZSA9IGRvY3VtZW50LmJvZHkuc3R5bGU7XG5sZXQgYmdQYXRoID0gZG9jdW1lbnQubG9jYXRpb24gKyAnaW1hZ2VzL2JnLyc7XG5sZXQgaW1nRXh0ID0gJy5wbmcnO1xubGV0IGJncyA9IFsnV2FsbFBhcGVyMicsICdXYWxsUGFwZXIyX3RvbmUnLCAnV2FsbFBhcGVyMi41JywgJ1dhbGxQYXBlcjMnLCAnV2FsbFBhcGVyMy41JywgJ1dhbGxQYXBlcjQnLCAnV2FsbFBhcGVyNC41JywgJ1dhbGxQYXBlcjUuNScsICdXYWxsUGFwZXI1LjVfdG9uZScsJ1dhbGxQYXBlcjYnLCAnV2FsbFBhcGVyNi41JywgJ1dhbGxQYXBlcjcuNScsICdXYWxsUGFwZXI3LjVfdG9uZSddO1xudmFyIGJnSW1hZ2VzTG9hZGVkID0gZmFsc2U7XG5cbm5ldyBXYXlwb2ludCh7XG4gICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dheXBvaW50SGVhZGVyJyksXG4gICAgaGFuZGxlcjogZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdTY3JvbGxlZCB0byB3YXlwb2ludCAxJylcbiAgICB9XG59KTtcblxuLy8gVXRpbGl0eVxuLy8gc2V0dXAgd2F5cG9pbnRzXG4vLyBjb25zdCBkZWZpbmVXYXlwb2ludHMgPSBmdW5jdGlvbiAoKSB7XG4vLyAgICAgd2luZG93LndheXBvaW50cyA9IFtdO1xuLy8gICAgIGxldCB3YXlwb2ludFVuaXQgPSBNYXRoLmZsb29yKChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3JhcHBlcicpLmNsaWVudEhlaWdodCAvIGJncy5sZW5ndGgpKTtcbi8vICAgICBiZ3MuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCwgaW5kZXgpIHtcbi8vICAgICAgICAgY29uc29sZS5sb2cod2F5cG9pbnRVbml0ICogKGluZGV4ICsgMSkpO1xuLy8gICAgICAgICB3aW5kb3cud2F5cG9pbnRzW2luZGV4XSA9IG5ldyBXYXlwb2ludCh7XG4vLyAgICAgICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2F5cG9pbnRIZWFkZXInKSxcbi8vICAgICAgICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgbG9hZGluZyAke2Jnc1tpbmRleF19IGZyb20gbG9vcCBmdW5jdGlvbmApOyAvL3Rlc3Rcbi8vICAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbi8vICAgICAgICAgICAgIH0sXG4vLyAgICAgICAgICAgICBvZmZzZXQ6IHdheXBvaW50VW5pdCAqIChpbmRleCArIDEpICogLTFcbi8vICAgICAgICAgfSlcbi8vICAgICB9KVxuLy8gfSgpO1xuLy8gcHJlbG9hZCBpbWFnZXNcbmlmIChiZ0ltYWdlc0xvYWRlZCAhPT0gdHJ1ZSkge1xuICAgIGJncy5mb3JFYWNoKGZ1bmN0aW9uIChiZykge1xuICAgICAgICBuZXcgSW1hZ2UoKS5zcmMgPSBiZ1BhdGggKyBiZyArIGltZ0V4dDtcbiAgICAgICAgLy8gY2FjaGVzIGltYWdlcywgYXZvaWRpbmcgd2hpdGUgZmxhc2ggYmV0d2VlbiBiYWNrZ3JvdW5kIHJlcGxhY2VtZW50c1xuICAgIH0pO1xuICAgIGJnSW1hZ2VzTG9hZGVkID0gdHJ1ZTtcbn1cbi8vIGxvYWQgYmcgaW1hZ2VcbmNvbnN0IGxvYWRCZyA9IGZ1bmN0aW9uIChiZykge1xuICAgIGRvY1N0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHtiZ1BhdGh9JHtiZ3NbYmddfSR7aW1nRXh0fSlgO1xuICAgIGNvbnNvbGUubG9nKGBsb2FkaW5nICR7YmdQYXRofSR7YmdzW2JnXX0ke2ltZ0V4dH1gKVxufVxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIGJ1c2luZXNzIHNlbGVjdCBidXR0b25zXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xubGV0IGJ1c2luZXNzU2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJ1c2luZXNzLXR5cGUtc2VsZWN0Jyk7XG5BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChidXNpbmVzc1NlbGVjdCkuZm9yRWFjaChmdW5jdGlvbihlbCl7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coZWwpO1xuICAgICAgICAvLyBnZXQgdGhlIGFjdGl2ZSBtZW51IGl0ZW0gYW5kIHR1cm4gaXQgb2ZmXG4gICAgICAgIGxldCBjdXJyZW50QWN0aXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1c2luZXNzLXR5cGUtc2VsZWN0LmFjdGl2ZScpO1xuICAgICAgICBpZiAoY3VycmVudEFjdGl2ZSkge1xuICAgICAgICAgICAgY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0dXJuIG9uIHRoZSBuZXcgbWVudSBpdGVtXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgICAgIC8vIHNob3cgdGhlIG5hdlxuICAgICAgICBsZXQgbWVudXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGNyLW1lbnUnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZW51cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWVudXNbaV0uc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgfVxuICAgICAgICBmb2xkTWVudS5hY2NvcmRpb24oMCwgJ3RvcCcsIGZ1bmN0aW9uKGV2LCBvcmkpIHtcbiAgICAgICAgICAgIG9yaS5lbC5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldiwgb3JpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBjdXJyZW50VmlzaWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXNpbmVzcy1jb250YWluZXIudmlzaWJsZScpO1xuICAgICAgICBpZihjdXJyZW50VmlzaWJsZSkge1xuICAgICAgICAgICAgY3VycmVudFZpc2libGUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGN1cnJlbnRWaXNpYmxlLmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgc2VjdGlvblRvU2hvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2VsLmRhdGFzZXQuYnVzaW5lc3N9LWNvbnRhaW5lcmApO1xuICAgICAgICBjb25zb2xlLmxvZyhzZWN0aW9uVG9TaG93KTtcbiAgICAgICAgJChzZWN0aW9uVG9TaG93KS5mYWRlSW4oKTtcbiAgICAgICAgc2VjdGlvblRvU2hvdy5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG4gICAgICAgIGpRdWVyeSgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKHNlY3Rpb25Ub1Nob3cpLm9mZnNldCgpLnRvcFxuICAgICAgICB9LCAyMDAwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQoc2VjdGlvblRvU2hvdykuZmluZCgnaDMnKS5hZGRDbGFzcygnYW5pbWF0ZWQnKS5hZGRDbGFzcygncHVsc2UnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxvYWRCZyhNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMikgKyAwIClcbiAgICAgICAgLy9kZWZpbmVXYXlwb2ludHMoKTtcbiAgICB9KTtcbn0pO1xuLy8vLy8vLy8vLy9cbi8vIGhjciBtZW51XG4vLy8vLy8vLy8vL1xubGV0IGZvbGRNZW51ID0gbmV3IE9yaURvbWkoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhjci1tZW51JyksIHtcbiAgICBoUGFuZWxzOiAzLFxuICAgIHJpcHBsZTogMixcbiAgICBzaGFkaW5nOiAnaGFyZCcsXG4gICAgdG91Y2hFbmFibGVkOiBmYWxzZVxufSk7XG4vLyBsb2FkXG5mb2xkTWVudS5mb2xkVXAoJ3RvcCcpO1xuXG4vLyBjbGlja1xubGV0IGhjck1lbnVJdGVtTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5oY3ItbWVudS1pdGVtIGEnKTtcbkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGhjck1lbnVJdGVtTGluaykuZm9yRWFjaChmdW5jdGlvbihlbCl7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldikge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBnZXQgdGhlIGFjdGl2ZSBtZW51IGl0ZW0gYW5kIHR1cm4gaXQgb2ZmXG4gICAgICAgIGxldCBjdXJyZW50QWN0aXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhjci1tZW51LWl0ZW0gYS5hY3RpdmUnKTtcbiAgICAgICAgaWYgKGN1cnJlbnRBY3RpdmUpIHtcbiAgICAgICAgICAgIGN1cnJlbnRBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdHVybiBvbiB0aGUgbmV3IG1lbnUgaXRlbVxuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgLy8gZm9sZCB1cCBhbmQgc2hvdyBsaW5rIHRleHRcbiAgICAgICAgZm9sZE1lbnUucmV2ZWFsKDYwLCAnYm90dG9tJywgZnVuY3Rpb24oZXYsIG9yaSkge1xuICAgICAgICAgICAgLy9vcmkuZWwuY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXYsIG9yaSk7XG4gICAgICAgICAgICBvcmkubW9kaWZ5Q29udGVudChmdW5jdGlvbihlbCkge1xuICAgICAgICAgICAgICAgIGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjMDAwJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xufSx7XCIuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHNcIjoyfV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vKiFcbldheXBvaW50cyAtIDQuMC4wXG5Db3B5cmlnaHQgwqkgMjAxMS0yMDE1IENhbGViIFRyb3VnaHRvblxuTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaHR0cHM6Ly9naXRodWIuY29tL2ltYWtld2VidGhpbmdzL3dheXBvaW50cy9ibG9nL21hc3Rlci9saWNlbnNlcy50eHRcbiovXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0J1xuXG4gIHZhciBrZXlDb3VudGVyID0gMFxuICB2YXIgYWxsV2F5cG9pbnRzID0ge31cblxuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvd2F5cG9pbnQgKi9cbiAgZnVuY3Rpb24gV2F5cG9pbnQob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBvcHRpb25zIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpXG4gICAgfVxuICAgIGlmICghb3B0aW9ucy5lbGVtZW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGVsZW1lbnQgb3B0aW9uIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpXG4gICAgfVxuICAgIGlmICghb3B0aW9ucy5oYW5kbGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGhhbmRsZXIgb3B0aW9uIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpXG4gICAgfVxuXG4gICAgdGhpcy5rZXkgPSAnd2F5cG9pbnQtJyArIGtleUNvdW50ZXJcbiAgICB0aGlzLm9wdGlvbnMgPSBXYXlwb2ludC5BZGFwdGVyLmV4dGVuZCh7fSwgV2F5cG9pbnQuZGVmYXVsdHMsIG9wdGlvbnMpXG4gICAgdGhpcy5lbGVtZW50ID0gdGhpcy5vcHRpb25zLmVsZW1lbnRcbiAgICB0aGlzLmFkYXB0ZXIgPSBuZXcgV2F5cG9pbnQuQWRhcHRlcih0aGlzLmVsZW1lbnQpXG4gICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuaGFuZGxlclxuICAgIHRoaXMuYXhpcyA9IHRoaXMub3B0aW9ucy5ob3Jpem9udGFsID8gJ2hvcml6b250YWwnIDogJ3ZlcnRpY2FsJ1xuICAgIHRoaXMuZW5hYmxlZCA9IHRoaXMub3B0aW9ucy5lbmFibGVkXG4gICAgdGhpcy50cmlnZ2VyUG9pbnQgPSBudWxsXG4gICAgdGhpcy5ncm91cCA9IFdheXBvaW50Lkdyb3VwLmZpbmRPckNyZWF0ZSh7XG4gICAgICBuYW1lOiB0aGlzLm9wdGlvbnMuZ3JvdXAsXG4gICAgICBheGlzOiB0aGlzLmF4aXNcbiAgICB9KVxuICAgIHRoaXMuY29udGV4dCA9IFdheXBvaW50LkNvbnRleHQuZmluZE9yQ3JlYXRlQnlFbGVtZW50KHRoaXMub3B0aW9ucy5jb250ZXh0KVxuXG4gICAgaWYgKFdheXBvaW50Lm9mZnNldEFsaWFzZXNbdGhpcy5vcHRpb25zLm9mZnNldF0pIHtcbiAgICAgIHRoaXMub3B0aW9ucy5vZmZzZXQgPSBXYXlwb2ludC5vZmZzZXRBbGlhc2VzW3RoaXMub3B0aW9ucy5vZmZzZXRdXG4gICAgfVxuICAgIHRoaXMuZ3JvdXAuYWRkKHRoaXMpXG4gICAgdGhpcy5jb250ZXh0LmFkZCh0aGlzKVxuICAgIGFsbFdheXBvaW50c1t0aGlzLmtleV0gPSB0aGlzXG4gICAga2V5Q291bnRlciArPSAxXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIFdheXBvaW50LnByb3RvdHlwZS5xdWV1ZVRyaWdnZXIgPSBmdW5jdGlvbihkaXJlY3Rpb24pIHtcbiAgICB0aGlzLmdyb3VwLnF1ZXVlVHJpZ2dlcih0aGlzLCBkaXJlY3Rpb24pXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIFdheXBvaW50LnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24oYXJncykge1xuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHRoaXMuY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuY2FsbGJhY2suYXBwbHkodGhpcywgYXJncylcbiAgICB9XG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rlc3Ryb3kgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNvbnRleHQucmVtb3ZlKHRoaXMpXG4gICAgdGhpcy5ncm91cC5yZW1vdmUodGhpcylcbiAgICBkZWxldGUgYWxsV2F5cG9pbnRzW3RoaXMua2V5XVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kaXNhYmxlICovXG4gIFdheXBvaW50LnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2VcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9lbmFibGUgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuY29udGV4dC5yZWZyZXNoKClcbiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvbmV4dCAqL1xuICBXYXlwb2ludC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmdyb3VwLm5leHQodGhpcylcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvcHJldmlvdXMgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLnByZXZpb3VzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ3JvdXAucHJldmlvdXModGhpcylcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgV2F5cG9pbnQuaW52b2tlQWxsID0gZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgdmFyIGFsbFdheXBvaW50c0FycmF5ID0gW11cbiAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiBhbGxXYXlwb2ludHMpIHtcbiAgICAgIGFsbFdheXBvaW50c0FycmF5LnB1c2goYWxsV2F5cG9pbnRzW3dheXBvaW50S2V5XSlcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IGFsbFdheXBvaW50c0FycmF5Lmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICBhbGxXYXlwb2ludHNBcnJheVtpXVttZXRob2RdKClcbiAgICB9XG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rlc3Ryb3ktYWxsICovXG4gIFdheXBvaW50LmRlc3Ryb3lBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2Rlc3Ryb3knKVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kaXNhYmxlLWFsbCAqL1xuICBXYXlwb2ludC5kaXNhYmxlQWxsID0gZnVuY3Rpb24oKSB7XG4gICAgV2F5cG9pbnQuaW52b2tlQWxsKCdkaXNhYmxlJylcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZW5hYmxlLWFsbCAqL1xuICBXYXlwb2ludC5lbmFibGVBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2VuYWJsZScpXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3JlZnJlc2gtYWxsICovXG4gIFdheXBvaW50LnJlZnJlc2hBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5Db250ZXh0LnJlZnJlc2hBbGwoKVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS92aWV3cG9ydC1oZWlnaHQgKi9cbiAgV2F5cG9pbnQudmlld3BvcnRIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHRcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvdmlld3BvcnQtd2lkdGggKi9cbiAgV2F5cG9pbnQudmlld3BvcnRXaWR0aCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGhcbiAgfVxuXG4gIFdheXBvaW50LmFkYXB0ZXJzID0gW11cblxuICBXYXlwb2ludC5kZWZhdWx0cyA9IHtcbiAgICBjb250ZXh0OiB3aW5kb3csXG4gICAgY29udGludW91czogdHJ1ZSxcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIGdyb3VwOiAnZGVmYXVsdCcsXG4gICAgaG9yaXpvbnRhbDogZmFsc2UsXG4gICAgb2Zmc2V0OiAwXG4gIH1cblxuICBXYXlwb2ludC5vZmZzZXRBbGlhc2VzID0ge1xuICAgICdib3R0b20taW4tdmlldyc6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pbm5lckhlaWdodCgpIC0gdGhpcy5hZGFwdGVyLm91dGVySGVpZ2h0KClcbiAgICB9LFxuICAgICdyaWdodC1pbi12aWV3JzogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmlubmVyV2lkdGgoKSAtIHRoaXMuYWRhcHRlci5vdXRlcldpZHRoKClcbiAgICB9XG4gIH1cblxuICB3aW5kb3cuV2F5cG9pbnQgPSBXYXlwb2ludFxufSgpKVxuOyhmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnXG5cbiAgZnVuY3Rpb24gcmVxdWVzdEFuaW1hdGlvbkZyYW1lU2hpbShjYWxsYmFjaykge1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGNhbGxiYWNrLCAxMDAwIC8gNjApXG4gIH1cblxuICB2YXIga2V5Q291bnRlciA9IDBcbiAgdmFyIGNvbnRleHRzID0ge31cbiAgdmFyIFdheXBvaW50ID0gd2luZG93LldheXBvaW50XG4gIHZhciBvbGRXaW5kb3dMb2FkID0gd2luZG93Lm9ubG9hZFxuXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0ICovXG4gIGZ1bmN0aW9uIENvbnRleHQoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnRcbiAgICB0aGlzLkFkYXB0ZXIgPSBXYXlwb2ludC5BZGFwdGVyXG4gICAgdGhpcy5hZGFwdGVyID0gbmV3IHRoaXMuQWRhcHRlcihlbGVtZW50KVxuICAgIHRoaXMua2V5ID0gJ3dheXBvaW50LWNvbnRleHQtJyArIGtleUNvdW50ZXJcbiAgICB0aGlzLmRpZFNjcm9sbCA9IGZhbHNlXG4gICAgdGhpcy5kaWRSZXNpemUgPSBmYWxzZVxuICAgIHRoaXMub2xkU2Nyb2xsID0ge1xuICAgICAgeDogdGhpcy5hZGFwdGVyLnNjcm9sbExlZnQoKSxcbiAgICAgIHk6IHRoaXMuYWRhcHRlci5zY3JvbGxUb3AoKVxuICAgIH1cbiAgICB0aGlzLndheXBvaW50cyA9IHtcbiAgICAgIHZlcnRpY2FsOiB7fSxcbiAgICAgIGhvcml6b250YWw6IHt9XG4gICAgfVxuXG4gICAgZWxlbWVudC53YXlwb2ludENvbnRleHRLZXkgPSB0aGlzLmtleVxuICAgIGNvbnRleHRzW2VsZW1lbnQud2F5cG9pbnRDb250ZXh0S2V5XSA9IHRoaXNcbiAgICBrZXlDb3VudGVyICs9IDFcblxuICAgIHRoaXMuY3JlYXRlVGhyb3R0bGVkU2Nyb2xsSGFuZGxlcigpXG4gICAgdGhpcy5jcmVhdGVUaHJvdHRsZWRSZXNpemVIYW5kbGVyKClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24od2F5cG9pbnQpIHtcbiAgICB2YXIgYXhpcyA9IHdheXBvaW50Lm9wdGlvbnMuaG9yaXpvbnRhbCA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCdcbiAgICB0aGlzLndheXBvaW50c1theGlzXVt3YXlwb2ludC5rZXldID0gd2F5cG9pbnRcbiAgICB0aGlzLnJlZnJlc2goKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5jaGVja0VtcHR5ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGhvcml6b250YWxFbXB0eSA9IHRoaXMuQWRhcHRlci5pc0VtcHR5T2JqZWN0KHRoaXMud2F5cG9pbnRzLmhvcml6b250YWwpXG4gICAgdmFyIHZlcnRpY2FsRW1wdHkgPSB0aGlzLkFkYXB0ZXIuaXNFbXB0eU9iamVjdCh0aGlzLndheXBvaW50cy52ZXJ0aWNhbClcbiAgICBpZiAoaG9yaXpvbnRhbEVtcHR5ICYmIHZlcnRpY2FsRW1wdHkpIHtcbiAgICAgIHRoaXMuYWRhcHRlci5vZmYoJy53YXlwb2ludHMnKVxuICAgICAgZGVsZXRlIGNvbnRleHRzW3RoaXMua2V5XVxuICAgIH1cbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlVGhyb3R0bGVkUmVzaXplSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpc1xuXG4gICAgZnVuY3Rpb24gcmVzaXplSGFuZGxlcigpIHtcbiAgICAgIHNlbGYuaGFuZGxlUmVzaXplKClcbiAgICAgIHNlbGYuZGlkUmVzaXplID0gZmFsc2VcbiAgICB9XG5cbiAgICB0aGlzLmFkYXB0ZXIub24oJ3Jlc2l6ZS53YXlwb2ludHMnLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghc2VsZi5kaWRSZXNpemUpIHtcbiAgICAgICAgc2VsZi5kaWRSZXNpemUgPSB0cnVlXG4gICAgICAgIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZShyZXNpemVIYW5kbGVyKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLmNyZWF0ZVRocm90dGxlZFNjcm9sbEhhbmRsZXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXNcbiAgICBmdW5jdGlvbiBzY3JvbGxIYW5kbGVyKCkge1xuICAgICAgc2VsZi5oYW5kbGVTY3JvbGwoKVxuICAgICAgc2VsZi5kaWRTY3JvbGwgPSBmYWxzZVxuICAgIH1cblxuICAgIHRoaXMuYWRhcHRlci5vbignc2Nyb2xsLndheXBvaW50cycsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFzZWxmLmRpZFNjcm9sbCB8fCBXYXlwb2ludC5pc1RvdWNoKSB7XG4gICAgICAgIHNlbGYuZGlkU2Nyb2xsID0gdHJ1ZVxuICAgICAgICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsSGFuZGxlcilcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5oYW5kbGVSZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5Db250ZXh0LnJlZnJlc2hBbGwoKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdHJpZ2dlcmVkR3JvdXBzID0ge31cbiAgICB2YXIgYXhlcyA9IHtcbiAgICAgIGhvcml6b250YWw6IHtcbiAgICAgICAgbmV3U2Nyb2xsOiB0aGlzLmFkYXB0ZXIuc2Nyb2xsTGVmdCgpLFxuICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLngsXG4gICAgICAgIGZvcndhcmQ6ICdyaWdodCcsXG4gICAgICAgIGJhY2t3YXJkOiAnbGVmdCdcbiAgICAgIH0sXG4gICAgICB2ZXJ0aWNhbDoge1xuICAgICAgICBuZXdTY3JvbGw6IHRoaXMuYWRhcHRlci5zY3JvbGxUb3AoKSxcbiAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC55LFxuICAgICAgICBmb3J3YXJkOiAnZG93bicsXG4gICAgICAgIGJhY2t3YXJkOiAndXAnXG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgYXhpc0tleSBpbiBheGVzKSB7XG4gICAgICB2YXIgYXhpcyA9IGF4ZXNbYXhpc0tleV1cbiAgICAgIHZhciBpc0ZvcndhcmQgPSBheGlzLm5ld1Njcm9sbCA+IGF4aXMub2xkU2Nyb2xsXG4gICAgICB2YXIgZGlyZWN0aW9uID0gaXNGb3J3YXJkID8gYXhpcy5mb3J3YXJkIDogYXhpcy5iYWNrd2FyZFxuXG4gICAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiB0aGlzLndheXBvaW50c1theGlzS2V5XSkge1xuICAgICAgICB2YXIgd2F5cG9pbnQgPSB0aGlzLndheXBvaW50c1theGlzS2V5XVt3YXlwb2ludEtleV1cbiAgICAgICAgdmFyIHdhc0JlZm9yZVRyaWdnZXJQb2ludCA9IGF4aXMub2xkU2Nyb2xsIDwgd2F5cG9pbnQudHJpZ2dlclBvaW50XG4gICAgICAgIHZhciBub3dBZnRlclRyaWdnZXJQb2ludCA9IGF4aXMubmV3U2Nyb2xsID49IHdheXBvaW50LnRyaWdnZXJQb2ludFxuICAgICAgICB2YXIgY3Jvc3NlZEZvcndhcmQgPSB3YXNCZWZvcmVUcmlnZ2VyUG9pbnQgJiYgbm93QWZ0ZXJUcmlnZ2VyUG9pbnRcbiAgICAgICAgdmFyIGNyb3NzZWRCYWNrd2FyZCA9ICF3YXNCZWZvcmVUcmlnZ2VyUG9pbnQgJiYgIW5vd0FmdGVyVHJpZ2dlclBvaW50XG4gICAgICAgIGlmIChjcm9zc2VkRm9yd2FyZCB8fCBjcm9zc2VkQmFja3dhcmQpIHtcbiAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoZGlyZWN0aW9uKVxuICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgZ3JvdXBLZXkgaW4gdHJpZ2dlcmVkR3JvdXBzKSB7XG4gICAgICB0cmlnZ2VyZWRHcm91cHNbZ3JvdXBLZXldLmZsdXNoVHJpZ2dlcnMoKVxuICAgIH1cblxuICAgIHRoaXMub2xkU2Nyb2xsID0ge1xuICAgICAgeDogYXhlcy5ob3Jpem9udGFsLm5ld1Njcm9sbCxcbiAgICAgIHk6IGF4ZXMudmVydGljYWwubmV3U2Nyb2xsXG4gICAgfVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5pbm5lckhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgIC8qZXNsaW50LWRpc2FibGUgZXFlcWVxICovXG4gICAgaWYgKHRoaXMuZWxlbWVudCA9PSB0aGlzLmVsZW1lbnQud2luZG93KSB7XG4gICAgICByZXR1cm4gV2F5cG9pbnQudmlld3BvcnRIZWlnaHQoKVxuICAgIH1cbiAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5pbm5lckhlaWdodCgpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgZGVsZXRlIHRoaXMud2F5cG9pbnRzW3dheXBvaW50LmF4aXNdW3dheXBvaW50LmtleV1cbiAgICB0aGlzLmNoZWNrRW1wdHkoKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5pbm5lcldpZHRoID0gZnVuY3Rpb24oKSB7XG4gICAgLyplc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi9cbiAgICBpZiAodGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgIHJldHVybiBXYXlwb2ludC52aWV3cG9ydFdpZHRoKClcbiAgICB9XG4gICAgLyplc2xpbnQtZW5hYmxlIGVxZXFlcSAqL1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuaW5uZXJXaWR0aCgpXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQtZGVzdHJveSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGFsbFdheXBvaW50cyA9IFtdXG4gICAgZm9yICh2YXIgYXhpcyBpbiB0aGlzLndheXBvaW50cykge1xuICAgICAgZm9yICh2YXIgd2F5cG9pbnRLZXkgaW4gdGhpcy53YXlwb2ludHNbYXhpc10pIHtcbiAgICAgICAgYWxsV2F5cG9pbnRzLnB1c2godGhpcy53YXlwb2ludHNbYXhpc11bd2F5cG9pbnRLZXldKVxuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gYWxsV2F5cG9pbnRzLmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICBhbGxXYXlwb2ludHNbaV0uZGVzdHJveSgpXG4gICAgfVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0LXJlZnJlc2ggKi9cbiAgQ29udGV4dC5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uKCkge1xuICAgIC8qZXNsaW50LWRpc2FibGUgZXFlcWVxICovXG4gICAgdmFyIGlzV2luZG93ID0gdGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3dcbiAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgdmFyIGNvbnRleHRPZmZzZXQgPSBpc1dpbmRvdyA/IHVuZGVmaW5lZCA6IHRoaXMuYWRhcHRlci5vZmZzZXQoKVxuICAgIHZhciB0cmlnZ2VyZWRHcm91cHMgPSB7fVxuICAgIHZhciBheGVzXG5cbiAgICB0aGlzLmhhbmRsZVNjcm9sbCgpXG4gICAgYXhlcyA9IHtcbiAgICAgIGhvcml6b250YWw6IHtcbiAgICAgICAgY29udGV4dE9mZnNldDogaXNXaW5kb3cgPyAwIDogY29udGV4dE9mZnNldC5sZWZ0LFxuICAgICAgICBjb250ZXh0U2Nyb2xsOiBpc1dpbmRvdyA/IDAgOiB0aGlzLm9sZFNjcm9sbC54LFxuICAgICAgICBjb250ZXh0RGltZW5zaW9uOiB0aGlzLmlubmVyV2lkdGgoKSxcbiAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC54LFxuICAgICAgICBmb3J3YXJkOiAncmlnaHQnLFxuICAgICAgICBiYWNrd2FyZDogJ2xlZnQnLFxuICAgICAgICBvZmZzZXRQcm9wOiAnbGVmdCdcbiAgICAgIH0sXG4gICAgICB2ZXJ0aWNhbDoge1xuICAgICAgICBjb250ZXh0T2Zmc2V0OiBpc1dpbmRvdyA/IDAgOiBjb250ZXh0T2Zmc2V0LnRvcCxcbiAgICAgICAgY29udGV4dFNjcm9sbDogaXNXaW5kb3cgPyAwIDogdGhpcy5vbGRTY3JvbGwueSxcbiAgICAgICAgY29udGV4dERpbWVuc2lvbjogdGhpcy5pbm5lckhlaWdodCgpLFxuICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLnksXG4gICAgICAgIGZvcndhcmQ6ICdkb3duJyxcbiAgICAgICAgYmFja3dhcmQ6ICd1cCcsXG4gICAgICAgIG9mZnNldFByb3A6ICd0b3AnXG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgYXhpc0tleSBpbiBheGVzKSB7XG4gICAgICB2YXIgYXhpcyA9IGF4ZXNbYXhpc0tleV1cbiAgICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIHRoaXMud2F5cG9pbnRzW2F4aXNLZXldKSB7XG4gICAgICAgIHZhciB3YXlwb2ludCA9IHRoaXMud2F5cG9pbnRzW2F4aXNLZXldW3dheXBvaW50S2V5XVxuICAgICAgICB2YXIgYWRqdXN0bWVudCA9IHdheXBvaW50Lm9wdGlvbnMub2Zmc2V0XG4gICAgICAgIHZhciBvbGRUcmlnZ2VyUG9pbnQgPSB3YXlwb2ludC50cmlnZ2VyUG9pbnRcbiAgICAgICAgdmFyIGVsZW1lbnRPZmZzZXQgPSAwXG4gICAgICAgIHZhciBmcmVzaFdheXBvaW50ID0gb2xkVHJpZ2dlclBvaW50ID09IG51bGxcbiAgICAgICAgdmFyIGNvbnRleHRNb2RpZmllciwgd2FzQmVmb3JlU2Nyb2xsLCBub3dBZnRlclNjcm9sbFxuICAgICAgICB2YXIgdHJpZ2dlcmVkQmFja3dhcmQsIHRyaWdnZXJlZEZvcndhcmRcblxuICAgICAgICBpZiAod2F5cG9pbnQuZWxlbWVudCAhPT0gd2F5cG9pbnQuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgICAgICBlbGVtZW50T2Zmc2V0ID0gd2F5cG9pbnQuYWRhcHRlci5vZmZzZXQoKVtheGlzLm9mZnNldFByb3BdXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIGFkanVzdG1lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBhZGp1c3RtZW50ID0gYWRqdXN0bWVudC5hcHBseSh3YXlwb2ludClcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgYWRqdXN0bWVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICBhZGp1c3RtZW50ID0gcGFyc2VGbG9hdChhZGp1c3RtZW50KVxuICAgICAgICAgIGlmICh3YXlwb2ludC5vcHRpb25zLm9mZnNldC5pbmRleE9mKCclJykgPiAtIDEpIHtcbiAgICAgICAgICAgIGFkanVzdG1lbnQgPSBNYXRoLmNlaWwoYXhpcy5jb250ZXh0RGltZW5zaW9uICogYWRqdXN0bWVudCAvIDEwMClcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb250ZXh0TW9kaWZpZXIgPSBheGlzLmNvbnRleHRTY3JvbGwgLSBheGlzLmNvbnRleHRPZmZzZXRcbiAgICAgICAgd2F5cG9pbnQudHJpZ2dlclBvaW50ID0gZWxlbWVudE9mZnNldCArIGNvbnRleHRNb2RpZmllciAtIGFkanVzdG1lbnRcbiAgICAgICAgd2FzQmVmb3JlU2Nyb2xsID0gb2xkVHJpZ2dlclBvaW50IDwgYXhpcy5vbGRTY3JvbGxcbiAgICAgICAgbm93QWZ0ZXJTY3JvbGwgPSB3YXlwb2ludC50cmlnZ2VyUG9pbnQgPj0gYXhpcy5vbGRTY3JvbGxcbiAgICAgICAgdHJpZ2dlcmVkQmFja3dhcmQgPSB3YXNCZWZvcmVTY3JvbGwgJiYgbm93QWZ0ZXJTY3JvbGxcbiAgICAgICAgdHJpZ2dlcmVkRm9yd2FyZCA9ICF3YXNCZWZvcmVTY3JvbGwgJiYgIW5vd0FmdGVyU2Nyb2xsXG5cbiAgICAgICAgaWYgKCFmcmVzaFdheXBvaW50ICYmIHRyaWdnZXJlZEJhY2t3YXJkKSB7XG4gICAgICAgICAgd2F5cG9pbnQucXVldWVUcmlnZ2VyKGF4aXMuYmFja3dhcmQpXG4gICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWZyZXNoV2F5cG9pbnQgJiYgdHJpZ2dlcmVkRm9yd2FyZCkge1xuICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihheGlzLmZvcndhcmQpXG4gICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZnJlc2hXYXlwb2ludCAmJiBheGlzLm9sZFNjcm9sbCA+PSB3YXlwb2ludC50cmlnZ2VyUG9pbnQpIHtcbiAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoYXhpcy5mb3J3YXJkKVxuICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgV2F5cG9pbnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIgZ3JvdXBLZXkgaW4gdHJpZ2dlcmVkR3JvdXBzKSB7XG4gICAgICAgIHRyaWdnZXJlZEdyb3Vwc1tncm91cEtleV0uZmx1c2hUcmlnZ2VycygpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQuZmluZE9yQ3JlYXRlQnlFbGVtZW50ID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBDb250ZXh0LmZpbmRCeUVsZW1lbnQoZWxlbWVudCkgfHwgbmV3IENvbnRleHQoZWxlbWVudClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5yZWZyZXNoQWxsID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yICh2YXIgY29udGV4dElkIGluIGNvbnRleHRzKSB7XG4gICAgICBjb250ZXh0c1tjb250ZXh0SWRdLnJlZnJlc2goKVxuICAgIH1cbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvY29udGV4dC1maW5kLWJ5LWVsZW1lbnQgKi9cbiAgQ29udGV4dC5maW5kQnlFbGVtZW50ID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBjb250ZXh0c1tlbGVtZW50LndheXBvaW50Q29udGV4dEtleV1cbiAgfVxuXG4gIHdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAob2xkV2luZG93TG9hZCkge1xuICAgICAgb2xkV2luZG93TG9hZCgpXG4gICAgfVxuICAgIENvbnRleHQucmVmcmVzaEFsbCgpXG4gIH1cblxuICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIHZhciByZXF1ZXN0Rm4gPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICB3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWVTaGltXG4gICAgcmVxdWVzdEZuLmNhbGwod2luZG93LCBjYWxsYmFjaylcbiAgfVxuICBXYXlwb2ludC5Db250ZXh0ID0gQ29udGV4dFxufSgpKVxuOyhmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnXG5cbiAgZnVuY3Rpb24gYnlUcmlnZ2VyUG9pbnQoYSwgYikge1xuICAgIHJldHVybiBhLnRyaWdnZXJQb2ludCAtIGIudHJpZ2dlclBvaW50XG4gIH1cblxuICBmdW5jdGlvbiBieVJldmVyc2VUcmlnZ2VyUG9pbnQoYSwgYikge1xuICAgIHJldHVybiBiLnRyaWdnZXJQb2ludCAtIGEudHJpZ2dlclBvaW50XG4gIH1cblxuICB2YXIgZ3JvdXBzID0ge1xuICAgIHZlcnRpY2FsOiB7fSxcbiAgICBob3Jpem9udGFsOiB7fVxuICB9XG4gIHZhciBXYXlwb2ludCA9IHdpbmRvdy5XYXlwb2ludFxuXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9ncm91cCAqL1xuICBmdW5jdGlvbiBHcm91cChvcHRpb25zKSB7XG4gICAgdGhpcy5uYW1lID0gb3B0aW9ucy5uYW1lXG4gICAgdGhpcy5heGlzID0gb3B0aW9ucy5heGlzXG4gICAgdGhpcy5pZCA9IHRoaXMubmFtZSArICctJyArIHRoaXMuYXhpc1xuICAgIHRoaXMud2F5cG9pbnRzID0gW11cbiAgICB0aGlzLmNsZWFyVHJpZ2dlclF1ZXVlcygpXG4gICAgZ3JvdXBzW3RoaXMuYXhpc11bdGhpcy5uYW1lXSA9IHRoaXNcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgR3JvdXAucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgdGhpcy53YXlwb2ludHMucHVzaCh3YXlwb2ludClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgR3JvdXAucHJvdG90eXBlLmNsZWFyVHJpZ2dlclF1ZXVlcyA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudHJpZ2dlclF1ZXVlcyA9IHtcbiAgICAgIHVwOiBbXSxcbiAgICAgIGRvd246IFtdLFxuICAgICAgbGVmdDogW10sXG4gICAgICByaWdodDogW11cbiAgICB9XG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLnByb3RvdHlwZS5mbHVzaFRyaWdnZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yICh2YXIgZGlyZWN0aW9uIGluIHRoaXMudHJpZ2dlclF1ZXVlcykge1xuICAgICAgdmFyIHdheXBvaW50cyA9IHRoaXMudHJpZ2dlclF1ZXVlc1tkaXJlY3Rpb25dXG4gICAgICB2YXIgcmV2ZXJzZSA9IGRpcmVjdGlvbiA9PT0gJ3VwJyB8fCBkaXJlY3Rpb24gPT09ICdsZWZ0J1xuICAgICAgd2F5cG9pbnRzLnNvcnQocmV2ZXJzZSA/IGJ5UmV2ZXJzZVRyaWdnZXJQb2ludCA6IGJ5VHJpZ2dlclBvaW50KVxuICAgICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IHdheXBvaW50cy5sZW5ndGg7IGkgPCBlbmQ7IGkgKz0gMSkge1xuICAgICAgICB2YXIgd2F5cG9pbnQgPSB3YXlwb2ludHNbaV1cbiAgICAgICAgaWYgKHdheXBvaW50Lm9wdGlvbnMuY29udGludW91cyB8fCBpID09PSB3YXlwb2ludHMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHdheXBvaW50LnRyaWdnZXIoW2RpcmVjdGlvbl0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5jbGVhclRyaWdnZXJRdWV1ZXMoKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgdGhpcy53YXlwb2ludHMuc29ydChieVRyaWdnZXJQb2ludClcbiAgICB2YXIgaW5kZXggPSBXYXlwb2ludC5BZGFwdGVyLmluQXJyYXkod2F5cG9pbnQsIHRoaXMud2F5cG9pbnRzKVxuICAgIHZhciBpc0xhc3QgPSBpbmRleCA9PT0gdGhpcy53YXlwb2ludHMubGVuZ3RoIC0gMVxuICAgIHJldHVybiBpc0xhc3QgPyBudWxsIDogdGhpcy53YXlwb2ludHNbaW5kZXggKyAxXVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUucHJldmlvdXMgPSBmdW5jdGlvbih3YXlwb2ludCkge1xuICAgIHRoaXMud2F5cG9pbnRzLnNvcnQoYnlUcmlnZ2VyUG9pbnQpXG4gICAgdmFyIGluZGV4ID0gV2F5cG9pbnQuQWRhcHRlci5pbkFycmF5KHdheXBvaW50LCB0aGlzLndheXBvaW50cylcbiAgICByZXR1cm4gaW5kZXggPyB0aGlzLndheXBvaW50c1tpbmRleCAtIDFdIDogbnVsbFxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUucXVldWVUcmlnZ2VyID0gZnVuY3Rpb24od2F5cG9pbnQsIGRpcmVjdGlvbikge1xuICAgIHRoaXMudHJpZ2dlclF1ZXVlc1tkaXJlY3Rpb25dLnB1c2god2F5cG9pbnQpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbih3YXlwb2ludCkge1xuICAgIHZhciBpbmRleCA9IFdheXBvaW50LkFkYXB0ZXIuaW5BcnJheSh3YXlwb2ludCwgdGhpcy53YXlwb2ludHMpXG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIHRoaXMud2F5cG9pbnRzLnNwbGljZShpbmRleCwgMSlcbiAgICB9XG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2ZpcnN0ICovXG4gIEdyb3VwLnByb3RvdHlwZS5maXJzdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLndheXBvaW50c1swXVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9sYXN0ICovXG4gIEdyb3VwLnByb3RvdHlwZS5sYXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMud2F5cG9pbnRzW3RoaXMud2F5cG9pbnRzLmxlbmd0aCAtIDFdXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLmZpbmRPckNyZWF0ZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gZ3JvdXBzW29wdGlvbnMuYXhpc11bb3B0aW9ucy5uYW1lXSB8fCBuZXcgR3JvdXAob3B0aW9ucylcbiAgfVxuXG4gIFdheXBvaW50Lkdyb3VwID0gR3JvdXBcbn0oKSlcbjsoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0J1xuXG4gIHZhciBXYXlwb2ludCA9IHdpbmRvdy5XYXlwb2ludFxuXG4gIGZ1bmN0aW9uIGlzV2luZG93KGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudCA9PT0gZWxlbWVudC53aW5kb3dcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFdpbmRvdyhlbGVtZW50KSB7XG4gICAgaWYgKGlzV2luZG93KGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm4gZWxlbWVudFxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudC5kZWZhdWx0Vmlld1xuICB9XG5cbiAgZnVuY3Rpb24gTm9GcmFtZXdvcmtBZGFwdGVyKGVsZW1lbnQpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50XG4gICAgdGhpcy5oYW5kbGVycyA9IHt9XG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLmlubmVySGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGlzV2luID0gaXNXaW5kb3codGhpcy5lbGVtZW50KVxuICAgIHJldHVybiBpc1dpbiA/IHRoaXMuZWxlbWVudC5pbm5lckhlaWdodCA6IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHRcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuaW5uZXJXaWR0aCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpc1dpbiA9IGlzV2luZG93KHRoaXMuZWxlbWVudClcbiAgICByZXR1cm4gaXNXaW4gPyB0aGlzLmVsZW1lbnQuaW5uZXJXaWR0aCA6IHRoaXMuZWxlbWVudC5jbGllbnRXaWR0aFxuICB9XG5cbiAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihldmVudCwgaGFuZGxlcikge1xuICAgIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCBsaXN0ZW5lcnMsIGhhbmRsZXIpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSBsaXN0ZW5lcnMubGVuZ3RoIC0gMTsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXVxuICAgICAgICBpZiAoIWhhbmRsZXIgfHwgaGFuZGxlciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIobGlzdGVuZXIpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZXZlbnRQYXJ0cyA9IGV2ZW50LnNwbGl0KCcuJylcbiAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnRQYXJ0c1swXVxuICAgIHZhciBuYW1lc3BhY2UgPSBldmVudFBhcnRzWzFdXG4gICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRcblxuICAgIGlmIChuYW1lc3BhY2UgJiYgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdICYmIGV2ZW50VHlwZSkge1xuICAgICAgcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXVtldmVudFR5cGVdLCBoYW5kbGVyKVxuICAgICAgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW2V2ZW50VHlwZV0gPSBbXVxuICAgIH1cbiAgICBlbHNlIGlmIChldmVudFR5cGUpIHtcbiAgICAgIGZvciAodmFyIG5zIGluIHRoaXMuaGFuZGxlcnMpIHtcbiAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIHRoaXMuaGFuZGxlcnNbbnNdW2V2ZW50VHlwZV0gfHwgW10sIGhhbmRsZXIpXG4gICAgICAgIHRoaXMuaGFuZGxlcnNbbnNdW2V2ZW50VHlwZV0gPSBbXVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChuYW1lc3BhY2UgJiYgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdKSB7XG4gICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSkge1xuICAgICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW3R5cGVdLCBoYW5kbGVyKVxuICAgICAgfVxuICAgICAgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdID0ge31cbiAgICB9XG4gIH1cblxuICAvKiBBZGFwdGVkIGZyb20galF1ZXJ5IDEueCBvZmZzZXQoKSAqL1xuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm9mZnNldCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgdmFyIGRvY3VtZW50RWxlbWVudCA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxuICAgIHZhciB3aW4gPSBnZXRXaW5kb3codGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQpXG4gICAgdmFyIHJlY3QgPSB7XG4gICAgICB0b3A6IDAsXG4gICAgICBsZWZ0OiAwXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHtcbiAgICAgIHJlY3QgPSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiByZWN0LnRvcCArIHdpbi5wYWdlWU9mZnNldCAtIGRvY3VtZW50RWxlbWVudC5jbGllbnRUb3AsXG4gICAgICBsZWZ0OiByZWN0LmxlZnQgKyB3aW4ucGFnZVhPZmZzZXQgLSBkb2N1bWVudEVsZW1lbnQuY2xpZW50TGVmdFxuICAgIH1cbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbihldmVudCwgaGFuZGxlcikge1xuICAgIHZhciBldmVudFBhcnRzID0gZXZlbnQuc3BsaXQoJy4nKVxuICAgIHZhciBldmVudFR5cGUgPSBldmVudFBhcnRzWzBdXG4gICAgdmFyIG5hbWVzcGFjZSA9IGV2ZW50UGFydHNbMV0gfHwgJ19fZGVmYXVsdCdcbiAgICB2YXIgbnNIYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSA9IHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSB8fCB7fVxuICAgIHZhciBuc1R5cGVMaXN0ID0gbnNIYW5kbGVyc1tldmVudFR5cGVdID0gbnNIYW5kbGVyc1tldmVudFR5cGVdIHx8IFtdXG5cbiAgICBuc1R5cGVMaXN0LnB1c2goaGFuZGxlcilcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGhhbmRsZXIpXG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm91dGVySGVpZ2h0ID0gZnVuY3Rpb24oaW5jbHVkZU1hcmdpbikge1xuICAgIHZhciBoZWlnaHQgPSB0aGlzLmlubmVySGVpZ2h0KClcbiAgICB2YXIgY29tcHV0ZWRTdHlsZVxuXG4gICAgaWYgKGluY2x1ZGVNYXJnaW4gJiYgIWlzV2luZG93KHRoaXMuZWxlbWVudCkpIHtcbiAgICAgIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpXG4gICAgICBoZWlnaHQgKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5Ub3AsIDEwKVxuICAgICAgaGVpZ2h0ICs9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUubWFyZ2luQm90dG9tLCAxMClcbiAgICB9XG5cbiAgICByZXR1cm4gaGVpZ2h0XG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm91dGVyV2lkdGggPSBmdW5jdGlvbihpbmNsdWRlTWFyZ2luKSB7XG4gICAgdmFyIHdpZHRoID0gdGhpcy5pbm5lcldpZHRoKClcbiAgICB2YXIgY29tcHV0ZWRTdHlsZVxuXG4gICAgaWYgKGluY2x1ZGVNYXJnaW4gJiYgIWlzV2luZG93KHRoaXMuZWxlbWVudCkpIHtcbiAgICAgIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpXG4gICAgICB3aWR0aCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpbkxlZnQsIDEwKVxuICAgICAgd2lkdGggKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5SaWdodCwgMTApXG4gICAgfVxuXG4gICAgcmV0dXJuIHdpZHRoXG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLnNjcm9sbExlZnQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgd2luID0gZ2V0V2luZG93KHRoaXMuZWxlbWVudClcbiAgICByZXR1cm4gd2luID8gd2luLnBhZ2VYT2Zmc2V0IDogdGhpcy5lbGVtZW50LnNjcm9sbExlZnRcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuc2Nyb2xsVG9wID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHdpbiA9IGdldFdpbmRvdyh0aGlzLmVsZW1lbnQpXG4gICAgcmV0dXJuIHdpbiA/IHdpbi5wYWdlWU9mZnNldCA6IHRoaXMuZWxlbWVudC5zY3JvbGxUb3BcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5leHRlbmQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cylcblxuICAgIGZ1bmN0aW9uIG1lcmdlKHRhcmdldCwgb2JqKSB7XG4gICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBvYmpba2V5XVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGFyZ2V0XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDEsIGVuZCA9IGFyZ3MubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIG1lcmdlKGFyZ3NbMF0sIGFyZ3NbaV0pXG4gICAgfVxuICAgIHJldHVybiBhcmdzWzBdXG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIuaW5BcnJheSA9IGZ1bmN0aW9uKGVsZW1lbnQsIGFycmF5LCBpKSB7XG4gICAgcmV0dXJuIGFycmF5ID09IG51bGwgPyAtMSA6IGFycmF5LmluZGV4T2YoZWxlbWVudCwgaSlcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5pc0VtcHR5T2JqZWN0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgLyogZXNsaW50IG5vLXVudXNlZC12YXJzOiAwICovXG4gICAgZm9yICh2YXIgbmFtZSBpbiBvYmopIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgV2F5cG9pbnQuYWRhcHRlcnMucHVzaCh7XG4gICAgbmFtZTogJ25vZnJhbWV3b3JrJyxcbiAgICBBZGFwdGVyOiBOb0ZyYW1ld29ya0FkYXB0ZXJcbiAgfSlcbiAgV2F5cG9pbnQuQWRhcHRlciA9IE5vRnJhbWV3b3JrQWRhcHRlclxufSgpKVxuO1xufSx7fV19LHt9LFsxXSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
