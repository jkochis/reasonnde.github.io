"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function e(t,n,o){function i(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(e,t,n){e("../node_modules/waypoints/lib/noframework.waypoints");var o=document.body.style,i=document.location+"images/bg/",r=".png",s=["Feather_WHITE_Updated","DuckPrints_Orange"],a=!1,l=["sm-new-employees-container","sm-current-employees-container","sm-exiting-employees-container","sm-cadillac-tax-container","sm-penalties-container","sm-benefits-requirements-container","sm-voluntary-insurance-container","sm-exchanges-container","sm-whats-next-container","new-employees-container","current-employees-container","exiting-employees-container","cadillac-tax-container","penalties-container","benefits-requirements-container","voluntary-insurance-container","exchanges-container","whats-next-container"],c=function(){new Waypoint({element:document.getElementById("sm-benefits-requirements"),handler:function(e){console.log(this.element.clientHeight),jQuery("#sm-benefits-requirements:not(.shown)").addClass("animated bounceInDown shown"),jQuery("#sm-benefits-requirements").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery("#sm-benefits-requirements").removeClass("animated bounceInDown")})},offset:function(){return window.innerHeight-2*this.element.clientHeight}}),new Waypoint({element:document.getElementById("sm-penalties"),handler:function(e){console.log(this.element.clientHeight),jQuery("#sm-penalties:not(.shown)").addClass("animated zoomInUp shown"),jQuery("#sm-penalties").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery("#sm-penalties").removeClass("animated zoomInUp  ")})},offset:function(){return window.innerHeight-2*this.element.clientHeight}}),new Waypoint({element:document.getElementById("sm-cadillac-tax"),handler:function(e){console.log(this.element.clientHeight),jQuery("#sm-cadillac-tax:not(.shown)").addClass("animated zoomIn shown"),jQuery("#sm-cadillac-tax").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery("#sm-cadillac-tax").removeClass("animated zoomIn  ")})},offset:function(){return window.innerHeight-2*this.element.clientHeight}}),new Waypoint({element:document.getElementById("sm-exchanges"),handler:function(e){console.log("here"),jQuery("#sm-exchanges:not(.shown)").addClass("animated rotateIn shown"),jQuery("#sm-exchanges").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery("#sm-exchanges").removeClass("animated rotateIn")})},offset:function(){return window.innerHeight-2*this.element.clientHeight}}),new Waypoint({element:document.getElementById("sm-voluntary-insurance"),handler:function(e){console.log("here"),jQuery("#sm-voluntary-insurance:not(.shown)").addClass("animated slideInUp shown"),jQuery("#sm-voluntary-insurance").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery("#sm-voluntary-insurance").removeClass("animated slideInUp")})},offset:function(){return window.innerHeight-2*this.element.clientHeight}}),new Waypoint({element:document.getElementById("sm-whats-next"),handler:function(e){console.log("here"),jQuery("#sm-whats-next:not(.shown)").addClass("animated bounceInUp shown"),jQuery("#sm-whats-next").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery("#sm-whats-next").removeClass("animated bounceInUp")})},offset:function(){return window.innerHeight-2*this.element.clientHeight}})};window.waypoints=[],l.forEach(function(e,t){console.log("."+e),window.waypoints[t]=new Waypoint({element:document.querySelector("."+e),handler:function(e){console.log("loading..."),u(Math.floor(2*Math.random()))}})}),a!==!0&&(s.forEach(function(e){(new Image).src=i+e+r}),a=!0);var u=function(e){setTimeout(function(){o.backgroundImage="url("+i+s[e]+r+")",console.log("loading "+i+s[e]+r)},100)},h=jQuery(".business-type-select");h.each(function(e,t){console.log(t),jQuery(t).on("click",function(){console.log(t),jQuery(".hcr-menu-item").hide(),"business-50"===t.dataset.business?jQuery("a.sm").parent().show():jQuery("a.lg").parent().show(),document.body.classList="",document.body.classList.add(t.dataset.business+"-active");var e=document.querySelector(".business-type-select.active");e&&e.classList.remove("active"),t.classList.add("active");for(var n=document.querySelectorAll(".hcr-menu"),o=0;o<n.length;o++)n[o].style.visibility="visible";d.accordion(0,"top",function(e,t){t.el.classList.add("open"),console.log(e,t)});var i=document.querySelector(".business-container.visible");i&&(i.style.display="none",i.classList.remove("visible"));var r=document.querySelector("."+t.dataset.business+"-container");console.log(r),jQuery(r).fadeIn(),r.classList.add("visible"),jQuery("html, body").animate({scrollTop:jQuery(r).offset().top},1e3,function(){jQuery(r).find("h3").addClass("animated").addClass("pulse")}),u(Math.floor(2*Math.random())+0),c(),window.waypoints=[],l.forEach(function(e,t){console.log("."+e),window.waypoints[t]=new Waypoint({element:document.querySelector("."+e),handler:function(e){console.log("loading..."),u(Math.floor(2*Math.random()))}})})})});var d=new OriDomi(document.querySelector(".hcr-menu"),{hPanels:3,ripple:2,shading:"hard",touchEnabled:!1});d.foldUp("top");var f=jQuery(".hcr-menu-item a");f.on("click",function(e,t){e.preventDefault(),console.log("."+e.target.href.split("#")[1]),jQuery("html, body").animate({scrollTop:jQuery("."+e.target.href.split("#")[1]+"-container").offset().top-100},1e3,function(){})});for(var p=[],m=0;m<f.length;m++){var y=f[m],w=jQuery(y).attr("href");p.push(w)}jQuery(window).scroll(function(){for(var e=jQuery(window).scrollTop(),t=jQuery(window).height(),n=jQuery(document).height(),o=0;o<p.length;o++){var i=p[o].replace("#",""),r=jQuery("."+i+"-container").offset().top-200,s=jQuery("."+i+"-container").height();e>=r&&r+s>e?jQuery("a[href='#"+i+"']").addClass("active"):jQuery("a[href='#"+i+"']").removeClass("active")}if(e+t==n&&!jQuery("nav li:last-child a").hasClass("active")){var a=jQuery(".nav-active").attr("href");jQuery("a[href='"+a+"']").removeClass("active"),jQuery("nav li:last-child a").addClass("active")}})},{"../node_modules/waypoints/lib/noframework.waypoints":2}],2:[function(e,t,n){!function(){function e(o){if(!o)throw new Error("No options passed to Waypoint constructor");if(!o.element)throw new Error("No element option passed to Waypoint constructor");if(!o.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+t,this.options=e.Adapter.extend({},e.defaults,o),this.element=this.options.element,this.adapter=new e.Adapter(this.element),this.callback=o.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=e.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=e.Context.findOrCreateByElement(this.options.context),e.offsetAliases[this.options.offset]&&(this.options.offset=e.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),n[this.key]=this,t+=1}var t=0,n={};e.prototype.queueTrigger=function(e){this.group.queueTrigger(this,e)},e.prototype.trigger=function(e){this.enabled&&this.callback&&this.callback.apply(this,e)},e.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete n[this.key]},e.prototype.disable=function(){return this.enabled=!1,this},e.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},e.prototype.next=function(){return this.group.next(this)},e.prototype.previous=function(){return this.group.previous(this)},e.invokeAll=function(e){var t=[];for(var o in n)t.push(n[o]);for(var i=0,r=t.length;r>i;i++)t[i][e]()},e.destroyAll=function(){e.invokeAll("destroy")},e.disableAll=function(){e.invokeAll("disable")},e.enableAll=function(){e.invokeAll("enable")},e.refreshAll=function(){e.Context.refreshAll()},e.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},e.viewportWidth=function(){return document.documentElement.clientWidth},e.adapters=[],e.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},e.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=e}(),function(){function e(e){window.setTimeout(e,1e3/60)}function t(e){this.element=e,this.Adapter=i.Adapter,this.adapter=new this.Adapter(e),this.key="waypoint-context-"+n,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},e.waypointContextKey=this.key,o[e.waypointContextKey]=this,n+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var n=0,o={},i=window.Waypoint,r=window.onload;t.prototype.add=function(e){var t=e.options.horizontal?"horizontal":"vertical";this.waypoints[t][e.key]=e,this.refresh()},t.prototype.checkEmpty=function(){var e=this.Adapter.isEmptyObject(this.waypoints.horizontal),t=this.Adapter.isEmptyObject(this.waypoints.vertical);e&&t&&(this.adapter.off(".waypoints"),delete o[this.key])},t.prototype.createThrottledResizeHandler=function(){function e(){t.handleResize(),t.didResize=!1}var t=this;this.adapter.on("resize.waypoints",function(){t.didResize||(t.didResize=!0,i.requestAnimationFrame(e))})},t.prototype.createThrottledScrollHandler=function(){function e(){t.handleScroll(),t.didScroll=!1}var t=this;this.adapter.on("scroll.waypoints",function(){t.didScroll&&!i.isTouch||(t.didScroll=!0,i.requestAnimationFrame(e))})},t.prototype.handleResize=function(){i.Context.refreshAll()},t.prototype.handleScroll=function(){var e={},t={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var n in t){var o=t[n],i=o.newScroll>o.oldScroll,r=i?o.forward:o.backward;for(var s in this.waypoints[n]){var a=this.waypoints[n][s],l=o.oldScroll<a.triggerPoint,c=o.newScroll>=a.triggerPoint,u=l&&c,h=!l&&!c;(u||h)&&(a.queueTrigger(r),e[a.group.id]=a.group)}}for(var d in e)e[d].flushTriggers();this.oldScroll={x:t.horizontal.newScroll,y:t.vertical.newScroll}},t.prototype.innerHeight=function(){return this.element==this.element.window?i.viewportHeight():this.adapter.innerHeight()},t.prototype.remove=function(e){delete this.waypoints[e.axis][e.key],this.checkEmpty()},t.prototype.innerWidth=function(){return this.element==this.element.window?i.viewportWidth():this.adapter.innerWidth()},t.prototype.destroy=function(){var e=[];for(var t in this.waypoints)for(var n in this.waypoints[t])e.push(this.waypoints[t][n]);for(var o=0,i=e.length;i>o;o++)e[o].destroy()},t.prototype.refresh=function(){var e,t=this.element==this.element.window,n=t?void 0:this.adapter.offset(),o={};this.handleScroll(),e={horizontal:{contextOffset:t?0:n.left,contextScroll:t?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:t?0:n.top,contextScroll:t?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var r in e){var s=e[r];for(var a in this.waypoints[r]){var l,c,u,h,d,f=this.waypoints[r][a],p=f.options.offset,m=f.triggerPoint,y=0,w=null==m;f.element!==f.element.window&&(y=f.adapter.offset()[s.offsetProp]),"function"==typeof p?p=p.apply(f):"string"==typeof p&&(p=parseFloat(p),f.options.offset.indexOf("%")>-1&&(p=Math.ceil(s.contextDimension*p/100))),l=s.contextScroll-s.contextOffset,f.triggerPoint=y+l-p,c=m<s.oldScroll,u=f.triggerPoint>=s.oldScroll,h=c&&u,d=!c&&!u,!w&&h?(f.queueTrigger(s.backward),o[f.group.id]=f.group):!w&&d?(f.queueTrigger(s.forward),o[f.group.id]=f.group):w&&s.oldScroll>=f.triggerPoint&&(f.queueTrigger(s.forward),o[f.group.id]=f.group)}}return i.requestAnimationFrame(function(){for(var e in o)o[e].flushTriggers()}),this},t.findOrCreateByElement=function(e){return t.findByElement(e)||new t(e)},t.refreshAll=function(){for(var e in o)o[e].refresh()},t.findByElement=function(e){return o[e.waypointContextKey]},window.onload=function(){r&&r(),t.refreshAll()},i.requestAnimationFrame=function(t){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||e;n.call(window,t)},i.Context=t}(),function(){function e(e,t){return e.triggerPoint-t.triggerPoint}function t(e,t){return t.triggerPoint-e.triggerPoint}function n(e){this.name=e.name,this.axis=e.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),o[this.axis][this.name]=this}var o={vertical:{},horizontal:{}},i=window.Waypoint;n.prototype.add=function(e){this.waypoints.push(e)},n.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},n.prototype.flushTriggers=function(){for(var n in this.triggerQueues){var o=this.triggerQueues[n],i="up"===n||"left"===n;o.sort(i?t:e);for(var r=0,s=o.length;s>r;r+=1){var a=o[r];(a.options.continuous||r===o.length-1)&&a.trigger([n])}}this.clearTriggerQueues()},n.prototype.next=function(t){this.waypoints.sort(e);var n=i.Adapter.inArray(t,this.waypoints),o=n===this.waypoints.length-1;return o?null:this.waypoints[n+1]},n.prototype.previous=function(t){this.waypoints.sort(e);var n=i.Adapter.inArray(t,this.waypoints);return n?this.waypoints[n-1]:null},n.prototype.queueTrigger=function(e,t){this.triggerQueues[t].push(e)},n.prototype.remove=function(e){var t=i.Adapter.inArray(e,this.waypoints);t>-1&&this.waypoints.splice(t,1)},n.prototype.first=function(){return this.waypoints[0]},n.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},n.findOrCreate=function(e){return o[e.axis][e.name]||new n(e)},i.Group=n}(),function(){function e(e){return e===e.window}function t(t){return e(t)?t:t.defaultView}function n(e){this.element=e,this.handlers={}}var o=window.Waypoint;n.prototype.innerHeight=function(){var t=e(this.element);return t?this.element.innerHeight:this.element.clientHeight},n.prototype.innerWidth=function(){var t=e(this.element);return t?this.element.innerWidth:this.element.clientWidth},n.prototype.off=function(e,t){function n(e,t,n){for(var o=0,i=t.length-1;i>o;o++){var r=t[o];n&&n!==r||e.removeEventListener(r)}}var o=e.split("."),i=o[0],r=o[1],s=this.element;if(r&&this.handlers[r]&&i)n(s,this.handlers[r][i],t),this.handlers[r][i]=[];else if(i)for(var a in this.handlers)n(s,this.handlers[a][i]||[],t),this.handlers[a][i]=[];else if(r&&this.handlers[r]){for(var l in this.handlers[r])n(s,this.handlers[r][l],t);this.handlers[r]={}}},n.prototype.offset=function(){if(!this.element.ownerDocument)return null;var e=this.element.ownerDocument.documentElement,n=t(this.element.ownerDocument),o={top:0,left:0};return this.element.getBoundingClientRect&&(o=this.element.getBoundingClientRect()),{top:o.top+n.pageYOffset-e.clientTop,left:o.left+n.pageXOffset-e.clientLeft}},n.prototype.on=function(e,t){var n=e.split("."),o=n[0],i=n[1]||"__default",r=this.handlers[i]=this.handlers[i]||{},s=r[o]=r[o]||[];s.push(t),this.element.addEventListener(o,t)},n.prototype.outerHeight=function(t){var n,o=this.innerHeight();return t&&!e(this.element)&&(n=window.getComputedStyle(this.element),o+=parseInt(n.marginTop,10),o+=parseInt(n.marginBottom,10)),o},n.prototype.outerWidth=function(t){var n,o=this.innerWidth();return t&&!e(this.element)&&(n=window.getComputedStyle(this.element),o+=parseInt(n.marginLeft,10),o+=parseInt(n.marginRight,10)),o},n.prototype.scrollLeft=function(){var e=t(this.element);return e?e.pageXOffset:this.element.scrollLeft},n.prototype.scrollTop=function(){var e=t(this.element);return e?e.pageYOffset:this.element.scrollTop},n.extend=function(){function e(e,t){if("object"===("undefined"==typeof e?"undefined":_typeof(e))&&"object"===("undefined"==typeof t?"undefined":_typeof(t)))for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}for(var t=Array.prototype.slice.call(arguments),n=1,o=t.length;o>n;n++)e(t[0],t[n]);return t[0]},n.inArray=function(e,t,n){return null==t?-1:t.indexOf(e,n)},n.isEmptyObject=function(e){for(var t in e)return!1;return!0},o.adapters.push({name:"noframework",Adapter:n}),o.Adapter=n}()},{}]},{},[1]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5taW4uanMiLCJhcHAuanMiXSwibmFtZXMiOlsiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJlIiwidCIsIm4iLCJyIiwicyIsIm8iLCJ1IiwiYSIsInJlcXVpcmUiLCJpIiwiRXJyb3IiLCJmIiwiZXhwb3J0cyIsImNhbGwiLCJsZW5ndGgiLCIxIiwibW9kdWxlIiwiZG9jU3R5bGUiLCJkb2N1bWVudCIsImJvZHkiLCJzdHlsZSIsImJnUGF0aCIsImxvY2F0aW9uIiwiaW1nRXh0IiwiYmdzIiwiYmdJbWFnZXNMb2FkZWQiLCJjYXRlZ29yeVNlY3Rpb25zIiwibG9hZFdheXBvaW50cyIsIldheXBvaW50IiwiZWxlbWVudCIsImdldEVsZW1lbnRCeUlkIiwiaGFuZGxlciIsImRpcmVjdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJ0aGlzIiwiY2xpZW50SGVpZ2h0IiwialF1ZXJ5IiwiYWRkQ2xhc3MiLCJvbmUiLCJyZW1vdmVDbGFzcyIsIm9mZnNldCIsIndpbmRvdyIsImlubmVySGVpZ2h0Iiwid2F5cG9pbnRzIiwiZm9yRWFjaCIsImluZGV4IiwicXVlcnlTZWxlY3RvciIsImxvYWRCZyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImJnIiwiSW1hZ2UiLCJzcmMiLCJzZXRUaW1lb3V0IiwiYmFja2dyb3VuZEltYWdlIiwiYnVzaW5lc3NTZWxlY3QiLCJlYWNoIiwiZWwiLCJvbiIsImhpZGUiLCJkYXRhc2V0IiwiYnVzaW5lc3MiLCJwYXJlbnQiLCJzaG93IiwiY2xhc3NMaXN0IiwiYWRkIiwiY3VycmVudEFjdGl2ZSIsInJlbW92ZSIsIm1lbnVzIiwicXVlcnlTZWxlY3RvckFsbCIsInZpc2liaWxpdHkiLCJmb2xkTWVudSIsImFjY29yZGlvbiIsImV2Iiwib3JpIiwiY3VycmVudFZpc2libGUiLCJkaXNwbGF5Iiwic2VjdGlvblRvU2hvdyIsImZhZGVJbiIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJ0b3AiLCJmaW5kIiwiT3JpRG9taSIsImhQYW5lbHMiLCJyaXBwbGUiLCJzaGFkaW5nIiwidG91Y2hFbmFibGVkIiwiZm9sZFVwIiwiaGNyTWVudUl0ZW1MaW5rIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJocmVmIiwic3BsaXQiLCJhQXJyYXkiLCJhQ2hpbGQiLCJhaHJlZiIsImF0dHIiLCJwdXNoIiwic2Nyb2xsIiwid2luZG93UG9zIiwid2luZG93SGVpZ2h0IiwiaGVpZ2h0IiwiZG9jSGVpZ2h0IiwiX2kiLCJ0aGVJRCIsInJlcGxhY2UiLCJkaXZQb3MiLCJkaXZIZWlnaHQiLCJoYXNDbGFzcyIsIm5hdkFjdGl2ZUN1cnJlbnQiLCIuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHMiLCIyIiwib3B0aW9ucyIsImtleSIsImtleUNvdW50ZXIiLCJBZGFwdGVyIiwiZXh0ZW5kIiwiZGVmYXVsdHMiLCJhZGFwdGVyIiwiY2FsbGJhY2siLCJheGlzIiwiaG9yaXpvbnRhbCIsImVuYWJsZWQiLCJ0cmlnZ2VyUG9pbnQiLCJncm91cCIsIkdyb3VwIiwiZmluZE9yQ3JlYXRlIiwibmFtZSIsImNvbnRleHQiLCJDb250ZXh0IiwiZmluZE9yQ3JlYXRlQnlFbGVtZW50Iiwib2Zmc2V0QWxpYXNlcyIsImFsbFdheXBvaW50cyIsInByb3RvdHlwZSIsInF1ZXVlVHJpZ2dlciIsInRyaWdnZXIiLCJhcmdzIiwiYXBwbHkiLCJkZXN0cm95IiwiZGlzYWJsZSIsImVuYWJsZSIsInJlZnJlc2giLCJuZXh0IiwicHJldmlvdXMiLCJpbnZva2VBbGwiLCJtZXRob2QiLCJhbGxXYXlwb2ludHNBcnJheSIsIndheXBvaW50S2V5IiwiZW5kIiwiZGVzdHJveUFsbCIsImRpc2FibGVBbGwiLCJlbmFibGVBbGwiLCJyZWZyZXNoQWxsIiwidmlld3BvcnRIZWlnaHQiLCJkb2N1bWVudEVsZW1lbnQiLCJ2aWV3cG9ydFdpZHRoIiwiY2xpZW50V2lkdGgiLCJhZGFwdGVycyIsImNvbnRpbnVvdXMiLCJib3R0b20taW4tdmlldyIsIm91dGVySGVpZ2h0IiwicmlnaHQtaW4tdmlldyIsImlubmVyV2lkdGgiLCJvdXRlcldpZHRoIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lU2hpbSIsImRpZFNjcm9sbCIsImRpZFJlc2l6ZSIsIm9sZFNjcm9sbCIsIngiLCJzY3JvbGxMZWZ0IiwieSIsInZlcnRpY2FsIiwid2F5cG9pbnRDb250ZXh0S2V5IiwiY29udGV4dHMiLCJjcmVhdGVUaHJvdHRsZWRTY3JvbGxIYW5kbGVyIiwiY3JlYXRlVGhyb3R0bGVkUmVzaXplSGFuZGxlciIsIm9sZFdpbmRvd0xvYWQiLCJvbmxvYWQiLCJ3YXlwb2ludCIsImNoZWNrRW1wdHkiLCJob3Jpem9udGFsRW1wdHkiLCJpc0VtcHR5T2JqZWN0IiwidmVydGljYWxFbXB0eSIsIm9mZiIsInJlc2l6ZUhhbmRsZXIiLCJzZWxmIiwiaGFuZGxlUmVzaXplIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2Nyb2xsSGFuZGxlciIsImhhbmRsZVNjcm9sbCIsImlzVG91Y2giLCJ0cmlnZ2VyZWRHcm91cHMiLCJheGVzIiwibmV3U2Nyb2xsIiwiZm9yd2FyZCIsImJhY2t3YXJkIiwiYXhpc0tleSIsImlzRm9yd2FyZCIsIndhc0JlZm9yZVRyaWdnZXJQb2ludCIsIm5vd0FmdGVyVHJpZ2dlclBvaW50IiwiY3Jvc3NlZEZvcndhcmQiLCJjcm9zc2VkQmFja3dhcmQiLCJpZCIsImdyb3VwS2V5IiwiZmx1c2hUcmlnZ2VycyIsImlzV2luZG93IiwiY29udGV4dE9mZnNldCIsInVuZGVmaW5lZCIsImxlZnQiLCJjb250ZXh0U2Nyb2xsIiwiY29udGV4dERpbWVuc2lvbiIsIm9mZnNldFByb3AiLCJjb250ZXh0TW9kaWZpZXIiLCJ3YXNCZWZvcmVTY3JvbGwiLCJub3dBZnRlclNjcm9sbCIsInRyaWdnZXJlZEJhY2t3YXJkIiwidHJpZ2dlcmVkRm9yd2FyZCIsImFkanVzdG1lbnQiLCJvbGRUcmlnZ2VyUG9pbnQiLCJlbGVtZW50T2Zmc2V0IiwiZnJlc2hXYXlwb2ludCIsInBhcnNlRmxvYXQiLCJpbmRleE9mIiwiY2VpbCIsImZpbmRCeUVsZW1lbnQiLCJjb250ZXh0SWQiLCJyZXF1ZXN0Rm4iLCJtb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ3ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJieVRyaWdnZXJQb2ludCIsImIiLCJieVJldmVyc2VUcmlnZ2VyUG9pbnQiLCJjbGVhclRyaWdnZXJRdWV1ZXMiLCJncm91cHMiLCJ0cmlnZ2VyUXVldWVzIiwidXAiLCJkb3duIiwicmlnaHQiLCJyZXZlcnNlIiwic29ydCIsImluQXJyYXkiLCJpc0xhc3QiLCJzcGxpY2UiLCJmaXJzdCIsImxhc3QiLCJnZXRXaW5kb3ciLCJkZWZhdWx0VmlldyIsIk5vRnJhbWV3b3JrQWRhcHRlciIsImhhbmRsZXJzIiwiaXNXaW4iLCJldmVudCIsInJlbW92ZUxpc3RlbmVycyIsImxpc3RlbmVycyIsImxpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50UGFydHMiLCJldmVudFR5cGUiLCJuYW1lc3BhY2UiLCJucyIsInR5cGUiLCJvd25lckRvY3VtZW50Iiwid2luIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInBhZ2VZT2Zmc2V0IiwiY2xpZW50VG9wIiwicGFnZVhPZmZzZXQiLCJjbGllbnRMZWZ0IiwibnNIYW5kbGVycyIsIm5zVHlwZUxpc3QiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5jbHVkZU1hcmdpbiIsImNvbXB1dGVkU3R5bGUiLCJnZXRDb21wdXRlZFN0eWxlIiwicGFyc2VJbnQiLCJtYXJnaW5Ub3AiLCJtYXJnaW5Cb3R0b20iLCJ3aWR0aCIsIm1hcmdpbkxlZnQiLCJtYXJnaW5SaWdodCIsIm1lcmdlIiwiaGFzT3duUHJvcGVydHkiLCJBcnJheSIsInNsaWNlIiwiYXJndW1lbnRzIiwiYXJyYXkiXSwibWFwcGluZ3MiOiJBQUFBLFlBRUEsSUFBSUEsU0FBNEIsa0JBQVhDLFNBQW9ELGdCQUFwQkEsUUFB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QUFQLFlBQUFsRyxRQUFPa0csS0FBc0MsWUFBZixtQkFBTy9GLEdBQVAsWUFBQUgsUUFBT0csSUFDdkMsSUFBSyxHQUFJc0gsS0FBT3RILEdBQ1ZBLEVBQUk4UixlQUFleEssS0FDckJ2QixFQUFPdUIsR0FBT3RILEVBQUlzSCxHQUt4QixPQUFPdkIsR0FHVCxJQUFLLEdBZEQ4QyxHQUFPa0osTUFBTXJKLFVBQVVzSixNQUFNalIsS0FBS2tSLFdBYzdCdFIsRUFBSSxFQUFHOEksRUFBTVosRUFBSzdILE9BQVl5SSxFQUFKOUksRUFBU0EsSUFDMUNrUixFQUFNaEosRUFBSyxHQUFJQSxFQUFLbEksR0FFdEIsT0FBT2tJLEdBQUssSUFHZCtHLEVBQW1CUCxRQUFVLFNBQVN0TixFQUFTbVEsRUFBT3ZSLEdBQ3BELE1BQWdCLE9BQVR1UixFQUFnQixHQUFLQSxFQUFNL0QsUUFBUXBNLEVBQVNwQixJQUdyRGlQLEVBQW1CbEUsY0FBZ0IsU0FBUzFMLEdBRTFDLElBQUssR0FBSW9JLEtBQVFwSSxHQUNmLE9BQU8sQ0FFVCxRQUFPLEdBR1Q4QixFQUFTb0ksU0FBUzVELE1BQ2hCOEIsS0FBTSxjQUNOWixRQUFTb0ksSUFFWDlOLEVBQVMwRixRQUFVb0ksZUFHViIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG4oZnVuY3Rpb24gZSh0LCBuLCByKSB7XG4gIGZ1bmN0aW9uIHMobywgdSkge1xuICAgIGlmICghbltvXSkge1xuICAgICAgaWYgKCF0W29dKSB7XG4gICAgICAgIHZhciBhID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7aWYgKCF1ICYmIGEpIHJldHVybiBhKG8sICEwKTtpZiAoaSkgcmV0dXJuIGkobywgITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyBvICsgXCInXCIpO1xuICAgICAgfXZhciBmID0gbltvXSA9IHsgZXhwb3J0czoge30gfTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgbiA9IHRbb11bMV1bZV07cmV0dXJuIHMobiA/IG4gOiBlKTtcbiAgICAgIH0sIGYsIGYuZXhwb3J0cywgZSwgdCwgbiwgcik7XG4gICAgfXJldHVybiBuW29dLmV4cG9ydHM7XG4gIH12YXIgaSA9IHR5cGVvZiByZXF1aXJlID09IFwiZnVuY3Rpb25cIiAmJiByZXF1aXJlO2ZvciAodmFyIG8gPSAwOyBvIDwgci5sZW5ndGg7IG8rKykge1xuICAgIHMocltvXSk7XG4gIH1yZXR1cm4gcztcbn0pKHsgMTogW2Z1bmN0aW9uIChyZXF1aXJlLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICByZXF1aXJlKCcuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHMnKTtcblxuICAgIHZhciBkb2NTdHlsZSA9IGRvY3VtZW50LmJvZHkuc3R5bGU7XG4gICAgdmFyIGJnUGF0aCA9IGRvY3VtZW50LmxvY2F0aW9uICsgJ2ltYWdlcy9iZy8nO1xuICAgIHZhciBpbWdFeHQgPSAnLnBuZyc7XG4gICAgdmFyIGJncyA9IFsnRmVhdGhlcl9XSElURV9VcGRhdGVkJywgJ0R1Y2tQcmludHNfT3JhbmdlJyAvKiwgJ1dhbGxQYXBlcjIuNScsICdXYWxsUGFwZXIzJywgJ1dhbGxQYXBlcjMuNScsICdXYWxsUGFwZXI0JywgJ1dhbGxQYXBlcjQuNScsICdXYWxsUGFwZXI1LjUnLCAnV2FsbFBhcGVyNS41X3RvbmUnLCdXYWxsUGFwZXI2JywgJ1dhbGxQYXBlcjYuNScsICdXYWxsUGFwZXI3LjUnLCAnV2FsbFBhcGVyNy41X3RvbmUnKi9dO1xuICAgIHZhciBiZ0ltYWdlc0xvYWRlZCA9IGZhbHNlO1xuICAgIHZhciBjYXRlZ29yeVNlY3Rpb25zID0gWydzbS1uZXctZW1wbG95ZWVzLWNvbnRhaW5lcicsICdzbS1jdXJyZW50LWVtcGxveWVlcy1jb250YWluZXInLCAnc20tZXhpdGluZy1lbXBsb3llZXMtY29udGFpbmVyJywgJ3NtLWNhZGlsbGFjLXRheC1jb250YWluZXInLCAnc20tcGVuYWx0aWVzLWNvbnRhaW5lcicsICdzbS1iZW5lZml0cy1yZXF1aXJlbWVudHMtY29udGFpbmVyJywgJ3NtLXZvbHVudGFyeS1pbnN1cmFuY2UtY29udGFpbmVyJywgJ3NtLWV4Y2hhbmdlcy1jb250YWluZXInLCAnc20td2hhdHMtbmV4dC1jb250YWluZXInLCAnbmV3LWVtcGxveWVlcy1jb250YWluZXInLCAnY3VycmVudC1lbXBsb3llZXMtY29udGFpbmVyJywgJ2V4aXRpbmctZW1wbG95ZWVzLWNvbnRhaW5lcicsICdjYWRpbGxhYy10YXgtY29udGFpbmVyJywgJ3BlbmFsdGllcy1jb250YWluZXInLCAnYmVuZWZpdHMtcmVxdWlyZW1lbnRzLWNvbnRhaW5lcicsICd2b2x1bnRhcnktaW5zdXJhbmNlLWNvbnRhaW5lcicsICdleGNoYW5nZXMtY29udGFpbmVyJywgJ3doYXRzLW5leHQtY29udGFpbmVyJ107XG5cbiAgICB2YXIgbG9hZFdheXBvaW50cyA9IGZ1bmN0aW9uIGxvYWRXYXlwb2ludHMoKSB7XG4gICAgICBuZXcgV2F5cG9pbnQoe1xuICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc20tYmVuZWZpdHMtcmVxdWlyZW1lbnRzJyksXG4gICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgY29uc29sZS5sb2codGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCk7XG4gICAgICAgICAgalF1ZXJ5KCcjc20tYmVuZWZpdHMtcmVxdWlyZW1lbnRzOm5vdCguc2hvd24pJykuYWRkQ2xhc3MoJ2FuaW1hdGVkIGJvdW5jZUluRG93biBzaG93bicpO1xuICAgICAgICAgIGpRdWVyeSgnI3NtLWJlbmVmaXRzLXJlcXVpcmVtZW50cycpLm9uZSgnd2Via2l0QW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgbXNBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KCcjc20tYmVuZWZpdHMtcmVxdWlyZW1lbnRzJykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkIGJvdW5jZUluRG93bicpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vZGlyZWN0aW9uID09PSAnZG93bicgPyBsb2FkQmcoaW5kZXggKyAxKSA6IGxvYWRCZyhpbmRleCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9mZnNldDogZnVuY3Rpb24gb2Zmc2V0KCkge1xuICAgICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICogMjtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIFBlbmFsdGllc1xuICAgICAgbmV3IFdheXBvaW50KHtcbiAgICAgICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NtLXBlbmFsdGllcycpLFxuICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKGRpcmVjdGlvbikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQpO1xuICAgICAgICAgIGpRdWVyeSgnI3NtLXBlbmFsdGllczpub3QoLnNob3duKScpLmFkZENsYXNzKCdhbmltYXRlZCB6b29tSW5VcCBzaG93bicpO1xuICAgICAgICAgIGpRdWVyeSgnI3NtLXBlbmFsdGllcycpLm9uZSgnd2Via2l0QW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgbXNBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KCcjc20tcGVuYWx0aWVzJykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkIHpvb21JblVwICAnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvL2RpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICB9LFxuICAgICAgICBvZmZzZXQ6IGZ1bmN0aW9uIG9mZnNldCgpIHtcbiAgICAgICAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCAqIDI7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYWRpbGxhYyBUYXhcbiAgICAgIG5ldyBXYXlwb2ludCh7XG4gICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbS1jYWRpbGxhYy10YXgnKSxcbiAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihkaXJlY3Rpb24pIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0KTtcbiAgICAgICAgICBqUXVlcnkoJyNzbS1jYWRpbGxhYy10YXg6bm90KC5zaG93biknKS5hZGRDbGFzcygnYW5pbWF0ZWQgem9vbUluIHNob3duJyk7XG4gICAgICAgICAgalF1ZXJ5KCcjc20tY2FkaWxsYWMtdGF4Jykub25lKCd3ZWJraXRBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBtc0FuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBqUXVlcnkoJyNzbS1jYWRpbGxhYy10YXgnKS5yZW1vdmVDbGFzcygnYW5pbWF0ZWQgem9vbUluICAnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvL2RpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICB9LFxuICAgICAgICBvZmZzZXQ6IGZ1bmN0aW9uIG9mZnNldCgpIHtcbiAgICAgICAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCAqIDI7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBFeGNoYW5nZXNcbiAgICAgIG5ldyBXYXlwb2ludCh7XG4gICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbS1leGNoYW5nZXMnKSxcbiAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihkaXJlY3Rpb24pIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnaGVyZScpO1xuICAgICAgICAgIGpRdWVyeSgnI3NtLWV4Y2hhbmdlczpub3QoLnNob3duKScpLmFkZENsYXNzKCdhbmltYXRlZCByb3RhdGVJbiBzaG93bicpO1xuICAgICAgICAgIGpRdWVyeSgnI3NtLWV4Y2hhbmdlcycpLm9uZSgnd2Via2l0QW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgbXNBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KCcjc20tZXhjaGFuZ2VzJykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkIHJvdGF0ZUluJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLy9kaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbiAgICAgICAgfSxcbiAgICAgICAgb2Zmc2V0OiBmdW5jdGlvbiBvZmZzZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQgKiAyO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gdm9sdW50YXJ5IGluc3VyYW5jZVxuICAgICAgbmV3IFdheXBvaW50KHtcbiAgICAgICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NtLXZvbHVudGFyeS1pbnN1cmFuY2UnKSxcbiAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihkaXJlY3Rpb24pIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnaGVyZScpO1xuICAgICAgICAgIGpRdWVyeSgnI3NtLXZvbHVudGFyeS1pbnN1cmFuY2U6bm90KC5zaG93biknKS5hZGRDbGFzcygnYW5pbWF0ZWQgc2xpZGVJblVwIHNob3duJyk7XG4gICAgICAgICAgalF1ZXJ5KCcjc20tdm9sdW50YXJ5LWluc3VyYW5jZScpLm9uZSgnd2Via2l0QW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgbXNBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KCcjc20tdm9sdW50YXJ5LWluc3VyYW5jZScpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBzbGlkZUluVXAnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvL2RpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICB9LFxuICAgICAgICBvZmZzZXQ6IGZ1bmN0aW9uIG9mZnNldCgpIHtcbiAgICAgICAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCAqIDI7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gd2hhdCdzIG5leHQgaW5zdXJhbmNlXG4gICAgICBuZXcgV2F5cG9pbnQoe1xuICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc20td2hhdHMtbmV4dCcpLFxuICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKGRpcmVjdGlvbikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdoZXJlJyk7XG4gICAgICAgICAgalF1ZXJ5KCcjc20td2hhdHMtbmV4dDpub3QoLnNob3duKScpLmFkZENsYXNzKCdhbmltYXRlZCBib3VuY2VJblVwIHNob3duJyk7XG4gICAgICAgICAgalF1ZXJ5KCcjc20td2hhdHMtbmV4dCcpLm9uZSgnd2Via2l0QW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgbXNBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KCcjc20td2hhdHMtbmV4dCcpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBib3VuY2VJblVwJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLy9kaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbiAgICAgICAgfSxcbiAgICAgICAgb2Zmc2V0OiBmdW5jdGlvbiBvZmZzZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQgKiAyO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy8gVXRpbGl0eVxuICAgIC8vIHNldHVwIHdheXBvaW50c1xuICAgIHdpbmRvdy53YXlwb2ludHMgPSBbXTtcbiAgICBjYXRlZ29yeVNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4KSB7XG4gICAgICBjb25zb2xlLmxvZyhcIi5cIiArIGVsZW1lbnQpO1xuICAgICAgd2luZG93LndheXBvaW50c1tpbmRleF0gPSBuZXcgV2F5cG9pbnQoe1xuICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLlwiICsgZWxlbWVudCksXG4gICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ2xvYWRpbmcuLi4nKTtcbiAgICAgICAgICBsb2FkQmcoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMikpO1xuICAgICAgICAgIC8vZGlyZWN0aW9uID09PSAnZG93bicgPyBsb2FkQmcoaW5kZXggKyAxKSA6IGxvYWRCZyhpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gcHJlbG9hZCBpbWFnZXNcbiAgICBpZiAoYmdJbWFnZXNMb2FkZWQgIT09IHRydWUpIHtcbiAgICAgIGJncy5mb3JFYWNoKGZ1bmN0aW9uIChiZykge1xuICAgICAgICBuZXcgSW1hZ2UoKS5zcmMgPSBiZ1BhdGggKyBiZyArIGltZ0V4dDtcbiAgICAgICAgLy8gY2FjaGVzIGltYWdlcywgYXZvaWRpbmcgd2hpdGUgZmxhc2ggYmV0d2VlbiBiYWNrZ3JvdW5kIHJlcGxhY2VtZW50c1xuICAgICAgfSk7XG4gICAgICBiZ0ltYWdlc0xvYWRlZCA9IHRydWU7XG4gICAgfVxuICAgIC8vIGxvYWQgYmcgaW1hZ2VcbiAgICB2YXIgbG9hZEJnID0gZnVuY3Rpb24gbG9hZEJnKGJnKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZG9jU3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBiZ1BhdGggKyBiZ3NbYmddICsgaW1nRXh0ICsgXCIpXCI7XG4gICAgICAgIGNvbnNvbGUubG9nKFwibG9hZGluZyBcIiArIGJnUGF0aCArIGJnc1tiZ10gKyBpbWdFeHQpO1xuICAgICAgfSwgMTAwKTtcbiAgICB9O1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8gYnVzaW5lc3Mgc2VsZWN0IGJ1dHRvbnNcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIHZhciBidXNpbmVzc1NlbGVjdCA9IGpRdWVyeSgnLmJ1c2luZXNzLXR5cGUtc2VsZWN0Jyk7XG4gICAgYnVzaW5lc3NTZWxlY3QuZWFjaChmdW5jdGlvbiAoaSwgZWwpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVsKTtcbiAgICAgIGpRdWVyeShlbCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhlbCk7XG4gICAgICAgIGpRdWVyeSgnLmhjci1tZW51LWl0ZW0nKS5oaWRlKCk7XG4gICAgICAgIGlmIChlbC5kYXRhc2V0LmJ1c2luZXNzID09PSAnYnVzaW5lc3MtNTAnKSB7XG4gICAgICAgICAgalF1ZXJ5KCdhLnNtJykucGFyZW50KCkuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGpRdWVyeSgnYS5sZycpLnBhcmVudCgpLnNob3coKTtcbiAgICAgICAgfVxuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdCA9ICcnO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoZWwuZGF0YXNldC5idXNpbmVzcyArIFwiLWFjdGl2ZVwiKTtcbiAgICAgICAgLy8gZ2V0IHRoZSBhY3RpdmUgbWVudSBpdGVtIGFuZCB0dXJuIGl0IG9mZlxuICAgICAgICB2YXIgY3VycmVudEFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXNpbmVzcy10eXBlLXNlbGVjdC5hY3RpdmUnKTtcbiAgICAgICAgaWYgKGN1cnJlbnRBY3RpdmUpIHtcbiAgICAgICAgICBjdXJyZW50QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHR1cm4gb24gdGhlIG5ldyBtZW51IGl0ZW1cbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgIC8vIHNob3cgdGhlIG5hdlxuICAgICAgICB2YXIgbWVudXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGNyLW1lbnUnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZW51cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIG1lbnVzW2ldLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgIH1cbiAgICAgICAgZm9sZE1lbnUuYWNjb3JkaW9uKDAsICd0b3AnLCBmdW5jdGlvbiAoZXYsIG9yaSkge1xuICAgICAgICAgIG9yaS5lbC5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7XG4gICAgICAgICAgY29uc29sZS5sb2coZXYsIG9yaSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgY3VycmVudFZpc2libGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVzaW5lc3MtY29udGFpbmVyLnZpc2libGUnKTtcbiAgICAgICAgaWYgKGN1cnJlbnRWaXNpYmxlKSB7XG4gICAgICAgICAgY3VycmVudFZpc2libGUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICBjdXJyZW50VmlzaWJsZS5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlY3Rpb25Ub1Nob3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLlwiICsgZWwuZGF0YXNldC5idXNpbmVzcyArIFwiLWNvbnRhaW5lclwiKTtcbiAgICAgICAgY29uc29sZS5sb2coc2VjdGlvblRvU2hvdyk7XG4gICAgICAgIGpRdWVyeShzZWN0aW9uVG9TaG93KS5mYWRlSW4oKTtcbiAgICAgICAgc2VjdGlvblRvU2hvdy5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG4gICAgICAgIGpRdWVyeSgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgIHNjcm9sbFRvcDogalF1ZXJ5KHNlY3Rpb25Ub1Nob3cpLm9mZnNldCgpLnRvcFxuICAgICAgICB9LCAxMDAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgalF1ZXJ5KHNlY3Rpb25Ub1Nob3cpLmZpbmQoJ2gzJykuYWRkQ2xhc3MoJ2FuaW1hdGVkJykuYWRkQ2xhc3MoJ3B1bHNlJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBsb2FkQmcoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMikgKyAwKTtcblxuICAgICAgICBsb2FkV2F5cG9pbnRzKCk7XG5cbiAgICAgICAgLy8gVXRpbGl0eVxuICAgICAgICAvLyBzZXR1cCB3YXlwb2ludHNcbiAgICAgICAgd2luZG93LndheXBvaW50cyA9IFtdO1xuICAgICAgICBjYXRlZ29yeVNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4KSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCIuXCIgKyBlbGVtZW50KTtcbiAgICAgICAgICB3aW5kb3cud2F5cG9pbnRzW2luZGV4XSA9IG5ldyBXYXlwb2ludCh7XG4gICAgICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLlwiICsgZWxlbWVudCksXG4gICAgICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbG9hZGluZy4uLicpO1xuICAgICAgICAgICAgICBsb2FkQmcoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMikpO1xuICAgICAgICAgICAgICAvL2RpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8vLy8vLy8vLy9cbiAgICAvLyBoY3IgbWVudVxuICAgIC8vLy8vLy8vLy8vXG4gICAgdmFyIGZvbGRNZW51ID0gbmV3IE9yaURvbWkoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhjci1tZW51JyksIHtcbiAgICAgIGhQYW5lbHM6IDMsXG4gICAgICByaXBwbGU6IDIsXG4gICAgICBzaGFkaW5nOiAnaGFyZCcsXG4gICAgICB0b3VjaEVuYWJsZWQ6IGZhbHNlXG4gICAgfSk7XG4gICAgLy8gbG9hZFxuICAgIGZvbGRNZW51LmZvbGRVcCgndG9wJyk7XG5cbiAgICAvLyBjbGlja1xuICAgIHZhciBoY3JNZW51SXRlbUxpbmsgPSBqUXVlcnkoJy5oY3ItbWVudS1pdGVtIGEnKTtcbiAgICBoY3JNZW51SXRlbUxpbmsub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUsIGVsKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zb2xlLmxvZyhcIi5cIiArIGUudGFyZ2V0LmhyZWYuc3BsaXQoJyMnKVsxXSk7XG4gICAgICBqUXVlcnkoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgc2Nyb2xsVG9wOiBqUXVlcnkoXCIuXCIgKyBlLnRhcmdldC5ocmVmLnNwbGl0KCcjJylbMV0gKyBcIi1jb250YWluZXJcIikub2Zmc2V0KCkudG9wIC0gMTAwXG4gICAgICB9LCAxMDAwLCBmdW5jdGlvbiAoKSB7fSk7XG4gICAgfSk7XG5cbiAgICAvL3Njcm9sbFxuICAgIHZhciBhQXJyYXkgPSBbXTsgLy8gY3JlYXRlIHRoZSBlbXB0eSBhQXJyYXlcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhjck1lbnVJdGVtTGluay5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGFDaGlsZCA9IGhjck1lbnVJdGVtTGlua1tpXTtcbiAgICAgIHZhciBhaHJlZiA9IGpRdWVyeShhQ2hpbGQpLmF0dHIoJ2hyZWYnKTtcbiAgICAgIGFBcnJheS5wdXNoKGFocmVmKTtcbiAgICB9XG4gICAgdmFyIGN1cnJlbnRTZWN0aW9uID0gJyc7XG4gICAgalF1ZXJ5KHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB3aW5kb3dQb3MgPSBqUXVlcnkod2luZG93KS5zY3JvbGxUb3AoKTsgLy8gZ2V0IHRoZSBvZmZzZXQgb2YgdGhlIHdpbmRvdyBmcm9tIHRoZSB0b3Agb2YgcGFnZVxuICAgICAgdmFyIHdpbmRvd0hlaWdodCA9IGpRdWVyeSh3aW5kb3cpLmhlaWdodCgpOyAvLyBnZXQgdGhlIGhlaWdodCBvZiB0aGUgd2luZG93XG4gICAgICB2YXIgZG9jSGVpZ2h0ID0galF1ZXJ5KGRvY3VtZW50KS5oZWlnaHQoKTtcblxuICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFBcnJheS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHRoZUlEID0gYUFycmF5W19pXS5yZXBsYWNlKCcjJywgJycpO1xuICAgICAgICB2YXIgZGl2UG9zID0galF1ZXJ5KFwiLlwiICsgdGhlSUQgKyBcIi1jb250YWluZXJcIikub2Zmc2V0KCkudG9wIC0gMjAwOyAvLyBnZXQgdGhlIG9mZnNldCBvZiB0aGUgZGl2IGZyb20gdGhlIHRvcCBvZiBwYWdlXG4gICAgICAgIHZhciBkaXZIZWlnaHQgPSBqUXVlcnkoXCIuXCIgKyB0aGVJRCArIFwiLWNvbnRhaW5lclwiKS5oZWlnaHQoKTsgLy8gZ2V0IHRoZSBoZWlnaHQgb2YgdGhlIGRpdiBpbiBxdWVzdGlvblxuICAgICAgICBpZiAod2luZG93UG9zID49IGRpdlBvcyAmJiB3aW5kb3dQb3MgPCBkaXZQb3MgKyBkaXZIZWlnaHQpIHtcbiAgICAgICAgICBqUXVlcnkoXCJhW2hyZWY9JyNcIiArIHRoZUlEICsgXCInXVwiKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgalF1ZXJ5KFwiYVtocmVmPScjXCIgKyB0aGVJRCArIFwiJ11cIikucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh3aW5kb3dQb3MgKyB3aW5kb3dIZWlnaHQgPT0gZG9jSGVpZ2h0KSB7XG4gICAgICAgIGlmICghalF1ZXJ5KCduYXYgbGk6bGFzdC1jaGlsZCBhJykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAgICAgdmFyIG5hdkFjdGl2ZUN1cnJlbnQgPSBqUXVlcnkoJy5uYXYtYWN0aXZlJykuYXR0cignaHJlZicpO1xuICAgICAgICAgIGpRdWVyeShcImFbaHJlZj0nXCIgKyBuYXZBY3RpdmVDdXJyZW50ICsgXCInXVwiKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgalF1ZXJ5KCduYXYgbGk6bGFzdC1jaGlsZCBhJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH0sIHsgXCIuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHNcIjogMiB9XSwgMjogW2Z1bmN0aW9uIChyZXF1aXJlLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAvKiFcbiAgICBXYXlwb2ludHMgLSA0LjAuMFxuICAgIENvcHlyaWdodCDCqSAyMDExLTIwMTUgQ2FsZWIgVHJvdWdodG9uXG4gICAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9pbWFrZXdlYnRoaW5ncy93YXlwb2ludHMvYmxvZy9tYXN0ZXIvbGljZW5zZXMudHh0XG4gICAgKi9cbiAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICB2YXIga2V5Q291bnRlciA9IDA7XG4gICAgICB2YXIgYWxsV2F5cG9pbnRzID0ge307XG5cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS93YXlwb2ludCAqL1xuICAgICAgZnVuY3Rpb24gV2F5cG9pbnQob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIG9wdGlvbnMgcGFzc2VkIHRvIFdheXBvaW50IGNvbnN0cnVjdG9yJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvcHRpb25zLmVsZW1lbnQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGVsZW1lbnQgb3B0aW9uIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb3B0aW9ucy5oYW5kbGVyKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBoYW5kbGVyIG9wdGlvbiBwYXNzZWQgdG8gV2F5cG9pbnQgY29uc3RydWN0b3InKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMua2V5ID0gJ3dheXBvaW50LScgKyBrZXlDb3VudGVyO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBXYXlwb2ludC5BZGFwdGVyLmV4dGVuZCh7fSwgV2F5cG9pbnQuZGVmYXVsdHMsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLm9wdGlvbnMuZWxlbWVudDtcbiAgICAgICAgdGhpcy5hZGFwdGVyID0gbmV3IFdheXBvaW50LkFkYXB0ZXIodGhpcy5lbGVtZW50KTtcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuaGFuZGxlcjtcbiAgICAgICAgdGhpcy5heGlzID0gdGhpcy5vcHRpb25zLmhvcml6b250YWwgPyAnaG9yaXpvbnRhbCcgOiAndmVydGljYWwnO1xuICAgICAgICB0aGlzLmVuYWJsZWQgPSB0aGlzLm9wdGlvbnMuZW5hYmxlZDtcbiAgICAgICAgdGhpcy50cmlnZ2VyUG9pbnQgPSBudWxsO1xuICAgICAgICB0aGlzLmdyb3VwID0gV2F5cG9pbnQuR3JvdXAuZmluZE9yQ3JlYXRlKHtcbiAgICAgICAgICBuYW1lOiB0aGlzLm9wdGlvbnMuZ3JvdXAsXG4gICAgICAgICAgYXhpczogdGhpcy5heGlzXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBXYXlwb2ludC5Db250ZXh0LmZpbmRPckNyZWF0ZUJ5RWxlbWVudCh0aGlzLm9wdGlvbnMuY29udGV4dCk7XG5cbiAgICAgICAgaWYgKFdheXBvaW50Lm9mZnNldEFsaWFzZXNbdGhpcy5vcHRpb25zLm9mZnNldF0pIHtcbiAgICAgICAgICB0aGlzLm9wdGlvbnMub2Zmc2V0ID0gV2F5cG9pbnQub2Zmc2V0QWxpYXNlc1t0aGlzLm9wdGlvbnMub2Zmc2V0XTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmdyb3VwLmFkZCh0aGlzKTtcbiAgICAgICAgdGhpcy5jb250ZXh0LmFkZCh0aGlzKTtcbiAgICAgICAgYWxsV2F5cG9pbnRzW3RoaXMua2V5XSA9IHRoaXM7XG4gICAgICAgIGtleUNvdW50ZXIgKz0gMTtcbiAgICAgIH1cblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgV2F5cG9pbnQucHJvdG90eXBlLnF1ZXVlVHJpZ2dlciA9IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5ncm91cC5xdWV1ZVRyaWdnZXIodGhpcywgZGlyZWN0aW9uKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIFdheXBvaW50LnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLmNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kZXN0cm95ICovXG4gICAgICBXYXlwb2ludC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0LnJlbW92ZSh0aGlzKTtcbiAgICAgICAgdGhpcy5ncm91cC5yZW1vdmUodGhpcyk7XG4gICAgICAgIGRlbGV0ZSBhbGxXYXlwb2ludHNbdGhpcy5rZXldO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZGlzYWJsZSAqL1xuICAgICAgV2F5cG9pbnQucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2VuYWJsZSAqL1xuICAgICAgV2F5cG9pbnQucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0LnJlZnJlc2goKTtcbiAgICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuXG4gICAgICAvKiBQdWJsaWMgKi9cbiAgICAgIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9uZXh0ICovXG4gICAgICBXYXlwb2ludC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ3JvdXAubmV4dCh0aGlzKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3ByZXZpb3VzICovXG4gICAgICBXYXlwb2ludC5wcm90b3R5cGUucHJldmlvdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdyb3VwLnByZXZpb3VzKHRoaXMpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgV2F5cG9pbnQuaW52b2tlQWxsID0gZnVuY3Rpb24gKG1ldGhvZCkge1xuICAgICAgICB2YXIgYWxsV2F5cG9pbnRzQXJyYXkgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgd2F5cG9pbnRLZXkgaW4gYWxsV2F5cG9pbnRzKSB7XG4gICAgICAgICAgYWxsV2F5cG9pbnRzQXJyYXkucHVzaChhbGxXYXlwb2ludHNbd2F5cG9pbnRLZXldKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gYWxsV2F5cG9pbnRzQXJyYXkubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICBhbGxXYXlwb2ludHNBcnJheVtpXVttZXRob2RdKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rlc3Ryb3ktYWxsICovXG4gICAgICBXYXlwb2ludC5kZXN0cm95QWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2Rlc3Ryb3knKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rpc2FibGUtYWxsICovXG4gICAgICBXYXlwb2ludC5kaXNhYmxlQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2Rpc2FibGUnKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2VuYWJsZS1hbGwgKi9cbiAgICAgIFdheXBvaW50LmVuYWJsZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgV2F5cG9pbnQuaW52b2tlQWxsKCdlbmFibGUnKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3JlZnJlc2gtYWxsICovXG4gICAgICBXYXlwb2ludC5yZWZyZXNoQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBXYXlwb2ludC5Db250ZXh0LnJlZnJlc2hBbGwoKTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3ZpZXdwb3J0LWhlaWdodCAqL1xuICAgICAgV2F5cG9pbnQudmlld3BvcnRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3ZpZXdwb3J0LXdpZHRoICovXG4gICAgICBXYXlwb2ludC52aWV3cG9ydFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xuICAgICAgfTtcblxuICAgICAgV2F5cG9pbnQuYWRhcHRlcnMgPSBbXTtcblxuICAgICAgV2F5cG9pbnQuZGVmYXVsdHMgPSB7XG4gICAgICAgIGNvbnRleHQ6IHdpbmRvdyxcbiAgICAgICAgY29udGludW91czogdHJ1ZSxcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgZ3JvdXA6ICdkZWZhdWx0JyxcbiAgICAgICAgaG9yaXpvbnRhbDogZmFsc2UsXG4gICAgICAgIG9mZnNldDogMFxuICAgICAgfTtcblxuICAgICAgV2F5cG9pbnQub2Zmc2V0QWxpYXNlcyA9IHtcbiAgICAgICAgJ2JvdHRvbS1pbi12aWV3JzogZnVuY3Rpb24gYm90dG9tSW5WaWV3KCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaW5uZXJIZWlnaHQoKSAtIHRoaXMuYWRhcHRlci5vdXRlckhlaWdodCgpO1xuICAgICAgICB9LFxuICAgICAgICAncmlnaHQtaW4tdmlldyc6IGZ1bmN0aW9uIHJpZ2h0SW5WaWV3KCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaW5uZXJXaWR0aCgpIC0gdGhpcy5hZGFwdGVyLm91dGVyV2lkdGgoKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgd2luZG93LldheXBvaW50ID0gV2F5cG9pbnQ7XG4gICAgfSkoKTsoZnVuY3Rpb24gKCkge1xuICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICBmdW5jdGlvbiByZXF1ZXN0QW5pbWF0aW9uRnJhbWVTaGltKGNhbGxiYWNrKSB7XG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGNhbGxiYWNrLCAxMDAwIC8gNjApO1xuICAgICAgfVxuXG4gICAgICB2YXIga2V5Q291bnRlciA9IDA7XG4gICAgICB2YXIgY29udGV4dHMgPSB7fTtcbiAgICAgIHZhciBXYXlwb2ludCA9IHdpbmRvdy5XYXlwb2ludDtcbiAgICAgIHZhciBvbGRXaW5kb3dMb2FkID0gd2luZG93Lm9ubG9hZDtcblxuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQgKi9cbiAgICAgIGZ1bmN0aW9uIENvbnRleHQoZWxlbWVudCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLkFkYXB0ZXIgPSBXYXlwb2ludC5BZGFwdGVyO1xuICAgICAgICB0aGlzLmFkYXB0ZXIgPSBuZXcgdGhpcy5BZGFwdGVyKGVsZW1lbnQpO1xuICAgICAgICB0aGlzLmtleSA9ICd3YXlwb2ludC1jb250ZXh0LScgKyBrZXlDb3VudGVyO1xuICAgICAgICB0aGlzLmRpZFNjcm9sbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRpZFJlc2l6ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm9sZFNjcm9sbCA9IHtcbiAgICAgICAgICB4OiB0aGlzLmFkYXB0ZXIuc2Nyb2xsTGVmdCgpLFxuICAgICAgICAgIHk6IHRoaXMuYWRhcHRlci5zY3JvbGxUb3AoKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLndheXBvaW50cyA9IHtcbiAgICAgICAgICB2ZXJ0aWNhbDoge30sXG4gICAgICAgICAgaG9yaXpvbnRhbDoge31cbiAgICAgICAgfTtcblxuICAgICAgICBlbGVtZW50LndheXBvaW50Q29udGV4dEtleSA9IHRoaXMua2V5O1xuICAgICAgICBjb250ZXh0c1tlbGVtZW50LndheXBvaW50Q29udGV4dEtleV0gPSB0aGlzO1xuICAgICAgICBrZXlDb3VudGVyICs9IDE7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVUaHJvdHRsZWRTY3JvbGxIYW5kbGVyKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlVGhyb3R0bGVkUmVzaXplSGFuZGxlcigpO1xuICAgICAgfVxuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAod2F5cG9pbnQpIHtcbiAgICAgICAgdmFyIGF4aXMgPSB3YXlwb2ludC5vcHRpb25zLmhvcml6b250YWwgPyAnaG9yaXpvbnRhbCcgOiAndmVydGljYWwnO1xuICAgICAgICB0aGlzLndheXBvaW50c1theGlzXVt3YXlwb2ludC5rZXldID0gd2F5cG9pbnQ7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuY2hlY2tFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhvcml6b250YWxFbXB0eSA9IHRoaXMuQWRhcHRlci5pc0VtcHR5T2JqZWN0KHRoaXMud2F5cG9pbnRzLmhvcml6b250YWwpO1xuICAgICAgICB2YXIgdmVydGljYWxFbXB0eSA9IHRoaXMuQWRhcHRlci5pc0VtcHR5T2JqZWN0KHRoaXMud2F5cG9pbnRzLnZlcnRpY2FsKTtcbiAgICAgICAgaWYgKGhvcml6b250YWxFbXB0eSAmJiB2ZXJ0aWNhbEVtcHR5KSB7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLm9mZignLndheXBvaW50cycpO1xuICAgICAgICAgIGRlbGV0ZSBjb250ZXh0c1t0aGlzLmtleV07XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmNyZWF0ZVRocm90dGxlZFJlc2l6ZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICBmdW5jdGlvbiByZXNpemVIYW5kbGVyKCkge1xuICAgICAgICAgIHNlbGYuaGFuZGxlUmVzaXplKCk7XG4gICAgICAgICAgc2VsZi5kaWRSZXNpemUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYWRhcHRlci5vbigncmVzaXplLndheXBvaW50cycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoIXNlbGYuZGlkUmVzaXplKSB7XG4gICAgICAgICAgICBzZWxmLmRpZFJlc2l6ZSA9IHRydWU7XG4gICAgICAgICAgICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVzaXplSGFuZGxlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmNyZWF0ZVRocm90dGxlZFNjcm9sbEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gc2Nyb2xsSGFuZGxlcigpIHtcbiAgICAgICAgICBzZWxmLmhhbmRsZVNjcm9sbCgpO1xuICAgICAgICAgIHNlbGYuZGlkU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFkYXB0ZXIub24oJ3Njcm9sbC53YXlwb2ludHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKCFzZWxmLmRpZFNjcm9sbCB8fCBXYXlwb2ludC5pc1RvdWNoKSB7XG4gICAgICAgICAgICBzZWxmLmRpZFNjcm9sbCA9IHRydWU7XG4gICAgICAgICAgICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsSGFuZGxlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIENvbnRleHQucHJvdG90eXBlLmhhbmRsZVJlc2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgV2F5cG9pbnQuQ29udGV4dC5yZWZyZXNoQWxsKCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0cmlnZ2VyZWRHcm91cHMgPSB7fTtcbiAgICAgICAgdmFyIGF4ZXMgPSB7XG4gICAgICAgICAgaG9yaXpvbnRhbDoge1xuICAgICAgICAgICAgbmV3U2Nyb2xsOiB0aGlzLmFkYXB0ZXIuc2Nyb2xsTGVmdCgpLFxuICAgICAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC54LFxuICAgICAgICAgICAgZm9yd2FyZDogJ3JpZ2h0JyxcbiAgICAgICAgICAgIGJhY2t3YXJkOiAnbGVmdCdcbiAgICAgICAgICB9LFxuICAgICAgICAgIHZlcnRpY2FsOiB7XG4gICAgICAgICAgICBuZXdTY3JvbGw6IHRoaXMuYWRhcHRlci5zY3JvbGxUb3AoKSxcbiAgICAgICAgICAgIG9sZFNjcm9sbDogdGhpcy5vbGRTY3JvbGwueSxcbiAgICAgICAgICAgIGZvcndhcmQ6ICdkb3duJyxcbiAgICAgICAgICAgIGJhY2t3YXJkOiAndXAnXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAodmFyIGF4aXNLZXkgaW4gYXhlcykge1xuICAgICAgICAgIHZhciBheGlzID0gYXhlc1theGlzS2V5XTtcbiAgICAgICAgICB2YXIgaXNGb3J3YXJkID0gYXhpcy5uZXdTY3JvbGwgPiBheGlzLm9sZFNjcm9sbDtcbiAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gaXNGb3J3YXJkID8gYXhpcy5mb3J3YXJkIDogYXhpcy5iYWNrd2FyZDtcblxuICAgICAgICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIHRoaXMud2F5cG9pbnRzW2F4aXNLZXldKSB7XG4gICAgICAgICAgICB2YXIgd2F5cG9pbnQgPSB0aGlzLndheXBvaW50c1theGlzS2V5XVt3YXlwb2ludEtleV07XG4gICAgICAgICAgICB2YXIgd2FzQmVmb3JlVHJpZ2dlclBvaW50ID0gYXhpcy5vbGRTY3JvbGwgPCB3YXlwb2ludC50cmlnZ2VyUG9pbnQ7XG4gICAgICAgICAgICB2YXIgbm93QWZ0ZXJUcmlnZ2VyUG9pbnQgPSBheGlzLm5ld1Njcm9sbCA+PSB3YXlwb2ludC50cmlnZ2VyUG9pbnQ7XG4gICAgICAgICAgICB2YXIgY3Jvc3NlZEZvcndhcmQgPSB3YXNCZWZvcmVUcmlnZ2VyUG9pbnQgJiYgbm93QWZ0ZXJUcmlnZ2VyUG9pbnQ7XG4gICAgICAgICAgICB2YXIgY3Jvc3NlZEJhY2t3YXJkID0gIXdhc0JlZm9yZVRyaWdnZXJQb2ludCAmJiAhbm93QWZ0ZXJUcmlnZ2VyUG9pbnQ7XG4gICAgICAgICAgICBpZiAoY3Jvc3NlZEZvcndhcmQgfHwgY3Jvc3NlZEJhY2t3YXJkKSB7XG4gICAgICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihkaXJlY3Rpb24pO1xuICAgICAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbd2F5cG9pbnQuZ3JvdXAuaWRdID0gd2F5cG9pbnQuZ3JvdXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgZ3JvdXBLZXkgaW4gdHJpZ2dlcmVkR3JvdXBzKSB7XG4gICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW2dyb3VwS2V5XS5mbHVzaFRyaWdnZXJzKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm9sZFNjcm9sbCA9IHtcbiAgICAgICAgICB4OiBheGVzLmhvcml6b250YWwubmV3U2Nyb2xsLFxuICAgICAgICAgIHk6IGF4ZXMudmVydGljYWwubmV3U2Nyb2xsXG4gICAgICAgIH07XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5pbm5lckhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyplc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi9cbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudCA9PSB0aGlzLmVsZW1lbnQud2luZG93KSB7XG4gICAgICAgICAgcmV0dXJuIFdheXBvaW50LnZpZXdwb3J0SGVpZ2h0KCk7XG4gICAgICAgIH1cbiAgICAgICAgLyplc2xpbnQtZW5hYmxlIGVxZXFlcSAqL1xuICAgICAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmlubmVySGVpZ2h0KCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAod2F5cG9pbnQpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMud2F5cG9pbnRzW3dheXBvaW50LmF4aXNdW3dheXBvaW50LmtleV07XG4gICAgICAgIHRoaXMuY2hlY2tFbXB0eSgpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUuaW5uZXJXaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyplc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi9cbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudCA9PSB0aGlzLmVsZW1lbnQud2luZG93KSB7XG4gICAgICAgICAgcmV0dXJuIFdheXBvaW50LnZpZXdwb3J0V2lkdGgoKTtcbiAgICAgICAgfVxuICAgICAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuaW5uZXJXaWR0aCgpO1xuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvY29udGV4dC1kZXN0cm95ICovXG4gICAgICBDb250ZXh0LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYWxsV2F5cG9pbnRzID0gW107XG4gICAgICAgIGZvciAodmFyIGF4aXMgaW4gdGhpcy53YXlwb2ludHMpIHtcbiAgICAgICAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiB0aGlzLndheXBvaW50c1theGlzXSkge1xuICAgICAgICAgICAgYWxsV2F5cG9pbnRzLnB1c2godGhpcy53YXlwb2ludHNbYXhpc11bd2F5cG9pbnRLZXldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IGFsbFdheXBvaW50cy5sZW5ndGg7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgIGFsbFdheXBvaW50c1tpXS5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQtcmVmcmVzaCAqL1xuICAgICAgQ29udGV4dC5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyplc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi9cbiAgICAgICAgdmFyIGlzV2luZG93ID0gdGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3c7XG4gICAgICAgIC8qZXNsaW50LWVuYWJsZSBlcWVxZXEgKi9cbiAgICAgICAgdmFyIGNvbnRleHRPZmZzZXQgPSBpc1dpbmRvdyA/IHVuZGVmaW5lZCA6IHRoaXMuYWRhcHRlci5vZmZzZXQoKTtcbiAgICAgICAgdmFyIHRyaWdnZXJlZEdyb3VwcyA9IHt9O1xuICAgICAgICB2YXIgYXhlcztcblxuICAgICAgICB0aGlzLmhhbmRsZVNjcm9sbCgpO1xuICAgICAgICBheGVzID0ge1xuICAgICAgICAgIGhvcml6b250YWw6IHtcbiAgICAgICAgICAgIGNvbnRleHRPZmZzZXQ6IGlzV2luZG93ID8gMCA6IGNvbnRleHRPZmZzZXQubGVmdCxcbiAgICAgICAgICAgIGNvbnRleHRTY3JvbGw6IGlzV2luZG93ID8gMCA6IHRoaXMub2xkU2Nyb2xsLngsXG4gICAgICAgICAgICBjb250ZXh0RGltZW5zaW9uOiB0aGlzLmlubmVyV2lkdGgoKSxcbiAgICAgICAgICAgIG9sZFNjcm9sbDogdGhpcy5vbGRTY3JvbGwueCxcbiAgICAgICAgICAgIGZvcndhcmQ6ICdyaWdodCcsXG4gICAgICAgICAgICBiYWNrd2FyZDogJ2xlZnQnLFxuICAgICAgICAgICAgb2Zmc2V0UHJvcDogJ2xlZnQnXG4gICAgICAgICAgfSxcbiAgICAgICAgICB2ZXJ0aWNhbDoge1xuICAgICAgICAgICAgY29udGV4dE9mZnNldDogaXNXaW5kb3cgPyAwIDogY29udGV4dE9mZnNldC50b3AsXG4gICAgICAgICAgICBjb250ZXh0U2Nyb2xsOiBpc1dpbmRvdyA/IDAgOiB0aGlzLm9sZFNjcm9sbC55LFxuICAgICAgICAgICAgY29udGV4dERpbWVuc2lvbjogdGhpcy5pbm5lckhlaWdodCgpLFxuICAgICAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC55LFxuICAgICAgICAgICAgZm9yd2FyZDogJ2Rvd24nLFxuICAgICAgICAgICAgYmFja3dhcmQ6ICd1cCcsXG4gICAgICAgICAgICBvZmZzZXRQcm9wOiAndG9wJ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBheGlzS2V5IGluIGF4ZXMpIHtcbiAgICAgICAgICB2YXIgYXhpcyA9IGF4ZXNbYXhpc0tleV07XG4gICAgICAgICAgZm9yICh2YXIgd2F5cG9pbnRLZXkgaW4gdGhpcy53YXlwb2ludHNbYXhpc0tleV0pIHtcbiAgICAgICAgICAgIHZhciB3YXlwb2ludCA9IHRoaXMud2F5cG9pbnRzW2F4aXNLZXldW3dheXBvaW50S2V5XTtcbiAgICAgICAgICAgIHZhciBhZGp1c3RtZW50ID0gd2F5cG9pbnQub3B0aW9ucy5vZmZzZXQ7XG4gICAgICAgICAgICB2YXIgb2xkVHJpZ2dlclBvaW50ID0gd2F5cG9pbnQudHJpZ2dlclBvaW50O1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRPZmZzZXQgPSAwO1xuICAgICAgICAgICAgdmFyIGZyZXNoV2F5cG9pbnQgPSBvbGRUcmlnZ2VyUG9pbnQgPT0gbnVsbDtcbiAgICAgICAgICAgIHZhciBjb250ZXh0TW9kaWZpZXIsIHdhc0JlZm9yZVNjcm9sbCwgbm93QWZ0ZXJTY3JvbGw7XG4gICAgICAgICAgICB2YXIgdHJpZ2dlcmVkQmFja3dhcmQsIHRyaWdnZXJlZEZvcndhcmQ7XG5cbiAgICAgICAgICAgIGlmICh3YXlwb2ludC5lbGVtZW50ICE9PSB3YXlwb2ludC5lbGVtZW50LndpbmRvdykge1xuICAgICAgICAgICAgICBlbGVtZW50T2Zmc2V0ID0gd2F5cG9pbnQuYWRhcHRlci5vZmZzZXQoKVtheGlzLm9mZnNldFByb3BdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFkanVzdG1lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgYWRqdXN0bWVudCA9IGFkanVzdG1lbnQuYXBwbHkod2F5cG9pbnQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWRqdXN0bWVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgYWRqdXN0bWVudCA9IHBhcnNlRmxvYXQoYWRqdXN0bWVudCk7XG4gICAgICAgICAgICAgIGlmICh3YXlwb2ludC5vcHRpb25zLm9mZnNldC5pbmRleE9mKCclJykgPiAtMSkge1xuICAgICAgICAgICAgICAgIGFkanVzdG1lbnQgPSBNYXRoLmNlaWwoYXhpcy5jb250ZXh0RGltZW5zaW9uICogYWRqdXN0bWVudCAvIDEwMCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udGV4dE1vZGlmaWVyID0gYXhpcy5jb250ZXh0U2Nyb2xsIC0gYXhpcy5jb250ZXh0T2Zmc2V0O1xuICAgICAgICAgICAgd2F5cG9pbnQudHJpZ2dlclBvaW50ID0gZWxlbWVudE9mZnNldCArIGNvbnRleHRNb2RpZmllciAtIGFkanVzdG1lbnQ7XG4gICAgICAgICAgICB3YXNCZWZvcmVTY3JvbGwgPSBvbGRUcmlnZ2VyUG9pbnQgPCBheGlzLm9sZFNjcm9sbDtcbiAgICAgICAgICAgIG5vd0FmdGVyU2Nyb2xsID0gd2F5cG9pbnQudHJpZ2dlclBvaW50ID49IGF4aXMub2xkU2Nyb2xsO1xuICAgICAgICAgICAgdHJpZ2dlcmVkQmFja3dhcmQgPSB3YXNCZWZvcmVTY3JvbGwgJiYgbm93QWZ0ZXJTY3JvbGw7XG4gICAgICAgICAgICB0cmlnZ2VyZWRGb3J3YXJkID0gIXdhc0JlZm9yZVNjcm9sbCAmJiAhbm93QWZ0ZXJTY3JvbGw7XG5cbiAgICAgICAgICAgIGlmICghZnJlc2hXYXlwb2ludCAmJiB0cmlnZ2VyZWRCYWNrd2FyZCkge1xuICAgICAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoYXhpcy5iYWNrd2FyZCk7XG4gICAgICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWZyZXNoV2F5cG9pbnQgJiYgdHJpZ2dlcmVkRm9yd2FyZCkge1xuICAgICAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoYXhpcy5mb3J3YXJkKTtcbiAgICAgICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmcmVzaFdheXBvaW50ICYmIGF4aXMub2xkU2Nyb2xsID49IHdheXBvaW50LnRyaWdnZXJQb2ludCkge1xuICAgICAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoYXhpcy5mb3J3YXJkKTtcbiAgICAgICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZm9yICh2YXIgZ3JvdXBLZXkgaW4gdHJpZ2dlcmVkR3JvdXBzKSB7XG4gICAgICAgICAgICB0cmlnZ2VyZWRHcm91cHNbZ3JvdXBLZXldLmZsdXNoVHJpZ2dlcnMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5maW5kT3JDcmVhdGVCeUVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gQ29udGV4dC5maW5kQnlFbGVtZW50KGVsZW1lbnQpIHx8IG5ldyBDb250ZXh0KGVsZW1lbnQpO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgQ29udGV4dC5yZWZyZXNoQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBjb250ZXh0SWQgaW4gY29udGV4dHMpIHtcbiAgICAgICAgICBjb250ZXh0c1tjb250ZXh0SWRdLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLyogUHVibGljICovXG4gICAgICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvY29udGV4dC1maW5kLWJ5LWVsZW1lbnQgKi9cbiAgICAgIENvbnRleHQuZmluZEJ5RWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBjb250ZXh0c1tlbGVtZW50LndheXBvaW50Q29udGV4dEtleV07XG4gICAgICB9O1xuXG4gICAgICB3aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAob2xkV2luZG93TG9hZCkge1xuICAgICAgICAgIG9sZFdpbmRvd0xvYWQoKTtcbiAgICAgICAgfVxuICAgICAgICBDb250ZXh0LnJlZnJlc2hBbGwoKTtcbiAgICAgIH07XG5cbiAgICAgIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgcmVxdWVzdEZuID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lU2hpbTtcbiAgICAgICAgcmVxdWVzdEZuLmNhbGwod2luZG93LCBjYWxsYmFjayk7XG4gICAgICB9O1xuICAgICAgV2F5cG9pbnQuQ29udGV4dCA9IENvbnRleHQ7XG4gICAgfSkoKTsoZnVuY3Rpb24gKCkge1xuICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICBmdW5jdGlvbiBieVRyaWdnZXJQb2ludChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhLnRyaWdnZXJQb2ludCAtIGIudHJpZ2dlclBvaW50O1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBieVJldmVyc2VUcmlnZ2VyUG9pbnQoYSwgYikge1xuICAgICAgICByZXR1cm4gYi50cmlnZ2VyUG9pbnQgLSBhLnRyaWdnZXJQb2ludDtcbiAgICAgIH1cblxuICAgICAgdmFyIGdyb3VwcyA9IHtcbiAgICAgICAgdmVydGljYWw6IHt9LFxuICAgICAgICBob3Jpem9udGFsOiB7fVxuICAgICAgfTtcbiAgICAgIHZhciBXYXlwb2ludCA9IHdpbmRvdy5XYXlwb2ludDtcblxuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2dyb3VwICovXG4gICAgICBmdW5jdGlvbiBHcm91cChvcHRpb25zKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5heGlzID0gb3B0aW9ucy5heGlzO1xuICAgICAgICB0aGlzLmlkID0gdGhpcy5uYW1lICsgJy0nICsgdGhpcy5heGlzO1xuICAgICAgICB0aGlzLndheXBvaW50cyA9IFtdO1xuICAgICAgICB0aGlzLmNsZWFyVHJpZ2dlclF1ZXVlcygpO1xuICAgICAgICBncm91cHNbdGhpcy5heGlzXVt0aGlzLm5hbWVdID0gdGhpcztcbiAgICAgIH1cblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh3YXlwb2ludCkge1xuICAgICAgICB0aGlzLndheXBvaW50cy5wdXNoKHdheXBvaW50KTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFByaXZhdGUgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5jbGVhclRyaWdnZXJRdWV1ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudHJpZ2dlclF1ZXVlcyA9IHtcbiAgICAgICAgICB1cDogW10sXG4gICAgICAgICAgZG93bjogW10sXG4gICAgICAgICAgbGVmdDogW10sXG4gICAgICAgICAgcmlnaHQ6IFtdXG4gICAgICAgIH07XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5wcm90b3R5cGUuZmx1c2hUcmlnZ2VycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgZGlyZWN0aW9uIGluIHRoaXMudHJpZ2dlclF1ZXVlcykge1xuICAgICAgICAgIHZhciB3YXlwb2ludHMgPSB0aGlzLnRyaWdnZXJRdWV1ZXNbZGlyZWN0aW9uXTtcbiAgICAgICAgICB2YXIgcmV2ZXJzZSA9IGRpcmVjdGlvbiA9PT0gJ3VwJyB8fCBkaXJlY3Rpb24gPT09ICdsZWZ0JztcbiAgICAgICAgICB3YXlwb2ludHMuc29ydChyZXZlcnNlID8gYnlSZXZlcnNlVHJpZ2dlclBvaW50IDogYnlUcmlnZ2VyUG9pbnQpO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSB3YXlwb2ludHMubGVuZ3RoOyBpIDwgZW5kOyBpICs9IDEpIHtcbiAgICAgICAgICAgIHZhciB3YXlwb2ludCA9IHdheXBvaW50c1tpXTtcbiAgICAgICAgICAgIGlmICh3YXlwb2ludC5vcHRpb25zLmNvbnRpbnVvdXMgfHwgaSA9PT0gd2F5cG9pbnRzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgd2F5cG9pbnQudHJpZ2dlcihbZGlyZWN0aW9uXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xlYXJUcmlnZ2VyUXVldWVzKCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh3YXlwb2ludCkge1xuICAgICAgICB0aGlzLndheXBvaW50cy5zb3J0KGJ5VHJpZ2dlclBvaW50KTtcbiAgICAgICAgdmFyIGluZGV4ID0gV2F5cG9pbnQuQWRhcHRlci5pbkFycmF5KHdheXBvaW50LCB0aGlzLndheXBvaW50cyk7XG4gICAgICAgIHZhciBpc0xhc3QgPSBpbmRleCA9PT0gdGhpcy53YXlwb2ludHMubGVuZ3RoIC0gMTtcbiAgICAgICAgcmV0dXJuIGlzTGFzdCA/IG51bGwgOiB0aGlzLndheXBvaW50c1tpbmRleCArIDFdO1xuICAgICAgfTtcblxuICAgICAgLyogUHJpdmF0ZSAqL1xuICAgICAgR3JvdXAucHJvdG90eXBlLnByZXZpb3VzID0gZnVuY3Rpb24gKHdheXBvaW50KSB7XG4gICAgICAgIHRoaXMud2F5cG9pbnRzLnNvcnQoYnlUcmlnZ2VyUG9pbnQpO1xuICAgICAgICB2YXIgaW5kZXggPSBXYXlwb2ludC5BZGFwdGVyLmluQXJyYXkod2F5cG9pbnQsIHRoaXMud2F5cG9pbnRzKTtcbiAgICAgICAgcmV0dXJuIGluZGV4ID8gdGhpcy53YXlwb2ludHNbaW5kZXggLSAxXSA6IG51bGw7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5wcm90b3R5cGUucXVldWVUcmlnZ2VyID0gZnVuY3Rpb24gKHdheXBvaW50LCBkaXJlY3Rpb24pIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyUXVldWVzW2RpcmVjdGlvbl0ucHVzaCh3YXlwb2ludCk7XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHdheXBvaW50KSB7XG4gICAgICAgIHZhciBpbmRleCA9IFdheXBvaW50LkFkYXB0ZXIuaW5BcnJheSh3YXlwb2ludCwgdGhpcy53YXlwb2ludHMpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgIHRoaXMud2F5cG9pbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2ZpcnN0ICovXG4gICAgICBHcm91cC5wcm90b3R5cGUuZmlyc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLndheXBvaW50c1swXTtcbiAgICAgIH07XG5cbiAgICAgIC8qIFB1YmxpYyAqL1xuICAgICAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2xhc3QgKi9cbiAgICAgIEdyb3VwLnByb3RvdHlwZS5sYXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy53YXlwb2ludHNbdGhpcy53YXlwb2ludHMubGVuZ3RoIC0gMV07XG4gICAgICB9O1xuXG4gICAgICAvKiBQcml2YXRlICovXG4gICAgICBHcm91cC5maW5kT3JDcmVhdGUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gZ3JvdXBzW29wdGlvbnMuYXhpc11bb3B0aW9ucy5uYW1lXSB8fCBuZXcgR3JvdXAob3B0aW9ucyk7XG4gICAgICB9O1xuXG4gICAgICBXYXlwb2ludC5Hcm91cCA9IEdyb3VwO1xuICAgIH0pKCk7KGZ1bmN0aW9uICgpIHtcbiAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgdmFyIFdheXBvaW50ID0gd2luZG93LldheXBvaW50O1xuXG4gICAgICBmdW5jdGlvbiBpc1dpbmRvdyhlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50ID09PSBlbGVtZW50LndpbmRvdztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZ2V0V2luZG93KGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKGlzV2luZG93KGVsZW1lbnQpKSB7XG4gICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQuZGVmYXVsdFZpZXc7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIE5vRnJhbWV3b3JrQWRhcHRlcihlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSB7fTtcbiAgICAgIH1cblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5pbm5lckhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlzV2luID0gaXNXaW5kb3codGhpcy5lbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIGlzV2luID8gdGhpcy5lbGVtZW50LmlubmVySGVpZ2h0IDogdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodDtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuaW5uZXJXaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlzV2luID0gaXNXaW5kb3codGhpcy5lbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIGlzV2luID8gdGhpcy5lbGVtZW50LmlubmVyV2lkdGggOiB0aGlzLmVsZW1lbnQuY2xpZW50V2lkdGg7XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChldmVudCwgaGFuZGxlcikge1xuICAgICAgICBmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgbGlzdGVuZXJzLCBoYW5kbGVyKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IGxpc3RlbmVycy5sZW5ndGggLSAxOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXTtcbiAgICAgICAgICAgIGlmICghaGFuZGxlciB8fCBoYW5kbGVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIobGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBldmVudFBhcnRzID0gZXZlbnQuc3BsaXQoJy4nKTtcbiAgICAgICAgdmFyIGV2ZW50VHlwZSA9IGV2ZW50UGFydHNbMF07XG4gICAgICAgIHZhciBuYW1lc3BhY2UgPSBldmVudFBhcnRzWzFdO1xuICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcblxuICAgICAgICBpZiAobmFtZXNwYWNlICYmIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSAmJiBldmVudFR5cGUpIHtcbiAgICAgICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW2V2ZW50VHlwZV0sIGhhbmRsZXIpO1xuICAgICAgICAgIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXVtldmVudFR5cGVdID0gW107XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnRUeXBlKSB7XG4gICAgICAgICAgZm9yICh2YXIgbnMgaW4gdGhpcy5oYW5kbGVycykge1xuICAgICAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIHRoaXMuaGFuZGxlcnNbbnNdW2V2ZW50VHlwZV0gfHwgW10sIGhhbmRsZXIpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVyc1tuc11bZXZlbnRUeXBlXSA9IFtdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChuYW1lc3BhY2UgJiYgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdKSB7XG4gICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0pIHtcbiAgICAgICAgICAgIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV1bdHlwZV0sIGhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmhhbmRsZXJzW25hbWVzcGFjZV0gPSB7fTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLyogQWRhcHRlZCBmcm9tIGpRdWVyeSAxLnggb2Zmc2V0KCkgKi9cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub2Zmc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZG9jdW1lbnRFbGVtZW50ID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgICB2YXIgd2luID0gZ2V0V2luZG93KHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50KTtcbiAgICAgICAgdmFyIHJlY3QgPSB7XG4gICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCkge1xuICAgICAgICAgIHJlY3QgPSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRvcDogcmVjdC50b3AgKyB3aW4ucGFnZVlPZmZzZXQgLSBkb2N1bWVudEVsZW1lbnQuY2xpZW50VG9wLFxuICAgICAgICAgIGxlZnQ6IHJlY3QubGVmdCArIHdpbi5wYWdlWE9mZnNldCAtIGRvY3VtZW50RWxlbWVudC5jbGllbnRMZWZ0XG4gICAgICAgIH07XG4gICAgICB9O1xuXG4gICAgICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgICAgIHZhciBldmVudFBhcnRzID0gZXZlbnQuc3BsaXQoJy4nKTtcbiAgICAgICAgdmFyIGV2ZW50VHlwZSA9IGV2ZW50UGFydHNbMF07XG4gICAgICAgIHZhciBuYW1lc3BhY2UgPSBldmVudFBhcnRzWzFdIHx8ICdfX2RlZmF1bHQnO1xuICAgICAgICB2YXIgbnNIYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSA9IHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSB8fCB7fTtcbiAgICAgICAgdmFyIG5zVHlwZUxpc3QgPSBuc0hhbmRsZXJzW2V2ZW50VHlwZV0gPSBuc0hhbmRsZXJzW2V2ZW50VHlwZV0gfHwgW107XG5cbiAgICAgICAgbnNUeXBlTGlzdC5wdXNoKGhhbmRsZXIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGhhbmRsZXIpO1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vdXRlckhlaWdodCA9IGZ1bmN0aW9uIChpbmNsdWRlTWFyZ2luKSB7XG4gICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmlubmVySGVpZ2h0KCk7XG4gICAgICAgIHZhciBjb21wdXRlZFN0eWxlO1xuXG4gICAgICAgIGlmIChpbmNsdWRlTWFyZ2luICYmICFpc1dpbmRvdyh0aGlzLmVsZW1lbnQpKSB7XG4gICAgICAgICAgY29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCk7XG4gICAgICAgICAgaGVpZ2h0ICs9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUubWFyZ2luVG9wLCAxMCk7XG4gICAgICAgICAgaGVpZ2h0ICs9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUubWFyZ2luQm90dG9tLCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaGVpZ2h0O1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vdXRlcldpZHRoID0gZnVuY3Rpb24gKGluY2x1ZGVNYXJnaW4pIHtcbiAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5pbm5lcldpZHRoKCk7XG4gICAgICAgIHZhciBjb21wdXRlZFN0eWxlO1xuXG4gICAgICAgIGlmIChpbmNsdWRlTWFyZ2luICYmICFpc1dpbmRvdyh0aGlzLmVsZW1lbnQpKSB7XG4gICAgICAgICAgY29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCk7XG4gICAgICAgICAgd2lkdGggKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5MZWZ0LCAxMCk7XG4gICAgICAgICAgd2lkdGggKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5SaWdodCwgMTApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHdpZHRoO1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5zY3JvbGxMZWZ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgd2luID0gZ2V0V2luZG93KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHJldHVybiB3aW4gPyB3aW4ucGFnZVhPZmZzZXQgOiB0aGlzLmVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuc2Nyb2xsVG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgd2luID0gZ2V0V2luZG93KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHJldHVybiB3aW4gPyB3aW4ucGFnZVlPZmZzZXQgOiB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLmV4dGVuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuXG4gICAgICAgIGZ1bmN0aW9uIG1lcmdlKHRhcmdldCwgb2JqKSB7XG4gICAgICAgICAgaWYgKCh0eXBlb2YgdGFyZ2V0ID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YodGFyZ2V0KSkgPT09ICdvYmplY3QnICYmICh0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2Yob2JqKSkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDEsIGVuZCA9IGFyZ3MubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICBtZXJnZShhcmdzWzBdLCBhcmdzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJnc1swXTtcbiAgICAgIH07XG5cbiAgICAgIE5vRnJhbWV3b3JrQWRhcHRlci5pbkFycmF5ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGFycmF5LCBpKSB7XG4gICAgICAgIHJldHVybiBhcnJheSA9PSBudWxsID8gLTEgOiBhcnJheS5pbmRleE9mKGVsZW1lbnQsIGkpO1xuICAgICAgfTtcblxuICAgICAgTm9GcmFtZXdvcmtBZGFwdGVyLmlzRW1wdHlPYmplY3QgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIC8qIGVzbGludCBuby11bnVzZWQtdmFyczogMCAqL1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIG9iaikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG5cbiAgICAgIFdheXBvaW50LmFkYXB0ZXJzLnB1c2goe1xuICAgICAgICBuYW1lOiAnbm9mcmFtZXdvcmsnLFxuICAgICAgICBBZGFwdGVyOiBOb0ZyYW1ld29ya0FkYXB0ZXJcbiAgICAgIH0pO1xuICAgICAgV2F5cG9pbnQuQWRhcHRlciA9IE5vRnJhbWV3b3JrQWRhcHRlcjtcbiAgICB9KSgpO1xuICB9LCB7fV0gfSwge30sIFsxXSk7IiwiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpfXZhciBmPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGYsZi5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnXG5cbnJlcXVpcmUoJy4uL25vZGVfbW9kdWxlcy93YXlwb2ludHMvbGliL25vZnJhbWV3b3JrLndheXBvaW50cycpO1xuXG5sZXQgZG9jU3R5bGUgPSBkb2N1bWVudC5ib2R5LnN0eWxlO1xubGV0IGJnUGF0aCA9IGRvY3VtZW50LmxvY2F0aW9uICsgJ2ltYWdlcy9iZy8nO1xubGV0IGltZ0V4dCA9ICcucG5nJztcbmxldCBiZ3MgPSBbJ0ZlYXRoZXJfV0hJVEVfVXBkYXRlZCcsICdEdWNrUHJpbnRzX09yYW5nZScvKiwgJ1dhbGxQYXBlcjIuNScsICdXYWxsUGFwZXIzJywgJ1dhbGxQYXBlcjMuNScsICdXYWxsUGFwZXI0JywgJ1dhbGxQYXBlcjQuNScsICdXYWxsUGFwZXI1LjUnLCAnV2FsbFBhcGVyNS41X3RvbmUnLCdXYWxsUGFwZXI2JywgJ1dhbGxQYXBlcjYuNScsICdXYWxsUGFwZXI3LjUnLCAnV2FsbFBhcGVyNy41X3RvbmUnKi9dO1xubGV0IGJnSW1hZ2VzTG9hZGVkID0gZmFsc2U7XG5sZXQgY2F0ZWdvcnlTZWN0aW9ucyA9IFsnc20tbmV3LWVtcGxveWVlcy1jb250YWluZXInLCAnc20tY3VycmVudC1lbXBsb3llZXMtY29udGFpbmVyJywgJ3NtLWV4aXRpbmctZW1wbG95ZWVzLWNvbnRhaW5lcicsICdzbS1jYWRpbGxhYy10YXgtY29udGFpbmVyJywgJ3NtLXBlbmFsdGllcy1jb250YWluZXInLCAnc20tYmVuZWZpdHMtcmVxdWlyZW1lbnRzLWNvbnRhaW5lcicsICdzbS12b2x1bnRhcnktaW5zdXJhbmNlLWNvbnRhaW5lcicsICdzbS1leGNoYW5nZXMtY29udGFpbmVyJywgJ3NtLXdoYXRzLW5leHQtY29udGFpbmVyJywgJ25ldy1lbXBsb3llZXMtY29udGFpbmVyJywgJ2N1cnJlbnQtZW1wbG95ZWVzLWNvbnRhaW5lcicsICdleGl0aW5nLWVtcGxveWVlcy1jb250YWluZXInLCAnY2FkaWxsYWMtdGF4LWNvbnRhaW5lcicsICdwZW5hbHRpZXMtY29udGFpbmVyJywgJ2JlbmVmaXRzLXJlcXVpcmVtZW50cy1jb250YWluZXInLCAndm9sdW50YXJ5LWluc3VyYW5jZS1jb250YWluZXInLCAnZXhjaGFuZ2VzLWNvbnRhaW5lcicsICd3aGF0cy1uZXh0LWNvbnRhaW5lciddO1xuXG5jb25zdCBsb2FkV2F5cG9pbnRzID0gZnVuY3Rpb24gKCkge1xuICAgIG5ldyBXYXlwb2ludCh7XG4gICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbS1iZW5lZml0cy1yZXF1aXJlbWVudHMnKSxcbiAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCk7XG4gICAgICAgICAgICBqUXVlcnkoJyNzbS1iZW5lZml0cy1yZXF1aXJlbWVudHM6bm90KC5zaG93biknKS5hZGRDbGFzcygnYW5pbWF0ZWQgYm91bmNlSW5Eb3duIHNob3duJyk7XG4gICAgICAgICAgICBqUXVlcnkoJyNzbS1iZW5lZml0cy1yZXF1aXJlbWVudHMnKS5vbmUoJ3dlYmtpdEFuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIG1zQW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBqUXVlcnkoJyNzbS1iZW5lZml0cy1yZXF1aXJlbWVudHMnKS5yZW1vdmVDbGFzcygnYW5pbWF0ZWQgYm91bmNlSW5Eb3duJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vZGlyZWN0aW9uID09PSAnZG93bicgPyBsb2FkQmcoaW5kZXggKyAxKSA6IGxvYWRCZyhpbmRleCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9mZnNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQgKiAyO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBQZW5hbHRpZXNcbiAgICBuZXcgV2F5cG9pbnQoe1xuICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc20tcGVuYWx0aWVzJyksXG4gICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQpO1xuICAgICAgICAgICAgalF1ZXJ5KCcjc20tcGVuYWx0aWVzOm5vdCguc2hvd24pJykuYWRkQ2xhc3MoJ2FuaW1hdGVkIHpvb21JblVwIHNob3duJyk7XG4gICAgICAgICAgICBqUXVlcnkoJyNzbS1wZW5hbHRpZXMnKS5vbmUoJ3dlYmtpdEFuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIG1zQW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBqUXVlcnkoJyNzbS1wZW5hbHRpZXMnKS5yZW1vdmVDbGFzcygnYW5pbWF0ZWQgem9vbUluVXAgICcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL2RpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICB9LFxuICAgICAgICBvZmZzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICogMjtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQ2FkaWxsYWMgVGF4XG4gICAgbmV3IFdheXBvaW50KHtcbiAgICAgICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NtLWNhZGlsbGFjLXRheCcpLFxuICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0KTtcbiAgICAgICAgICAgIGpRdWVyeSgnI3NtLWNhZGlsbGFjLXRheDpub3QoLnNob3duKScpLmFkZENsYXNzKCdhbmltYXRlZCB6b29tSW4gc2hvd24nKTtcbiAgICAgICAgICAgIGpRdWVyeSgnI3NtLWNhZGlsbGFjLXRheCcpLm9uZSgnd2Via2l0QW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgbXNBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGpRdWVyeSgnI3NtLWNhZGlsbGFjLXRheCcpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCB6b29tSW4gICcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL2RpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICB9LFxuICAgICAgICBvZmZzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICogMjtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4vLyBFeGNoYW5nZXNcbiAgICBuZXcgV2F5cG9pbnQoe1xuICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc20tZXhjaGFuZ2VzJyksXG4gICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdoZXJlJyk7XG4gICAgICAgICAgICBqUXVlcnkoJyNzbS1leGNoYW5nZXM6bm90KC5zaG93biknKS5hZGRDbGFzcygnYW5pbWF0ZWQgcm90YXRlSW4gc2hvd24nKTtcbiAgICAgICAgICAgIGpRdWVyeSgnI3NtLWV4Y2hhbmdlcycpLm9uZSgnd2Via2l0QW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgbXNBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGpRdWVyeSgnI3NtLWV4Y2hhbmdlcycpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCByb3RhdGVJbicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL2RpcmVjdGlvbiA9PT0gJ2Rvd24nID8gbG9hZEJnKGluZGV4ICsgMSkgOiBsb2FkQmcoaW5kZXgpO1xuICAgICAgICB9LFxuICAgICAgICBvZmZzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICogMjtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4vLyB2b2x1bnRhcnkgaW5zdXJhbmNlXG4gICAgbmV3IFdheXBvaW50KHtcbiAgICAgICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NtLXZvbHVudGFyeS1pbnN1cmFuY2UnKSxcbiAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2hlcmUnKTtcbiAgICAgICAgICAgIGpRdWVyeSgnI3NtLXZvbHVudGFyeS1pbnN1cmFuY2U6bm90KC5zaG93biknKS5hZGRDbGFzcygnYW5pbWF0ZWQgc2xpZGVJblVwIHNob3duJyk7XG4gICAgICAgICAgICBqUXVlcnkoJyNzbS12b2x1bnRhcnktaW5zdXJhbmNlJykub25lKCd3ZWJraXRBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBtc0FuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KCcjc20tdm9sdW50YXJ5LWluc3VyYW5jZScpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBzbGlkZUluVXAnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy9kaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbiAgICAgICAgfSxcbiAgICAgICAgb2Zmc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCAqIDI7XG4gICAgICAgIH1cbiAgICB9KTtcbi8vIHdoYXQncyBuZXh0IGluc3VyYW5jZVxuICAgIG5ldyBXYXlwb2ludCh7XG4gICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbS13aGF0cy1uZXh0JyksXG4gICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdoZXJlJyk7XG4gICAgICAgICAgICBqUXVlcnkoJyNzbS13aGF0cy1uZXh0Om5vdCguc2hvd24pJykuYWRkQ2xhc3MoJ2FuaW1hdGVkIGJvdW5jZUluVXAgc2hvd24nKTtcbiAgICAgICAgICAgIGpRdWVyeSgnI3NtLXdoYXRzLW5leHQnKS5vbmUoJ3dlYmtpdEFuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIG1zQW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBqUXVlcnkoJyNzbS13aGF0cy1uZXh0JykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkIGJvdW5jZUluVXAnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy9kaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbiAgICAgICAgfSxcbiAgICAgICAgb2Zmc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCAqIDI7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuLy8gVXRpbGl0eVxuLy8gc2V0dXAgd2F5cG9pbnRzXG53aW5kb3cud2F5cG9pbnRzID0gW107XG5jYXRlZ29yeVNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4KSB7XG4gICAgY29uc29sZS5sb2coYC4ke2VsZW1lbnR9YCk7XG4gICAgd2luZG93LndheXBvaW50c1tpbmRleF0gPSBuZXcgV2F5cG9pbnQoe1xuICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtlbGVtZW50fWApLFxuICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbG9hZGluZy4uLicpXG4gICAgICAgICAgICBsb2FkQmcoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMikpO1xuICAgICAgICAgICAgLy9kaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbiAgICAgICAgfSxcbiAgICB9KVxufSk7XG5cbi8vIHByZWxvYWQgaW1hZ2VzXG5pZiAoYmdJbWFnZXNMb2FkZWQgIT09IHRydWUpIHtcbiAgICBiZ3MuZm9yRWFjaChmdW5jdGlvbiAoYmcpIHtcbiAgICAgICAgbmV3IEltYWdlKCkuc3JjID0gYmdQYXRoICsgYmcgKyBpbWdFeHQ7XG4gICAgICAgIC8vIGNhY2hlcyBpbWFnZXMsIGF2b2lkaW5nIHdoaXRlIGZsYXNoIGJldHdlZW4gYmFja2dyb3VuZCByZXBsYWNlbWVudHNcbiAgICB9KTtcbiAgICBiZ0ltYWdlc0xvYWRlZCA9IHRydWU7XG59XG4vLyBsb2FkIGJnIGltYWdlXG5jb25zdCBsb2FkQmcgPSBmdW5jdGlvbiAoYmcpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZG9jU3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke2JnUGF0aH0ke2Jnc1tiZ119JHtpbWdFeHR9KWA7XG4gICAgICAgIGNvbnNvbGUubG9nKGBsb2FkaW5nICR7YmdQYXRofSR7YmdzW2JnXX0ke2ltZ0V4dH1gKVxuICAgIH0sIDEwMClcbn1cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBidXNpbmVzcyBzZWxlY3QgYnV0dG9uc1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbnZhciBidXNpbmVzc1NlbGVjdCA9IGpRdWVyeSgnLmJ1c2luZXNzLXR5cGUtc2VsZWN0Jyk7XG5idXNpbmVzc1NlbGVjdC5lYWNoKGZ1bmN0aW9uIChpLCBlbCkge1xuICAgIGNvbnNvbGUubG9nKGVsKTtcbiAgICBqUXVlcnkoZWwpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coZWwpO1xuICAgICAgICBqUXVlcnkoJy5oY3ItbWVudS1pdGVtJykuaGlkZSgpO1xuICAgICAgICBpZiAoZWwuZGF0YXNldC5idXNpbmVzcyA9PT0gJ2J1c2luZXNzLTUwJykge1xuICAgICAgICAgICAgalF1ZXJ5KCdhLnNtJykucGFyZW50KCkuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgalF1ZXJ5KCdhLmxnJykucGFyZW50KCkuc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0ID0gJyc7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChgJHtlbC5kYXRhc2V0LmJ1c2luZXNzfS1hY3RpdmVgKVxuICAgICAgICAvLyBnZXQgdGhlIGFjdGl2ZSBtZW51IGl0ZW0gYW5kIHR1cm4gaXQgb2ZmXG4gICAgICAgIGxldCBjdXJyZW50QWN0aXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1c2luZXNzLXR5cGUtc2VsZWN0LmFjdGl2ZScpO1xuICAgICAgICBpZiAoY3VycmVudEFjdGl2ZSkge1xuICAgICAgICAgICAgY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0dXJuIG9uIHRoZSBuZXcgbWVudSBpdGVtXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgICAgIC8vIHNob3cgdGhlIG5hdlxuICAgICAgICBsZXQgbWVudXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGNyLW1lbnUnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZW51cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWVudXNbaV0uc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgfVxuICAgICAgICBmb2xkTWVudS5hY2NvcmRpb24oMCwgJ3RvcCcsIGZ1bmN0aW9uIChldiwgb3JpKSB7XG4gICAgICAgICAgICBvcmkuZWwuY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXYsIG9yaSk7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgY3VycmVudFZpc2libGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVzaW5lc3MtY29udGFpbmVyLnZpc2libGUnKTtcbiAgICAgICAgaWYgKGN1cnJlbnRWaXNpYmxlKSB7XG4gICAgICAgICAgICBjdXJyZW50VmlzaWJsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgY3VycmVudFZpc2libGUuY2xhc3NMaXN0LnJlbW92ZSgndmlzaWJsZScpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBzZWN0aW9uVG9TaG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7ZWwuZGF0YXNldC5idXNpbmVzc30tY29udGFpbmVyYCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHNlY3Rpb25Ub1Nob3cpO1xuICAgICAgICBqUXVlcnkoc2VjdGlvblRvU2hvdykuZmFkZUluKCk7XG4gICAgICAgIHNlY3Rpb25Ub1Nob3cuY2xhc3NMaXN0LmFkZCgndmlzaWJsZScpO1xuICAgICAgICBqUXVlcnkoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgICAgIHNjcm9sbFRvcDogalF1ZXJ5KHNlY3Rpb25Ub1Nob3cpLm9mZnNldCgpLnRvcFxuICAgICAgICB9LCAxMDAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBqUXVlcnkoc2VjdGlvblRvU2hvdykuZmluZCgnaDMnKS5hZGRDbGFzcygnYW5pbWF0ZWQnKS5hZGRDbGFzcygncHVsc2UnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxvYWRCZyhNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKSArIDApO1xuXG4gICAgICAgIGxvYWRXYXlwb2ludHMoKTtcblxuLy8gVXRpbGl0eVxuLy8gc2V0dXAgd2F5cG9pbnRzXG4gICAgICAgIHdpbmRvdy53YXlwb2ludHMgPSBbXTtcbiAgICAgICAgY2F0ZWdvcnlTZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYC4ke2VsZW1lbnR9YCk7XG4gICAgICAgICAgICB3aW5kb3cud2F5cG9pbnRzW2luZGV4XSA9IG5ldyBXYXlwb2ludCh7XG4gICAgICAgICAgICAgICAgZWxlbWVudDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7ZWxlbWVudH1gKSxcbiAgICAgICAgICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2FkaW5nLi4uJylcbiAgICAgICAgICAgICAgICAgICAgbG9hZEJnKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpKTtcbiAgICAgICAgICAgICAgICAgICAgLy9kaXJlY3Rpb24gPT09ICdkb3duJyA/IGxvYWRCZyhpbmRleCArIDEpIDogbG9hZEJnKGluZGV4KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcblxuLy8vLy8vLy8vLy9cbi8vIGhjciBtZW51XG4vLy8vLy8vLy8vL1xubGV0IGZvbGRNZW51ID0gbmV3IE9yaURvbWkoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhjci1tZW51JyksIHtcbiAgICBoUGFuZWxzOiAzLFxuICAgIHJpcHBsZTogMixcbiAgICBzaGFkaW5nOiAnaGFyZCcsXG4gICAgdG91Y2hFbmFibGVkOiBmYWxzZVxufSk7XG4vLyBsb2FkXG5mb2xkTWVudS5mb2xkVXAoJ3RvcCcpO1xuXG4vLyBjbGlja1xubGV0IGhjck1lbnVJdGVtTGluayA9IGpRdWVyeSgnLmhjci1tZW51LWl0ZW0gYScpO1xuaGNyTWVudUl0ZW1MaW5rLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlLCBlbCkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zb2xlLmxvZyhgLiR7ZS50YXJnZXQuaHJlZi5zcGxpdCgnIycpWzFdfWApO1xuICAgIGpRdWVyeSgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuICAgICAgICBzY3JvbGxUb3A6IGpRdWVyeShgLiR7ZS50YXJnZXQuaHJlZi5zcGxpdCgnIycpWzFdfS1jb250YWluZXJgKS5vZmZzZXQoKS50b3AgLSAxMDBcbiAgICB9LCAxMDAwLCBmdW5jdGlvbiAoKSB7XG5cbiAgICB9KTtcbn0pXG5cbi8vc2Nyb2xsXG5sZXQgYUFycmF5ID0gW107IC8vIGNyZWF0ZSB0aGUgZW1wdHkgYUFycmF5XG5mb3IgKGxldCBpID0gMDsgaSA8IGhjck1lbnVJdGVtTGluay5sZW5ndGg7IGkrKykge1xuICAgIGxldCBhQ2hpbGQgPSBoY3JNZW51SXRlbUxpbmtbaV07XG4gICAgbGV0IGFocmVmID0galF1ZXJ5KGFDaGlsZCkuYXR0cignaHJlZicpO1xuICAgIGFBcnJheS5wdXNoKGFocmVmKTtcbn1cbmxldCBjdXJyZW50U2VjdGlvbiA9ICcnO1xualF1ZXJ5KHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgd2luZG93UG9zID0galF1ZXJ5KHdpbmRvdykuc2Nyb2xsVG9wKCk7IC8vIGdldCB0aGUgb2Zmc2V0IG9mIHRoZSB3aW5kb3cgZnJvbSB0aGUgdG9wIG9mIHBhZ2VcbiAgICBsZXQgd2luZG93SGVpZ2h0ID0galF1ZXJ5KHdpbmRvdykuaGVpZ2h0KCk7IC8vIGdldCB0aGUgaGVpZ2h0IG9mIHRoZSB3aW5kb3dcbiAgICBsZXQgZG9jSGVpZ2h0ID0galF1ZXJ5KGRvY3VtZW50KS5oZWlnaHQoKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYUFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCB0aGVJRCA9IGFBcnJheVtpXS5yZXBsYWNlKCcjJywgJycpO1xuICAgICAgICBsZXQgZGl2UG9zID0galF1ZXJ5KGAuJHt0aGVJRH0tY29udGFpbmVyYCkub2Zmc2V0KCkudG9wIC0gMjAwOyAvLyBnZXQgdGhlIG9mZnNldCBvZiB0aGUgZGl2IGZyb20gdGhlIHRvcCBvZiBwYWdlXG4gICAgICAgIGxldCBkaXZIZWlnaHQgPSBqUXVlcnkoYC4ke3RoZUlEfS1jb250YWluZXJgKS5oZWlnaHQoKTsgLy8gZ2V0IHRoZSBoZWlnaHQgb2YgdGhlIGRpdiBpbiBxdWVzdGlvblxuICAgICAgICBpZiAod2luZG93UG9zID49IGRpdlBvcyAmJiB3aW5kb3dQb3MgPCAoZGl2UG9zICsgZGl2SGVpZ2h0KSkge1xuICAgICAgICAgICAgalF1ZXJ5KGBhW2hyZWY9JyMke3RoZUlEfSddYCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgalF1ZXJ5KGBhW2hyZWY9JyMke3RoZUlEfSddYCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHdpbmRvd1BvcyArIHdpbmRvd0hlaWdodCA9PSBkb2NIZWlnaHQpIHtcbiAgICAgICAgaWYgKCFqUXVlcnkoJ25hdiBsaTpsYXN0LWNoaWxkIGEnKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgICAgICAgIGxldCBuYXZBY3RpdmVDdXJyZW50ID0galF1ZXJ5KCcubmF2LWFjdGl2ZScpLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgIGpRdWVyeShgYVtocmVmPScke25hdkFjdGl2ZUN1cnJlbnR9J11gKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICBqUXVlcnkoJ25hdiBsaTpsYXN0LWNoaWxkIGEnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pO1xufSx7XCIuLi9ub2RlX21vZHVsZXMvd2F5cG9pbnRzL2xpYi9ub2ZyYW1ld29yay53YXlwb2ludHNcIjoyfV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vKiFcbldheXBvaW50cyAtIDQuMC4wXG5Db3B5cmlnaHQgwqkgMjAxMS0yMDE1IENhbGViIFRyb3VnaHRvblxuTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaHR0cHM6Ly9naXRodWIuY29tL2ltYWtld2VidGhpbmdzL3dheXBvaW50cy9ibG9nL21hc3Rlci9saWNlbnNlcy50eHRcbiovXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0J1xuXG4gIHZhciBrZXlDb3VudGVyID0gMFxuICB2YXIgYWxsV2F5cG9pbnRzID0ge31cblxuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvd2F5cG9pbnQgKi9cbiAgZnVuY3Rpb24gV2F5cG9pbnQob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBvcHRpb25zIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpXG4gICAgfVxuICAgIGlmICghb3B0aW9ucy5lbGVtZW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGVsZW1lbnQgb3B0aW9uIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpXG4gICAgfVxuICAgIGlmICghb3B0aW9ucy5oYW5kbGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGhhbmRsZXIgb3B0aW9uIHBhc3NlZCB0byBXYXlwb2ludCBjb25zdHJ1Y3RvcicpXG4gICAgfVxuXG4gICAgdGhpcy5rZXkgPSAnd2F5cG9pbnQtJyArIGtleUNvdW50ZXJcbiAgICB0aGlzLm9wdGlvbnMgPSBXYXlwb2ludC5BZGFwdGVyLmV4dGVuZCh7fSwgV2F5cG9pbnQuZGVmYXVsdHMsIG9wdGlvbnMpXG4gICAgdGhpcy5lbGVtZW50ID0gdGhpcy5vcHRpb25zLmVsZW1lbnRcbiAgICB0aGlzLmFkYXB0ZXIgPSBuZXcgV2F5cG9pbnQuQWRhcHRlcih0aGlzLmVsZW1lbnQpXG4gICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuaGFuZGxlclxuICAgIHRoaXMuYXhpcyA9IHRoaXMub3B0aW9ucy5ob3Jpem9udGFsID8gJ2hvcml6b250YWwnIDogJ3ZlcnRpY2FsJ1xuICAgIHRoaXMuZW5hYmxlZCA9IHRoaXMub3B0aW9ucy5lbmFibGVkXG4gICAgdGhpcy50cmlnZ2VyUG9pbnQgPSBudWxsXG4gICAgdGhpcy5ncm91cCA9IFdheXBvaW50Lkdyb3VwLmZpbmRPckNyZWF0ZSh7XG4gICAgICBuYW1lOiB0aGlzLm9wdGlvbnMuZ3JvdXAsXG4gICAgICBheGlzOiB0aGlzLmF4aXNcbiAgICB9KVxuICAgIHRoaXMuY29udGV4dCA9IFdheXBvaW50LkNvbnRleHQuZmluZE9yQ3JlYXRlQnlFbGVtZW50KHRoaXMub3B0aW9ucy5jb250ZXh0KVxuXG4gICAgaWYgKFdheXBvaW50Lm9mZnNldEFsaWFzZXNbdGhpcy5vcHRpb25zLm9mZnNldF0pIHtcbiAgICAgIHRoaXMub3B0aW9ucy5vZmZzZXQgPSBXYXlwb2ludC5vZmZzZXRBbGlhc2VzW3RoaXMub3B0aW9ucy5vZmZzZXRdXG4gICAgfVxuICAgIHRoaXMuZ3JvdXAuYWRkKHRoaXMpXG4gICAgdGhpcy5jb250ZXh0LmFkZCh0aGlzKVxuICAgIGFsbFdheXBvaW50c1t0aGlzLmtleV0gPSB0aGlzXG4gICAga2V5Q291bnRlciArPSAxXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIFdheXBvaW50LnByb3RvdHlwZS5xdWV1ZVRyaWdnZXIgPSBmdW5jdGlvbihkaXJlY3Rpb24pIHtcbiAgICB0aGlzLmdyb3VwLnF1ZXVlVHJpZ2dlcih0aGlzLCBkaXJlY3Rpb24pXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIFdheXBvaW50LnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24oYXJncykge1xuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHRoaXMuY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuY2FsbGJhY2suYXBwbHkodGhpcywgYXJncylcbiAgICB9XG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rlc3Ryb3kgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNvbnRleHQucmVtb3ZlKHRoaXMpXG4gICAgdGhpcy5ncm91cC5yZW1vdmUodGhpcylcbiAgICBkZWxldGUgYWxsV2F5cG9pbnRzW3RoaXMua2V5XVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kaXNhYmxlICovXG4gIFdheXBvaW50LnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2VcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9lbmFibGUgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuY29udGV4dC5yZWZyZXNoKClcbiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvbmV4dCAqL1xuICBXYXlwb2ludC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmdyb3VwLm5leHQodGhpcylcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvcHJldmlvdXMgKi9cbiAgV2F5cG9pbnQucHJvdG90eXBlLnByZXZpb3VzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ3JvdXAucHJldmlvdXModGhpcylcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgV2F5cG9pbnQuaW52b2tlQWxsID0gZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgdmFyIGFsbFdheXBvaW50c0FycmF5ID0gW11cbiAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiBhbGxXYXlwb2ludHMpIHtcbiAgICAgIGFsbFdheXBvaW50c0FycmF5LnB1c2goYWxsV2F5cG9pbnRzW3dheXBvaW50S2V5XSlcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IGFsbFdheXBvaW50c0FycmF5Lmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICBhbGxXYXlwb2ludHNBcnJheVtpXVttZXRob2RdKClcbiAgICB9XG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2Rlc3Ryb3ktYWxsICovXG4gIFdheXBvaW50LmRlc3Ryb3lBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2Rlc3Ryb3knKVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9kaXNhYmxlLWFsbCAqL1xuICBXYXlwb2ludC5kaXNhYmxlQWxsID0gZnVuY3Rpb24oKSB7XG4gICAgV2F5cG9pbnQuaW52b2tlQWxsKCdkaXNhYmxlJylcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvZW5hYmxlLWFsbCAqL1xuICBXYXlwb2ludC5lbmFibGVBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5pbnZva2VBbGwoJ2VuYWJsZScpXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL3JlZnJlc2gtYWxsICovXG4gIFdheXBvaW50LnJlZnJlc2hBbGwgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5Db250ZXh0LnJlZnJlc2hBbGwoKVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS92aWV3cG9ydC1oZWlnaHQgKi9cbiAgV2F5cG9pbnQudmlld3BvcnRIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHRcbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvdmlld3BvcnQtd2lkdGggKi9cbiAgV2F5cG9pbnQudmlld3BvcnRXaWR0aCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGhcbiAgfVxuXG4gIFdheXBvaW50LmFkYXB0ZXJzID0gW11cblxuICBXYXlwb2ludC5kZWZhdWx0cyA9IHtcbiAgICBjb250ZXh0OiB3aW5kb3csXG4gICAgY29udGludW91czogdHJ1ZSxcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIGdyb3VwOiAnZGVmYXVsdCcsXG4gICAgaG9yaXpvbnRhbDogZmFsc2UsXG4gICAgb2Zmc2V0OiAwXG4gIH1cblxuICBXYXlwb2ludC5vZmZzZXRBbGlhc2VzID0ge1xuICAgICdib3R0b20taW4tdmlldyc6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pbm5lckhlaWdodCgpIC0gdGhpcy5hZGFwdGVyLm91dGVySGVpZ2h0KClcbiAgICB9LFxuICAgICdyaWdodC1pbi12aWV3JzogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmlubmVyV2lkdGgoKSAtIHRoaXMuYWRhcHRlci5vdXRlcldpZHRoKClcbiAgICB9XG4gIH1cblxuICB3aW5kb3cuV2F5cG9pbnQgPSBXYXlwb2ludFxufSgpKVxuOyhmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnXG5cbiAgZnVuY3Rpb24gcmVxdWVzdEFuaW1hdGlvbkZyYW1lU2hpbShjYWxsYmFjaykge1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGNhbGxiYWNrLCAxMDAwIC8gNjApXG4gIH1cblxuICB2YXIga2V5Q291bnRlciA9IDBcbiAgdmFyIGNvbnRleHRzID0ge31cbiAgdmFyIFdheXBvaW50ID0gd2luZG93LldheXBvaW50XG4gIHZhciBvbGRXaW5kb3dMb2FkID0gd2luZG93Lm9ubG9hZFxuXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0ICovXG4gIGZ1bmN0aW9uIENvbnRleHQoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnRcbiAgICB0aGlzLkFkYXB0ZXIgPSBXYXlwb2ludC5BZGFwdGVyXG4gICAgdGhpcy5hZGFwdGVyID0gbmV3IHRoaXMuQWRhcHRlcihlbGVtZW50KVxuICAgIHRoaXMua2V5ID0gJ3dheXBvaW50LWNvbnRleHQtJyArIGtleUNvdW50ZXJcbiAgICB0aGlzLmRpZFNjcm9sbCA9IGZhbHNlXG4gICAgdGhpcy5kaWRSZXNpemUgPSBmYWxzZVxuICAgIHRoaXMub2xkU2Nyb2xsID0ge1xuICAgICAgeDogdGhpcy5hZGFwdGVyLnNjcm9sbExlZnQoKSxcbiAgICAgIHk6IHRoaXMuYWRhcHRlci5zY3JvbGxUb3AoKVxuICAgIH1cbiAgICB0aGlzLndheXBvaW50cyA9IHtcbiAgICAgIHZlcnRpY2FsOiB7fSxcbiAgICAgIGhvcml6b250YWw6IHt9XG4gICAgfVxuXG4gICAgZWxlbWVudC53YXlwb2ludENvbnRleHRLZXkgPSB0aGlzLmtleVxuICAgIGNvbnRleHRzW2VsZW1lbnQud2F5cG9pbnRDb250ZXh0S2V5XSA9IHRoaXNcbiAgICBrZXlDb3VudGVyICs9IDFcblxuICAgIHRoaXMuY3JlYXRlVGhyb3R0bGVkU2Nyb2xsSGFuZGxlcigpXG4gICAgdGhpcy5jcmVhdGVUaHJvdHRsZWRSZXNpemVIYW5kbGVyKClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24od2F5cG9pbnQpIHtcbiAgICB2YXIgYXhpcyA9IHdheXBvaW50Lm9wdGlvbnMuaG9yaXpvbnRhbCA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCdcbiAgICB0aGlzLndheXBvaW50c1theGlzXVt3YXlwb2ludC5rZXldID0gd2F5cG9pbnRcbiAgICB0aGlzLnJlZnJlc2goKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5jaGVja0VtcHR5ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGhvcml6b250YWxFbXB0eSA9IHRoaXMuQWRhcHRlci5pc0VtcHR5T2JqZWN0KHRoaXMud2F5cG9pbnRzLmhvcml6b250YWwpXG4gICAgdmFyIHZlcnRpY2FsRW1wdHkgPSB0aGlzLkFkYXB0ZXIuaXNFbXB0eU9iamVjdCh0aGlzLndheXBvaW50cy52ZXJ0aWNhbClcbiAgICBpZiAoaG9yaXpvbnRhbEVtcHR5ICYmIHZlcnRpY2FsRW1wdHkpIHtcbiAgICAgIHRoaXMuYWRhcHRlci5vZmYoJy53YXlwb2ludHMnKVxuICAgICAgZGVsZXRlIGNvbnRleHRzW3RoaXMua2V5XVxuICAgIH1cbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlVGhyb3R0bGVkUmVzaXplSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpc1xuXG4gICAgZnVuY3Rpb24gcmVzaXplSGFuZGxlcigpIHtcbiAgICAgIHNlbGYuaGFuZGxlUmVzaXplKClcbiAgICAgIHNlbGYuZGlkUmVzaXplID0gZmFsc2VcbiAgICB9XG5cbiAgICB0aGlzLmFkYXB0ZXIub24oJ3Jlc2l6ZS53YXlwb2ludHMnLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghc2VsZi5kaWRSZXNpemUpIHtcbiAgICAgICAgc2VsZi5kaWRSZXNpemUgPSB0cnVlXG4gICAgICAgIFdheXBvaW50LnJlcXVlc3RBbmltYXRpb25GcmFtZShyZXNpemVIYW5kbGVyKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLmNyZWF0ZVRocm90dGxlZFNjcm9sbEhhbmRsZXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXNcbiAgICBmdW5jdGlvbiBzY3JvbGxIYW5kbGVyKCkge1xuICAgICAgc2VsZi5oYW5kbGVTY3JvbGwoKVxuICAgICAgc2VsZi5kaWRTY3JvbGwgPSBmYWxzZVxuICAgIH1cblxuICAgIHRoaXMuYWRhcHRlci5vbignc2Nyb2xsLndheXBvaW50cycsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFzZWxmLmRpZFNjcm9sbCB8fCBXYXlwb2ludC5pc1RvdWNoKSB7XG4gICAgICAgIHNlbGYuZGlkU2Nyb2xsID0gdHJ1ZVxuICAgICAgICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsSGFuZGxlcilcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5oYW5kbGVSZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgICBXYXlwb2ludC5Db250ZXh0LnJlZnJlc2hBbGwoKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdHJpZ2dlcmVkR3JvdXBzID0ge31cbiAgICB2YXIgYXhlcyA9IHtcbiAgICAgIGhvcml6b250YWw6IHtcbiAgICAgICAgbmV3U2Nyb2xsOiB0aGlzLmFkYXB0ZXIuc2Nyb2xsTGVmdCgpLFxuICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLngsXG4gICAgICAgIGZvcndhcmQ6ICdyaWdodCcsXG4gICAgICAgIGJhY2t3YXJkOiAnbGVmdCdcbiAgICAgIH0sXG4gICAgICB2ZXJ0aWNhbDoge1xuICAgICAgICBuZXdTY3JvbGw6IHRoaXMuYWRhcHRlci5zY3JvbGxUb3AoKSxcbiAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC55LFxuICAgICAgICBmb3J3YXJkOiAnZG93bicsXG4gICAgICAgIGJhY2t3YXJkOiAndXAnXG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgYXhpc0tleSBpbiBheGVzKSB7XG4gICAgICB2YXIgYXhpcyA9IGF4ZXNbYXhpc0tleV1cbiAgICAgIHZhciBpc0ZvcndhcmQgPSBheGlzLm5ld1Njcm9sbCA+IGF4aXMub2xkU2Nyb2xsXG4gICAgICB2YXIgZGlyZWN0aW9uID0gaXNGb3J3YXJkID8gYXhpcy5mb3J3YXJkIDogYXhpcy5iYWNrd2FyZFxuXG4gICAgICBmb3IgKHZhciB3YXlwb2ludEtleSBpbiB0aGlzLndheXBvaW50c1theGlzS2V5XSkge1xuICAgICAgICB2YXIgd2F5cG9pbnQgPSB0aGlzLndheXBvaW50c1theGlzS2V5XVt3YXlwb2ludEtleV1cbiAgICAgICAgdmFyIHdhc0JlZm9yZVRyaWdnZXJQb2ludCA9IGF4aXMub2xkU2Nyb2xsIDwgd2F5cG9pbnQudHJpZ2dlclBvaW50XG4gICAgICAgIHZhciBub3dBZnRlclRyaWdnZXJQb2ludCA9IGF4aXMubmV3U2Nyb2xsID49IHdheXBvaW50LnRyaWdnZXJQb2ludFxuICAgICAgICB2YXIgY3Jvc3NlZEZvcndhcmQgPSB3YXNCZWZvcmVUcmlnZ2VyUG9pbnQgJiYgbm93QWZ0ZXJUcmlnZ2VyUG9pbnRcbiAgICAgICAgdmFyIGNyb3NzZWRCYWNrd2FyZCA9ICF3YXNCZWZvcmVUcmlnZ2VyUG9pbnQgJiYgIW5vd0FmdGVyVHJpZ2dlclBvaW50XG4gICAgICAgIGlmIChjcm9zc2VkRm9yd2FyZCB8fCBjcm9zc2VkQmFja3dhcmQpIHtcbiAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoZGlyZWN0aW9uKVxuICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgZ3JvdXBLZXkgaW4gdHJpZ2dlcmVkR3JvdXBzKSB7XG4gICAgICB0cmlnZ2VyZWRHcm91cHNbZ3JvdXBLZXldLmZsdXNoVHJpZ2dlcnMoKVxuICAgIH1cblxuICAgIHRoaXMub2xkU2Nyb2xsID0ge1xuICAgICAgeDogYXhlcy5ob3Jpem9udGFsLm5ld1Njcm9sbCxcbiAgICAgIHk6IGF4ZXMudmVydGljYWwubmV3U2Nyb2xsXG4gICAgfVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5pbm5lckhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgIC8qZXNsaW50LWRpc2FibGUgZXFlcWVxICovXG4gICAgaWYgKHRoaXMuZWxlbWVudCA9PSB0aGlzLmVsZW1lbnQud2luZG93KSB7XG4gICAgICByZXR1cm4gV2F5cG9pbnQudmlld3BvcnRIZWlnaHQoKVxuICAgIH1cbiAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5pbm5lckhlaWdodCgpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgZGVsZXRlIHRoaXMud2F5cG9pbnRzW3dheXBvaW50LmF4aXNdW3dheXBvaW50LmtleV1cbiAgICB0aGlzLmNoZWNrRW1wdHkoKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5pbm5lcldpZHRoID0gZnVuY3Rpb24oKSB7XG4gICAgLyplc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi9cbiAgICBpZiAodGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgIHJldHVybiBXYXlwb2ludC52aWV3cG9ydFdpZHRoKClcbiAgICB9XG4gICAgLyplc2xpbnQtZW5hYmxlIGVxZXFlcSAqL1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuaW5uZXJXaWR0aCgpXG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2NvbnRleHQtZGVzdHJveSAqL1xuICBDb250ZXh0LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGFsbFdheXBvaW50cyA9IFtdXG4gICAgZm9yICh2YXIgYXhpcyBpbiB0aGlzLndheXBvaW50cykge1xuICAgICAgZm9yICh2YXIgd2F5cG9pbnRLZXkgaW4gdGhpcy53YXlwb2ludHNbYXhpc10pIHtcbiAgICAgICAgYWxsV2F5cG9pbnRzLnB1c2godGhpcy53YXlwb2ludHNbYXhpc11bd2F5cG9pbnRLZXldKVxuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gYWxsV2F5cG9pbnRzLmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICBhbGxXYXlwb2ludHNbaV0uZGVzdHJveSgpXG4gICAgfVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9jb250ZXh0LXJlZnJlc2ggKi9cbiAgQ29udGV4dC5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uKCkge1xuICAgIC8qZXNsaW50LWRpc2FibGUgZXFlcWVxICovXG4gICAgdmFyIGlzV2luZG93ID0gdGhpcy5lbGVtZW50ID09IHRoaXMuZWxlbWVudC53aW5kb3dcbiAgICAvKmVzbGludC1lbmFibGUgZXFlcWVxICovXG4gICAgdmFyIGNvbnRleHRPZmZzZXQgPSBpc1dpbmRvdyA/IHVuZGVmaW5lZCA6IHRoaXMuYWRhcHRlci5vZmZzZXQoKVxuICAgIHZhciB0cmlnZ2VyZWRHcm91cHMgPSB7fVxuICAgIHZhciBheGVzXG5cbiAgICB0aGlzLmhhbmRsZVNjcm9sbCgpXG4gICAgYXhlcyA9IHtcbiAgICAgIGhvcml6b250YWw6IHtcbiAgICAgICAgY29udGV4dE9mZnNldDogaXNXaW5kb3cgPyAwIDogY29udGV4dE9mZnNldC5sZWZ0LFxuICAgICAgICBjb250ZXh0U2Nyb2xsOiBpc1dpbmRvdyA/IDAgOiB0aGlzLm9sZFNjcm9sbC54LFxuICAgICAgICBjb250ZXh0RGltZW5zaW9uOiB0aGlzLmlubmVyV2lkdGgoKSxcbiAgICAgICAgb2xkU2Nyb2xsOiB0aGlzLm9sZFNjcm9sbC54LFxuICAgICAgICBmb3J3YXJkOiAncmlnaHQnLFxuICAgICAgICBiYWNrd2FyZDogJ2xlZnQnLFxuICAgICAgICBvZmZzZXRQcm9wOiAnbGVmdCdcbiAgICAgIH0sXG4gICAgICB2ZXJ0aWNhbDoge1xuICAgICAgICBjb250ZXh0T2Zmc2V0OiBpc1dpbmRvdyA/IDAgOiBjb250ZXh0T2Zmc2V0LnRvcCxcbiAgICAgICAgY29udGV4dFNjcm9sbDogaXNXaW5kb3cgPyAwIDogdGhpcy5vbGRTY3JvbGwueSxcbiAgICAgICAgY29udGV4dERpbWVuc2lvbjogdGhpcy5pbm5lckhlaWdodCgpLFxuICAgICAgICBvbGRTY3JvbGw6IHRoaXMub2xkU2Nyb2xsLnksXG4gICAgICAgIGZvcndhcmQ6ICdkb3duJyxcbiAgICAgICAgYmFja3dhcmQ6ICd1cCcsXG4gICAgICAgIG9mZnNldFByb3A6ICd0b3AnXG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgYXhpc0tleSBpbiBheGVzKSB7XG4gICAgICB2YXIgYXhpcyA9IGF4ZXNbYXhpc0tleV1cbiAgICAgIGZvciAodmFyIHdheXBvaW50S2V5IGluIHRoaXMud2F5cG9pbnRzW2F4aXNLZXldKSB7XG4gICAgICAgIHZhciB3YXlwb2ludCA9IHRoaXMud2F5cG9pbnRzW2F4aXNLZXldW3dheXBvaW50S2V5XVxuICAgICAgICB2YXIgYWRqdXN0bWVudCA9IHdheXBvaW50Lm9wdGlvbnMub2Zmc2V0XG4gICAgICAgIHZhciBvbGRUcmlnZ2VyUG9pbnQgPSB3YXlwb2ludC50cmlnZ2VyUG9pbnRcbiAgICAgICAgdmFyIGVsZW1lbnRPZmZzZXQgPSAwXG4gICAgICAgIHZhciBmcmVzaFdheXBvaW50ID0gb2xkVHJpZ2dlclBvaW50ID09IG51bGxcbiAgICAgICAgdmFyIGNvbnRleHRNb2RpZmllciwgd2FzQmVmb3JlU2Nyb2xsLCBub3dBZnRlclNjcm9sbFxuICAgICAgICB2YXIgdHJpZ2dlcmVkQmFja3dhcmQsIHRyaWdnZXJlZEZvcndhcmRcblxuICAgICAgICBpZiAod2F5cG9pbnQuZWxlbWVudCAhPT0gd2F5cG9pbnQuZWxlbWVudC53aW5kb3cpIHtcbiAgICAgICAgICBlbGVtZW50T2Zmc2V0ID0gd2F5cG9pbnQuYWRhcHRlci5vZmZzZXQoKVtheGlzLm9mZnNldFByb3BdXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIGFkanVzdG1lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBhZGp1c3RtZW50ID0gYWRqdXN0bWVudC5hcHBseSh3YXlwb2ludClcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgYWRqdXN0bWVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICBhZGp1c3RtZW50ID0gcGFyc2VGbG9hdChhZGp1c3RtZW50KVxuICAgICAgICAgIGlmICh3YXlwb2ludC5vcHRpb25zLm9mZnNldC5pbmRleE9mKCclJykgPiAtIDEpIHtcbiAgICAgICAgICAgIGFkanVzdG1lbnQgPSBNYXRoLmNlaWwoYXhpcy5jb250ZXh0RGltZW5zaW9uICogYWRqdXN0bWVudCAvIDEwMClcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb250ZXh0TW9kaWZpZXIgPSBheGlzLmNvbnRleHRTY3JvbGwgLSBheGlzLmNvbnRleHRPZmZzZXRcbiAgICAgICAgd2F5cG9pbnQudHJpZ2dlclBvaW50ID0gZWxlbWVudE9mZnNldCArIGNvbnRleHRNb2RpZmllciAtIGFkanVzdG1lbnRcbiAgICAgICAgd2FzQmVmb3JlU2Nyb2xsID0gb2xkVHJpZ2dlclBvaW50IDwgYXhpcy5vbGRTY3JvbGxcbiAgICAgICAgbm93QWZ0ZXJTY3JvbGwgPSB3YXlwb2ludC50cmlnZ2VyUG9pbnQgPj0gYXhpcy5vbGRTY3JvbGxcbiAgICAgICAgdHJpZ2dlcmVkQmFja3dhcmQgPSB3YXNCZWZvcmVTY3JvbGwgJiYgbm93QWZ0ZXJTY3JvbGxcbiAgICAgICAgdHJpZ2dlcmVkRm9yd2FyZCA9ICF3YXNCZWZvcmVTY3JvbGwgJiYgIW5vd0FmdGVyU2Nyb2xsXG5cbiAgICAgICAgaWYgKCFmcmVzaFdheXBvaW50ICYmIHRyaWdnZXJlZEJhY2t3YXJkKSB7XG4gICAgICAgICAgd2F5cG9pbnQucXVldWVUcmlnZ2VyKGF4aXMuYmFja3dhcmQpXG4gICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWZyZXNoV2F5cG9pbnQgJiYgdHJpZ2dlcmVkRm9yd2FyZCkge1xuICAgICAgICAgIHdheXBvaW50LnF1ZXVlVHJpZ2dlcihheGlzLmZvcndhcmQpXG4gICAgICAgICAgdHJpZ2dlcmVkR3JvdXBzW3dheXBvaW50Lmdyb3VwLmlkXSA9IHdheXBvaW50Lmdyb3VwXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZnJlc2hXYXlwb2ludCAmJiBheGlzLm9sZFNjcm9sbCA+PSB3YXlwb2ludC50cmlnZ2VyUG9pbnQpIHtcbiAgICAgICAgICB3YXlwb2ludC5xdWV1ZVRyaWdnZXIoYXhpcy5mb3J3YXJkKVxuICAgICAgICAgIHRyaWdnZXJlZEdyb3Vwc1t3YXlwb2ludC5ncm91cC5pZF0gPSB3YXlwb2ludC5ncm91cFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgV2F5cG9pbnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIgZ3JvdXBLZXkgaW4gdHJpZ2dlcmVkR3JvdXBzKSB7XG4gICAgICAgIHRyaWdnZXJlZEdyb3Vwc1tncm91cEtleV0uZmx1c2hUcmlnZ2VycygpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIENvbnRleHQuZmluZE9yQ3JlYXRlQnlFbGVtZW50ID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBDb250ZXh0LmZpbmRCeUVsZW1lbnQoZWxlbWVudCkgfHwgbmV3IENvbnRleHQoZWxlbWVudClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgQ29udGV4dC5yZWZyZXNoQWxsID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yICh2YXIgY29udGV4dElkIGluIGNvbnRleHRzKSB7XG4gICAgICBjb250ZXh0c1tjb250ZXh0SWRdLnJlZnJlc2goKVxuICAgIH1cbiAgfVxuXG4gIC8qIFB1YmxpYyAqL1xuICAvKiBodHRwOi8vaW1ha2V3ZWJ0aGluZ3MuY29tL3dheXBvaW50cy9hcGkvY29udGV4dC1maW5kLWJ5LWVsZW1lbnQgKi9cbiAgQ29udGV4dC5maW5kQnlFbGVtZW50ID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBjb250ZXh0c1tlbGVtZW50LndheXBvaW50Q29udGV4dEtleV1cbiAgfVxuXG4gIHdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAob2xkV2luZG93TG9hZCkge1xuICAgICAgb2xkV2luZG93TG9hZCgpXG4gICAgfVxuICAgIENvbnRleHQucmVmcmVzaEFsbCgpXG4gIH1cblxuICBXYXlwb2ludC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIHZhciByZXF1ZXN0Rm4gPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICB3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWVTaGltXG4gICAgcmVxdWVzdEZuLmNhbGwod2luZG93LCBjYWxsYmFjaylcbiAgfVxuICBXYXlwb2ludC5Db250ZXh0ID0gQ29udGV4dFxufSgpKVxuOyhmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnXG5cbiAgZnVuY3Rpb24gYnlUcmlnZ2VyUG9pbnQoYSwgYikge1xuICAgIHJldHVybiBhLnRyaWdnZXJQb2ludCAtIGIudHJpZ2dlclBvaW50XG4gIH1cblxuICBmdW5jdGlvbiBieVJldmVyc2VUcmlnZ2VyUG9pbnQoYSwgYikge1xuICAgIHJldHVybiBiLnRyaWdnZXJQb2ludCAtIGEudHJpZ2dlclBvaW50XG4gIH1cblxuICB2YXIgZ3JvdXBzID0ge1xuICAgIHZlcnRpY2FsOiB7fSxcbiAgICBob3Jpem9udGFsOiB7fVxuICB9XG4gIHZhciBXYXlwb2ludCA9IHdpbmRvdy5XYXlwb2ludFxuXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9ncm91cCAqL1xuICBmdW5jdGlvbiBHcm91cChvcHRpb25zKSB7XG4gICAgdGhpcy5uYW1lID0gb3B0aW9ucy5uYW1lXG4gICAgdGhpcy5heGlzID0gb3B0aW9ucy5heGlzXG4gICAgdGhpcy5pZCA9IHRoaXMubmFtZSArICctJyArIHRoaXMuYXhpc1xuICAgIHRoaXMud2F5cG9pbnRzID0gW11cbiAgICB0aGlzLmNsZWFyVHJpZ2dlclF1ZXVlcygpXG4gICAgZ3JvdXBzW3RoaXMuYXhpc11bdGhpcy5uYW1lXSA9IHRoaXNcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgR3JvdXAucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgdGhpcy53YXlwb2ludHMucHVzaCh3YXlwb2ludClcbiAgfVxuXG4gIC8qIFByaXZhdGUgKi9cbiAgR3JvdXAucHJvdG90eXBlLmNsZWFyVHJpZ2dlclF1ZXVlcyA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudHJpZ2dlclF1ZXVlcyA9IHtcbiAgICAgIHVwOiBbXSxcbiAgICAgIGRvd246IFtdLFxuICAgICAgbGVmdDogW10sXG4gICAgICByaWdodDogW11cbiAgICB9XG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLnByb3RvdHlwZS5mbHVzaFRyaWdnZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yICh2YXIgZGlyZWN0aW9uIGluIHRoaXMudHJpZ2dlclF1ZXVlcykge1xuICAgICAgdmFyIHdheXBvaW50cyA9IHRoaXMudHJpZ2dlclF1ZXVlc1tkaXJlY3Rpb25dXG4gICAgICB2YXIgcmV2ZXJzZSA9IGRpcmVjdGlvbiA9PT0gJ3VwJyB8fCBkaXJlY3Rpb24gPT09ICdsZWZ0J1xuICAgICAgd2F5cG9pbnRzLnNvcnQocmV2ZXJzZSA/IGJ5UmV2ZXJzZVRyaWdnZXJQb2ludCA6IGJ5VHJpZ2dlclBvaW50KVxuICAgICAgZm9yICh2YXIgaSA9IDAsIGVuZCA9IHdheXBvaW50cy5sZW5ndGg7IGkgPCBlbmQ7IGkgKz0gMSkge1xuICAgICAgICB2YXIgd2F5cG9pbnQgPSB3YXlwb2ludHNbaV1cbiAgICAgICAgaWYgKHdheXBvaW50Lm9wdGlvbnMuY29udGludW91cyB8fCBpID09PSB3YXlwb2ludHMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHdheXBvaW50LnRyaWdnZXIoW2RpcmVjdGlvbl0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5jbGVhclRyaWdnZXJRdWV1ZXMoKVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHdheXBvaW50KSB7XG4gICAgdGhpcy53YXlwb2ludHMuc29ydChieVRyaWdnZXJQb2ludClcbiAgICB2YXIgaW5kZXggPSBXYXlwb2ludC5BZGFwdGVyLmluQXJyYXkod2F5cG9pbnQsIHRoaXMud2F5cG9pbnRzKVxuICAgIHZhciBpc0xhc3QgPSBpbmRleCA9PT0gdGhpcy53YXlwb2ludHMubGVuZ3RoIC0gMVxuICAgIHJldHVybiBpc0xhc3QgPyBudWxsIDogdGhpcy53YXlwb2ludHNbaW5kZXggKyAxXVxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUucHJldmlvdXMgPSBmdW5jdGlvbih3YXlwb2ludCkge1xuICAgIHRoaXMud2F5cG9pbnRzLnNvcnQoYnlUcmlnZ2VyUG9pbnQpXG4gICAgdmFyIGluZGV4ID0gV2F5cG9pbnQuQWRhcHRlci5pbkFycmF5KHdheXBvaW50LCB0aGlzLndheXBvaW50cylcbiAgICByZXR1cm4gaW5kZXggPyB0aGlzLndheXBvaW50c1tpbmRleCAtIDFdIDogbnVsbFxuICB9XG5cbiAgLyogUHJpdmF0ZSAqL1xuICBHcm91cC5wcm90b3R5cGUucXVldWVUcmlnZ2VyID0gZnVuY3Rpb24od2F5cG9pbnQsIGRpcmVjdGlvbikge1xuICAgIHRoaXMudHJpZ2dlclF1ZXVlc1tkaXJlY3Rpb25dLnB1c2god2F5cG9pbnQpXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbih3YXlwb2ludCkge1xuICAgIHZhciBpbmRleCA9IFdheXBvaW50LkFkYXB0ZXIuaW5BcnJheSh3YXlwb2ludCwgdGhpcy53YXlwb2ludHMpXG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIHRoaXMud2F5cG9pbnRzLnNwbGljZShpbmRleCwgMSlcbiAgICB9XG4gIH1cblxuICAvKiBQdWJsaWMgKi9cbiAgLyogaHR0cDovL2ltYWtld2VidGhpbmdzLmNvbS93YXlwb2ludHMvYXBpL2ZpcnN0ICovXG4gIEdyb3VwLnByb3RvdHlwZS5maXJzdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLndheXBvaW50c1swXVxuICB9XG5cbiAgLyogUHVibGljICovXG4gIC8qIGh0dHA6Ly9pbWFrZXdlYnRoaW5ncy5jb20vd2F5cG9pbnRzL2FwaS9sYXN0ICovXG4gIEdyb3VwLnByb3RvdHlwZS5sYXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMud2F5cG9pbnRzW3RoaXMud2F5cG9pbnRzLmxlbmd0aCAtIDFdXG4gIH1cblxuICAvKiBQcml2YXRlICovXG4gIEdyb3VwLmZpbmRPckNyZWF0ZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gZ3JvdXBzW29wdGlvbnMuYXhpc11bb3B0aW9ucy5uYW1lXSB8fCBuZXcgR3JvdXAob3B0aW9ucylcbiAgfVxuXG4gIFdheXBvaW50Lkdyb3VwID0gR3JvdXBcbn0oKSlcbjsoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0J1xuXG4gIHZhciBXYXlwb2ludCA9IHdpbmRvdy5XYXlwb2ludFxuXG4gIGZ1bmN0aW9uIGlzV2luZG93KGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudCA9PT0gZWxlbWVudC53aW5kb3dcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFdpbmRvdyhlbGVtZW50KSB7XG4gICAgaWYgKGlzV2luZG93KGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm4gZWxlbWVudFxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudC5kZWZhdWx0Vmlld1xuICB9XG5cbiAgZnVuY3Rpb24gTm9GcmFtZXdvcmtBZGFwdGVyKGVsZW1lbnQpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50XG4gICAgdGhpcy5oYW5kbGVycyA9IHt9XG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLmlubmVySGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGlzV2luID0gaXNXaW5kb3codGhpcy5lbGVtZW50KVxuICAgIHJldHVybiBpc1dpbiA/IHRoaXMuZWxlbWVudC5pbm5lckhlaWdodCA6IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHRcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuaW5uZXJXaWR0aCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpc1dpbiA9IGlzV2luZG93KHRoaXMuZWxlbWVudClcbiAgICByZXR1cm4gaXNXaW4gPyB0aGlzLmVsZW1lbnQuaW5uZXJXaWR0aCA6IHRoaXMuZWxlbWVudC5jbGllbnRXaWR0aFxuICB9XG5cbiAgTm9GcmFtZXdvcmtBZGFwdGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihldmVudCwgaGFuZGxlcikge1xuICAgIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCBsaXN0ZW5lcnMsIGhhbmRsZXIpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSBsaXN0ZW5lcnMubGVuZ3RoIC0gMTsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXVxuICAgICAgICBpZiAoIWhhbmRsZXIgfHwgaGFuZGxlciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIobGlzdGVuZXIpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZXZlbnRQYXJ0cyA9IGV2ZW50LnNwbGl0KCcuJylcbiAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnRQYXJ0c1swXVxuICAgIHZhciBuYW1lc3BhY2UgPSBldmVudFBhcnRzWzFdXG4gICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRcblxuICAgIGlmIChuYW1lc3BhY2UgJiYgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdICYmIGV2ZW50VHlwZSkge1xuICAgICAgcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXVtldmVudFR5cGVdLCBoYW5kbGVyKVxuICAgICAgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW2V2ZW50VHlwZV0gPSBbXVxuICAgIH1cbiAgICBlbHNlIGlmIChldmVudFR5cGUpIHtcbiAgICAgIGZvciAodmFyIG5zIGluIHRoaXMuaGFuZGxlcnMpIHtcbiAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKGVsZW1lbnQsIHRoaXMuaGFuZGxlcnNbbnNdW2V2ZW50VHlwZV0gfHwgW10sIGhhbmRsZXIpXG4gICAgICAgIHRoaXMuaGFuZGxlcnNbbnNdW2V2ZW50VHlwZV0gPSBbXVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChuYW1lc3BhY2UgJiYgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdKSB7XG4gICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSkge1xuICAgICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdW3R5cGVdLCBoYW5kbGVyKVxuICAgICAgfVxuICAgICAgdGhpcy5oYW5kbGVyc1tuYW1lc3BhY2VdID0ge31cbiAgICB9XG4gIH1cblxuICAvKiBBZGFwdGVkIGZyb20galF1ZXJ5IDEueCBvZmZzZXQoKSAqL1xuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm9mZnNldCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgdmFyIGRvY3VtZW50RWxlbWVudCA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxuICAgIHZhciB3aW4gPSBnZXRXaW5kb3codGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQpXG4gICAgdmFyIHJlY3QgPSB7XG4gICAgICB0b3A6IDAsXG4gICAgICBsZWZ0OiAwXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHtcbiAgICAgIHJlY3QgPSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiByZWN0LnRvcCArIHdpbi5wYWdlWU9mZnNldCAtIGRvY3VtZW50RWxlbWVudC5jbGllbnRUb3AsXG4gICAgICBsZWZ0OiByZWN0LmxlZnQgKyB3aW4ucGFnZVhPZmZzZXQgLSBkb2N1bWVudEVsZW1lbnQuY2xpZW50TGVmdFxuICAgIH1cbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbihldmVudCwgaGFuZGxlcikge1xuICAgIHZhciBldmVudFBhcnRzID0gZXZlbnQuc3BsaXQoJy4nKVxuICAgIHZhciBldmVudFR5cGUgPSBldmVudFBhcnRzWzBdXG4gICAgdmFyIG5hbWVzcGFjZSA9IGV2ZW50UGFydHNbMV0gfHwgJ19fZGVmYXVsdCdcbiAgICB2YXIgbnNIYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSA9IHRoaXMuaGFuZGxlcnNbbmFtZXNwYWNlXSB8fCB7fVxuICAgIHZhciBuc1R5cGVMaXN0ID0gbnNIYW5kbGVyc1tldmVudFR5cGVdID0gbnNIYW5kbGVyc1tldmVudFR5cGVdIHx8IFtdXG5cbiAgICBuc1R5cGVMaXN0LnB1c2goaGFuZGxlcilcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGhhbmRsZXIpXG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm91dGVySGVpZ2h0ID0gZnVuY3Rpb24oaW5jbHVkZU1hcmdpbikge1xuICAgIHZhciBoZWlnaHQgPSB0aGlzLmlubmVySGVpZ2h0KClcbiAgICB2YXIgY29tcHV0ZWRTdHlsZVxuXG4gICAgaWYgKGluY2x1ZGVNYXJnaW4gJiYgIWlzV2luZG93KHRoaXMuZWxlbWVudCkpIHtcbiAgICAgIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpXG4gICAgICBoZWlnaHQgKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5Ub3AsIDEwKVxuICAgICAgaGVpZ2h0ICs9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUubWFyZ2luQm90dG9tLCAxMClcbiAgICB9XG5cbiAgICByZXR1cm4gaGVpZ2h0XG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLm91dGVyV2lkdGggPSBmdW5jdGlvbihpbmNsdWRlTWFyZ2luKSB7XG4gICAgdmFyIHdpZHRoID0gdGhpcy5pbm5lcldpZHRoKClcbiAgICB2YXIgY29tcHV0ZWRTdHlsZVxuXG4gICAgaWYgKGluY2x1ZGVNYXJnaW4gJiYgIWlzV2luZG93KHRoaXMuZWxlbWVudCkpIHtcbiAgICAgIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpXG4gICAgICB3aWR0aCArPSBwYXJzZUludChjb21wdXRlZFN0eWxlLm1hcmdpbkxlZnQsIDEwKVxuICAgICAgd2lkdGggKz0gcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5tYXJnaW5SaWdodCwgMTApXG4gICAgfVxuXG4gICAgcmV0dXJuIHdpZHRoXG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIucHJvdG90eXBlLnNjcm9sbExlZnQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgd2luID0gZ2V0V2luZG93KHRoaXMuZWxlbWVudClcbiAgICByZXR1cm4gd2luID8gd2luLnBhZ2VYT2Zmc2V0IDogdGhpcy5lbGVtZW50LnNjcm9sbExlZnRcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5wcm90b3R5cGUuc2Nyb2xsVG9wID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHdpbiA9IGdldFdpbmRvdyh0aGlzLmVsZW1lbnQpXG4gICAgcmV0dXJuIHdpbiA/IHdpbi5wYWdlWU9mZnNldCA6IHRoaXMuZWxlbWVudC5zY3JvbGxUb3BcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5leHRlbmQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cylcblxuICAgIGZ1bmN0aW9uIG1lcmdlKHRhcmdldCwgb2JqKSB7XG4gICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBvYmpba2V5XVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGFyZ2V0XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDEsIGVuZCA9IGFyZ3MubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIG1lcmdlKGFyZ3NbMF0sIGFyZ3NbaV0pXG4gICAgfVxuICAgIHJldHVybiBhcmdzWzBdXG4gIH1cblxuICBOb0ZyYW1ld29ya0FkYXB0ZXIuaW5BcnJheSA9IGZ1bmN0aW9uKGVsZW1lbnQsIGFycmF5LCBpKSB7XG4gICAgcmV0dXJuIGFycmF5ID09IG51bGwgPyAtMSA6IGFycmF5LmluZGV4T2YoZWxlbWVudCwgaSlcbiAgfVxuXG4gIE5vRnJhbWV3b3JrQWRhcHRlci5pc0VtcHR5T2JqZWN0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgLyogZXNsaW50IG5vLXVudXNlZC12YXJzOiAwICovXG4gICAgZm9yICh2YXIgbmFtZSBpbiBvYmopIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgV2F5cG9pbnQuYWRhcHRlcnMucHVzaCh7XG4gICAgbmFtZTogJ25vZnJhbWV3b3JrJyxcbiAgICBBZGFwdGVyOiBOb0ZyYW1ld29ya0FkYXB0ZXJcbiAgfSlcbiAgV2F5cG9pbnQuQWRhcHRlciA9IE5vRnJhbWV3b3JrQWRhcHRlclxufSgpKVxuO1xufSx7fV19LHt9LFsxXSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
